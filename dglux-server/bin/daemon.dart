import "dart:async";import "dart:typed_data";import "dart:io";import "dart:io" as BT;import "dart:math";import "dart:math" as rE;import "dart:convert";import "dart:collection";class uM extends v{List<int> KB;int qS;uM.Bb(Uint8List A):super.Fb(A){qS=A[0];KB=oG().sublist(1);}Uint8List qb(){var A=[qS];A.addAll(KB);rb=A.length;sb();tb(A);return ub;}String toString()=>"BitString(${KB})";}class sM extends v{bool vb;sM.za(Uint8List A):super.Fb(A){var B=A[wb];vb=(B==AN);}Uint8List qb(){super.sb();super.tb([vb==true?AN:RT]);return ub;}}const int JT=0x01;const int vM=0x02;const int LT=0x03;const int wM=0x04;const int xM=0x05;const int MT=0x0A;const int NT=0x13;const int OT=0x17;const int vG=0x30;const int PT=0x31;const int QT=0x06;const int AN=0xff;const int RT=0x00;class hF{String message;hF(this.message);}class oC extends v{var yB;oC(this.yB,{tag: vM}):super(tag:tag);oC.va(Uint8List A):super.Fb(A){yB=VT(this.oG());}Uint8List qb(){var A=TT(this.yB);rb=A.length;super.sb();tb(A);return ub;}static Uint8List TT(var B){var C;if(B is iF){C=new Uint8List.fromList(B.mS());}else{var H=new Int64List(1);H[0]=B;var D=new Uint8List.view(H.buffer);int A=7;var J=0;if(B.isNegative){J=0xFF;}while(D[A]==J&&A>0) --A;if(B.isNegative){if((D[A]&0x80)==0){ ++A;}}else{if((D[A]&0x80)!=0){ ++A;}}C=new Uint8List(A+1);for(int G=0;G<(A+1); ++G){C[G]=D[A-G];}}return C;}static dynamic VT(Uint8List A,{int offset: 0}){if(A.length-offset>8)return new iF(A.sublist(offset));var H=(A[offset]&0x80)==0?0:0xFF;var C=new Int64List(1);var D=new Uint8List.view(C.buffer);int B=0;int G=A.length-1;while(G>=offset){D[B++ ]=A[G-- ];}while(B<=7){D[B++ ]=H;}return C[0];}String toString()=>"ASNInteger(${yB})";}class sE{int xb;int get length=>xb;int wb;int get ua=>wb;sE(this.xb,this.wb);static Uint8List ST(int C){Uint8List A;if(C<=127){A=new Uint8List(1);A[0]=C;}else{var G=new Uint32List(1);G[0]=C;var H=new Uint8List.view(G.buffer);int B=3;while(H[B]==0) --B;A=new Uint8List(B+2);A[0]=0x80+B+1;for(int D=1;D<A.length; ++D)A[D]=H[B-- ];}return A;}static sE UT(Uint8List B){int C=2;int A=(B[1]&0x7F);if(A!=B[1]){int G=A;A=0;for(int D=0;D<G;D++ ){A<<= 8;A|= (B[C++ ]&0xFF);}}return new sE(A,C);}}class rM extends v{static final IT=[xM,0x00];List get ZC=>IT;rM.xa(Uint8List A):super.Fb(A);}class v{final int yb;int get tag=>yb;Uint8List ub;Uint8List get ZC{if(ub==null)qb();return ub;}v({int tag: 0}):yb=tag;v.Fb(A):yb=A[0]{ub=A;zb();}void zb(){sE A=sE.UT(ub);rb=A.length;wb=A.ua;}int get oS=>wb+rb;int rb;int wb=2;Uint8List sb(){if(ub==null){Uint8List A=sE.ST(rb);ub=new Uint8List(1+A.length+rb);ub[0]=tag;ub.setRange(1,1+A.length,A,0);wb=1+A.length;}return ub;}Uint8List qb()=>sb();Uint8List oG(){return new Uint8List.view(ub.buffer,wb+ub.offsetInBytes,rb);}void tb(List<int> A){this.ZC.setRange(wb,wb+A.length,A);}qa()=>GT.KT(ZC);String toString()=>"ASN1Object(tag=${tag.toRadixString(16)} valueByteLength=${rb}) startpos=${wb} bytes=${qa()}";}class tM extends v{List<int> NS;tM.wa(Uint8List A):super.Fb(A);Uint8List qb(){rb=NS.length;super.sb();tb(NS);return ub;}}class fB extends v{Uint8List lE;fB(dynamic A,{int tag: wM}):super(tag:tag){if(A is String)this.lE=new Uint8List.fromList(A.codeUnits);else if(A is Uint8List)this.lE=A;else if(A is List<int>)this.lE=new Uint8List.fromList(A);else throw new ArgumentError("Parameters octets should be either of type String or List<int>.");}fB.Eb(Uint8List A):super.Fb(A){lE=oG();}String get KB=>new String.fromCharCodes(lE);Uint8List qb(){rb=lE.length;sb();tb(lE);return ub;}String toString()=>"OctetString(${KB})";}class LJ{Uint8List Ac;LJ(this.Ac);int Bc=0;bool hasNext(){return Bc<Ac.length;}v LS(){int A=Ac[Bc];bool D=(0xC0&A)==0;bool G=(0x40&A)!=0;int H=Ac.length-Bc;var C=new Uint8List.view(Ac.buffer,Bc+Ac.offsetInBytes,H);v B=null;if(D)B=Cc(A,C);else if(G){if((A&vG)!=0)B=new u.Ab(C);else throw new hF("Parser for tag ${A} not implemented yet");}else{B=new v.Fb(C);}Bc=Bc+B.oS;return B;}v Cc(int B,Uint8List A){switch (B){case vG:return new u.Ab(A);case wM:return new fB.Eb(A);case vM:case MT:return new oC.va(A);case PT:return new MJ.ya(A);case JT:return new sM.za(A);case QT:return new tM.wa(A);case LT:return new uM.Bb(A);case xM:return new rM.xa(A);case NT:return new yM.Cb(A);case OT:return new zM.Db(A);default:throw new hF("Parser for tag ${B} not implemented yet");}}}class yM extends v{String KB;List<int> nG;yM.Cb(Uint8List A):super.Fb(A){nG=A.sublist(0,2);KB=new String.fromCharCodes(A.sublist(2));}Uint8List qb(){var A=new List.from(nG);A.addAll(KB.codeUnits);rb=A.length;sb();tb(A);return ub;}String toString()=>"PrintableString(${KB})";}class u extends v{List<v> c=new List();u.Ab(Uint8List A):super.Fb(A){if((tag&0x30)==0)throw new hF("The tag ${tag} does not look like a sequence type");Dc();}u({int tag: vG}):super(tag:tag);add(v A){c.add(A);}Uint8List qb(){rb=Ec();super.sb();var A=wb;c.forEach((C){var B=C.ZC;ZC.setRange(A,A+B.length,B);A+= B.length;});return ub;}int Ec(){int A=0;c.forEach((B){A+= B.qb().length;});return A;}Dc(){var A=new LJ(oG());while(A.hasNext()){c.add(A.LS());}}String toString(){var A=new StringBuffer("Seq[");c.forEach((B){A.write(B.toString());A.write(" ");});A.write("]");return A.toString();}}class MJ extends v{Set<v> c=new Set<v>();MJ.ya(Uint8List A):super.Fb(A){if((tag&0x30)==0)throw new hF("The tag ${tag} does not look like a set type");Fc();}add(v A){c.add(A);}Uint8List qb(){rb=Ec();super.sb();var A=wb;c.forEach((C){var B=C.ZC;ZC.setRange(A,A+B.length,B);A+= B.length;});return ub;}int Ec(){int A=0;c.forEach((B){B.qb();A+= B.ZC.length;});return A;}Fc(){var A=new LJ(oG());while(A.hasNext()){c.add(A.LS());}}String toString(){var A=new StringBuffer("Set[");c.forEach((B){A.write(B.toString());A.write(" ");});A.write("]");return A.toString();}}class zM extends v{DateTime zL;List<int> nG;zM.Db(Uint8List B):super.Fb(B){nG=B.sublist(0,2);var C=B.sublist(2).indexOf(13)+2-1;if(C<=0)C=B.length;var A=new String.fromCharCodes(B.sublist(2,C));var D=int.parse(A.substring(0,2));if(D>75)A="19"+A;else A="20"+A;A=A.substring(0,8)+"T"+A.substring(8);zL=DateTime.parse(A);}Uint8List qb(){var B=new List.from(nG);var A=zL.toUtc();var C=A.year.toString().substring(2).padLeft(2,"0");var D=A.month.toString().padLeft(2,"0");var G=A.day.toString().padLeft(2,"0");var H=A.hour.toString().padLeft(2,"0");var J=A.minute.toString().padLeft(2,"0");var K=A.second.toString().padLeft(2,"0");var L="${C}${D}${G}${H}${J}${K}Z";B.addAll(L.codeUnits);rb=B.length;sb();tb(B);return ub;}String toString()=>"UtcTime(${zL})";}class GT{static String KT(List<int> C){StringBuffer A=new StringBuffer("[");bool B=false;C.forEach((D){B?A.write(", "):B=true;A.write("0x${D.toRadixString(16)}");});A.write("]");return A.toString();}}abstract class iF{static bool WT=(){if(0.0 is int){return true;}try {return 3.modInverse(7)==-1;}catch (A){return true;}return false;}();factory iF([A,B,C]){if(WT){return new U(A,B,C);}else{return new V(A,B,C);}}}class V implements iF{int data;V([A,B,C]){if(A!=null){if(A is int){data=A;}else if(A is num){data=A.toInt();}else if(A is List){this.xZ(A);}else{this.ZF(A,B);}}}void bG(V A){A.data=data;}void pI(int A){data=A;}void ZF(String A,int B){data=int.parse(A,radix:B,onError:(C)=>0);}void xZ(List B,[bool G=false]){if(B==null||B.length==0){data=0;return;}bool D=false;if(!G&&B[0]&0xFF>0x7F){D=true;}if(D){int A=0;for(int C in B){A=(A<<8)|(~((C&0xFF)-256));}data=~A;}else{int A=0;for(int C in B){A=(A<<8)|(C&0xFF);}data=A;}}String toString([int A=10]){return data.toRadixString(A);}eF(){return new V(-data);}V abs(){return (data<0)?this.eF():this.VF();}int compareTo(A){if(A is num){return data.compareTo(A);}if(A is V){return data.compareTo(A.data);}return 0;}int IS(A){var C=1,B;if(A is num)A=A.toInt();if((B=A>>16)!=0){A=B;C+= 16;}if((B=A>>8)!=0){A=B;C+= 8;}if((B=A>>4)!=0){A=B;C+= 4;}if((B=A>>2)!=0){A=B;C+= 2;}if((B=A>>1)!=0){A=B;C+= 1;}return C;}void fG(int A,B){B.data=data<<A;}void GD(int A,B){B.data=data>>A;}void IB(A,B){B.data=data-A.data;}void HS(A,B){B.data=data*A.data;}XF(V A,V B,V C){B.data=data~/A.data;C.data=data%A.data;}GS(A){return new V(data%A.data);}isEven(){return data.isEven;}isOdd(){return data.isOdd;}VF(){return new V(this.data);}int yB(){return data;}int nC(){return data.sign;}String nS([int A=10]){return data.toRadixString(A);}void jR(A,B){data=int.parse(A,radix:B,onError:(C)=>0);}List<int> mS(){String G;bool S=false;if(data<0){G=(~data).toRadixString(16);S=true;}else{G=data.toRadixString(16);}int D=0;int L=G.length;int J=(L+1)~/2;int K=0;List A;if(S){if(L&1==1){D=-1;}int B=~int.parse(G.substring(0,D+2),radix:16);if(B<-128)B+= 256;if(B>=0){K=1;A=new List<int>(J+1);A[0]=-1;A[1]=B;}else{A=new List<int>(J);A[0]=B;}for(int C=1;C<J; ++C){int H=~int.parse(G.substring(D+(C<<1),D+(C<<1)+2),radix:16);if(H<-128)H+= 256;A[C+K]=H;}}else{if(L&1==1){D=-1;}int B=int.parse(G.substring(0,D+2),radix:16);if(B>127)B-= 256;if(B<0){K=1;A=new List<int>(J+1);A[0]=0;A[1]=B;}else{A=new List<int>(J);A[0]=B;}for(int C=1;C<J; ++C){int H=int.parse(G.substring(D+(C<<1),D+(C<<1)+2),radix:16);if(H>127)H-= 256;A[C+K]=H;}}return A;}bool ED(V A){return this.compareTo(A)==0?true:false;}void eI(V A,Function B,V C){C.data=B(data,A.data);}OS(A,B){return A&B;}YG(A){return new V(data&A.data);}PS(A,B){return A|B;}hD(A){return new V(data|A.data);}QS(A,B){return A^B;}kM(A){return new V(data^A.data);}jG(){return new V(~data);}XM(int A){return new V(data<<A);}YM(int A){return new V(data>>A);}XG(A,B){B.data=data+A.data;}V add(A){return new V(data+A.data);}V subtract(A){return new V(data-A.data);}V PM(A){return new V(data*A.data);}V cG(A){return new V(data~/A.data);}V remainder(V A){return new V(data.remainder(A.data));}yL(A){data*= A;}xL(A,B){if(B==0){data+= A;}else{throw 'dAddOffset(${A},${B}) not implemented';}}V modInverse(V A){return new V(data.modInverse(A.data));}V operator+(V A)=>add(A);V operator-(V A)=>subtract(A);V operator*(V A)=>PM(A);V operator%(V A)=>GS(A);V operator/(V A)=>cG(A);V operator~/(V A)=>cG(A);V operator-()=>this.eF();bool operator<(V A)=>compareTo(A)<0?true:false;bool operator<=(V A)=>compareTo(A)<=0?true:false;bool operator>(V A)=>compareTo(A)>0?true:false;bool operator>=(V A)=>compareTo(A)>=0?true:false;bool operator==(A)=>compareTo(A)==0?true:false;V operator&(V A)=>YG(A);V operator|(V A)=>hD(A);V operator^(V A)=>kM(A);V operator~()=>jG();V operator<<(int A)=>XM(A);V operator>>(int A)=>YM(A);}class wG<dB>{operator[](var A){return data[A];}operator[]=(var A,var B){if(A>data.length-1){data.length=A+1;}return data[A]=B;}List<dB> data=new List<dB>();}class U implements iF{static int tE;static int n;static int AC;static int EE;static int xG;static int BN;static int NJ;static int OJ;static U RB(){return new U(null,null,null);}static U FE(int B){var A=RB();A.pI(B);return A;}static U get JD=>FE(0);static U get CN=>FE(1);static final List<int> DN=const[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];static int XT;static int YT=0xdeadbeefcafe;static bool ZT;wG<int> X;Function dI;static var EN="0123456789abcdefghijklmnopqrstuvwxyz";static Map GE;int P;var Y;U([A,B,C]){bT(28);dI=Gc;this.X=new wG<int>();if(A!=null){if(A is int){this.ZF(A.toString(),10);}else if(A is num){this.ZF(A.toInt().toString(),10);}else if(B==null&&A is!String){this.ZF(A,256);}else{this.ZF(A,B);}}}Gc(C,D,f,G,B,p){var H=this.X;var J=f.X;var K=D.toInt()&0x3fff,L=D.toInt()>>14;while( --p>=0){var A=H[C]&0x3fff;var S=H[C++ ]>>14;var W=L*A+S*K;A=K*A+((W&0x3fff)<<14)+J[G]+B;B=(A>>28)+(W>>14)+L*S;J[G++ ]=A&0xfffffff;}return B;}static aT(int A){tE=A;n=tE;AC=((1<<tE)-1);EE=(1<<tE);xG=52;BN=pow(2,xG);NJ=xG-tE;OJ=2*tE-xG;}static bT(int A){if(GE!=null)return;GE=new Map();ZT=((YT&0xffffff)==0xefcafe);cT();XT=(1<<26)~/DN[DN.length-1];aT(A);}static cT(){EN="0123456789abcdefghijklmnopqrstuvwxyz";GE=new Map();int B,A;B="0".codeUnitAt(0);for(A=0;A<=9; ++A)GE[B++ ]=A;B="a".codeUnitAt(0);for(A=10;A<36; ++A)GE[B++ ]=A;B="A".codeUnitAt(0);for(A=10;A<36; ++A)GE[B++ ]=A;}Hc(A){return EN[A];}Ic(B,C){var A=GE[B.codeUnitAt(C)];return (A==null)?-1:A;}void bG(U B){var C=this.X;var D=B.X;for(var A=this.P-1;A>=0; --A)D[A]=C[A];B.P=this.P;B.Y=this.Y;}void pI(int A){var B=this.X;this.P=1;this.Y=(A<0)?-1:0;if(A>0){B[0]=A;}else if(A<-1){B[0]=A+EE;}else{this.P=0;}}void ZF(D,int C){var G=this.X;var B;if(C==16){B=4;}else if(C==8){B=3;}else if(C==256){B=8;}else if(C==2){B=1;}else if(C==32){B=5;}else if(C==4){B=2;}else{this.jR(D,C);return;}this.P=0;this.Y=0;var J=D.length,K=false,A=0;while( --J>=0){var H=(B==8)?D[J]&0xff:Ic(D,J);if(H<0){if(D[J]=="-")K=true;continue;}K=false;if(A==0){G[this.P++ ]=H;}else if(A+B>n){G[this.P-1]|=(H&((1<<(n-A))-1))<<A;G[this.P++ ]=(H>>(n-A));}else{G[this.P-1]|=H<<A;}A+= B;if(A>=n)A-= n;}if(B==8&&(D[0]&0x80)!=0){this.Y=-1;if(A>0)G[this.P-1]|=((1<<(n-A))-1)<<A;}this.clamp();if(K)U.JD.IB(this,this);}String toString([int D]){var H=this.X;if(this.Y<0){return "-${this.eF().toString(D)}";}var A;if(D==16){A=4;}else if(D==8){A=3;}else if(D==2){A=1;}else if(D==32){A=5;}else if(D==4){A=2;}else{return this.nS(D);}var L=(1<<A)-1,G,J=false,K="",C=this.P;var B=n-(C*n)%A;if(C-- >0){if(B<n&&(G=H[C]>>B)>0){J=true;K=Hc(G);}while(C>=0){if(B<A){G=(H[C]&((1<<B)-1))<<(A-B);G|= H[ --C]>>(B+= n-A);}else{G=(H[C].toInt()>>(B-= A.toInt()).toInt())&L.toInt();if(B<=0){B+= n; --C;}}if(G>0)J=true;if(J)K="${K}${Hc(G)}";}}return J?K:"0";}eF(){var A=RB();U.JD.IB(this,A);return A;}U abs(){return (this.Y<0)?this.eF():this;}int compareTo(B){if(B is num){B=new U(B);}var D=this.X;var G=B.X;var A=this.Y-B.Y;if(A!=0)return A;var C=this.P;A=C-B.P;if(A!=0)return A;while( --C>=0)if((A=D[C]-G[C])!=0)return A;return 0;}int IS(A){var C=1,B;if(A is num)A=A.toInt();if((B=A>>16)!=0){A=B;C+= 16;}if((B=A>>8)!=0){A=B;C+= 8;}if((B=A>>4)!=0){A=B;C+= 4;}if((B=A>>2)!=0){A=B;C+= 2;}if((B=A>>1)!=0){A=B;C+= 1;}return C;}void AM(B,C){var G=this.X;var D=C.X;var A;for(A=this.P-1;A>=0; --A)D[A+B]=G[A];for(A=B-1;A>=0; --A)D[A]=0;C.P=this.P+B;C.Y=this.Y;}void mZ(B,C){var D=this.X;var G=C.X;for(var A=B;A<this.P; ++A)G[A-B]=D[A];C.P=rE.max(this.P-B,0);C.Y=this.Y;}void fG(J,B){var K=this.X;var D=B.X;var G=J%n;var L=n-G;var S=(1<<L)-1;int C=J~/n;var H=(this.Y<<G)&AC;var A;for(A=this.P-1;A>=0; --A){D[A+C+1]=(K[A]>>L)|H;H=(K[A]&S)<<G;}for(A=C-1;A>=0; --A)D[A]=0;D[C]=H;B.P=this.P+C+1;B.Y=this.Y;B.clamp();}void GD(J,C){var H=this.X;var G=C.X;C.Y=this.Y;var A=J~/n;if(A>=this.P){C.P=0;return;}var D=J%n;var K=n-D;var L=(1<<D)-1;G[0]=H[A]>>D;for(var B=A+1;B<this.P; ++B){G[B-A-1]|=(H[B]&L)<<K;G[B-A]=H[B]>>D;}if(D>0)G[this.P-A-1]|=(this.Y&L)<<K;C.P=this.P-A;C.clamp();}void clamp(){var A=this.X;var B=this.Y&AC;while(this.P>0&&A[this.P-1]==B){ --this.P;}}void IB(C,G){var H=this.X;var D=G.X;var J=C.X;int B=0;int A=0;int K=rE.min(C.P,this.P);while(B<K){A+= (H[B].toInt()-J[B].toInt()).toInt();D[B++ ]=A&AC;A>>= n;if(A==4294967295){A=-1;}}if(C.P<this.P){A-= C.Y;while(B<this.P){A+= H[B];D[B++ ]=A&AC;A>>= n;if(A==4294967295){A=-1;}}A+= this.Y;}else{A+= this.Y;while(B<C.P){A-= J[B];D[B++ ]=A&AC;A>>= n;if(A==4294967295){A=-1;}}A-= C.Y;}G.Y=(A<0)?-1:0;if(A<-1){D[B++ ]=EE+A;}else if(A>0){D[B++ ]=A;}G.P=B;G.clamp();}bool Jc=true;void HS(G,B){var K=this.X;var H=B.X;U C=this.abs();U D=G.abs();var J=D.X;var A=C.P;B.P=A+D.P;while( --A>=0)H[A]=0;for(A=0;A<D.P; ++A)H[A+C.P]=C.dI(0,J[A],B,A,0,C.P);B.Y=0;B.clamp();if(this.Y!=G.Y){U.JD.IB(B,B);}}XF(U vB,D,U A){var H=vB.abs();if(H.P<=0)return;var W=this.abs();if(W.P<H.P){if(D!=null)D.pI(0);if(A!=null)this.bG(A);return;}if(A==null)A=RB();var B=RB(),GC=this.Y,rG=vB.Y;var sG=H.X;var L=n-IS(sG[H.P-1]);if(L>0){H.fG(L,B);W.fG(L,A);}else{H.bG(B);W.bG(A);}var C=B.P;var f=B.X;var p=f[C-1];if(p==0)return;var ID=p*(1<<NJ)+((C>1)?f[C-2]>>OJ:0);var tG=BN/ID,uG=(1<<NJ)/ID,AT=1<<OJ;var J=A.P,S=J-C;U G=(D==null)?RB():D;B.AM(S,G);var K=A.X;if(A.compareTo(G)>=0){K[A.P++ ]=1;A.IB(G,A);}U.CN.AM(C,G);G.IB(B,B);while(B.P<C)f[B.P++ ]=0;while( --S>=0){var XB=(K[ --J]==p)?AC:(K[J]*tG+(K[J-1]+AT)*uG).floor();if((K[J]+=B.dI(0,XB,A,S,0,C))<XB){B.AM(S,G);A.IB(G,A);while(K[J]< --XB)A.IB(G,A);}}if(D!=null){A.mZ(C,D);if(GC!=rG)U.JD.IB(D,D);}A.P=C;A.clamp();if(L>0)A.GD(L,A);if(GC<0)U.JD.IB(A,A);}GS(B){var A=RB();this.abs().XF(B,null,A);if(this.Y<0&&A.compareTo(U.JD)>0)B.IB(A,A);return A;}isEven(){var A=this.X;return ((this.P>0)?(A[0]&1):this.Y)==0;}isOdd()=>!isEven();VF(){var A=RB();this.bG(A);return A;}int yB(){var A=this.X;if(this.Y<0){if(this.P==1){return A[0]-EE;}else if(this.P==0)return -1;}else if(this.P==1){return A[0];}else if(this.P==0)return 0;return ((A[1]&((1<<(32-n))-1))<<n)|A[0];}int OR(A){return (LN2*n/log(A)).floor().toInt();}int nC(){var A=this.X;if(this.Y<0){return -1;}else if(this.P<=0||(this.P==1&&A[0]<=0)){return 0;}else{return 1;}}String nS([int A=10]){if(A==null)A=10;if(this.nC()==0||A<2||A>36)return "0";var J=this.OR(A);int G=pow(A,J);var H=FE(G),B=RB(),C=RB(),D="";this.XF(H,B,C);while(B.nC()>0){D="${(G+C.yB()).toInt().toRadixString(A).substring(1)}${D}";B.XF(H,B,C);}return "${C.yB().toRadixString(A)}${D}";}void jR(C,A){this.pI(0);if(A==null)A=10;var H=this.OR(A);num L=pow(A,H);bool J=false;int D=0,B=0;for(var G=0;G<C.length; ++G){var K=Ic(C,G);if(K<0){if(C is String){if(C[0]=="-"&&this.nC()==0){J=true;}}continue;}B=A*B+K;if( ++D>=H){this.yL(L);this.xL(B,0);D=0;B=0;}}if(D>0){this.yL(pow(A,D));if(B!=0){this.xL(B,0);}}if(J){U.JD.IB(this,this);}}List<int> mS(){var G=this.X;var C=this.P;wG<int> H=new wG<int>();H[0]=this.Y;var A=n-(C*n)%8,B,D=0;if(C-- >0){if(A<n&&(B=G[C]>>A)!=(this.Y&AC)>>A){H[D++ ]=B|(this.Y<<(n-A));}while(C>=0){if(A<8){B=(G[C]&((1<<A)-1))<<(8-A);B|= G[ --C]>>(A+= n-8);}else{B=(G[C]>>(A-= 8))&0xff;if(A<=0){A+= n; --C;}}if((B&0x80)!=0)B|= -256;if(D==0&&(this.Y&0x80)!=(B&0x80)) ++D;if(D>0||B!=this.Y)H[D++ ]=B;}}return H.data;}bool ED(U A){return this.compareTo(A)==0?true:false;}void eI(U B,Function D,U C){var K=this.X;var L=B.X;var H=C.X;var A,G,J=rE.min(B.P,this.P);for(A=0;A<J; ++A)H[A]=D(K[A],L[A]);if(B.P<this.P){G=B.Y&AC;for(A=J;A<this.P; ++A)H[A]=D(K[A],G);C.P=this.P;}else{G=this.Y&AC;for(A=J;A<B.P; ++A)H[A]=D(G,L[A]);C.P=B.P;}C.Y=D(this.Y,B.Y);C.clamp();}OS(A,B){return A&B;}YG(B){var A=RB();this.eI(B,OS,A);return A;}PS(A,B){return A|B;}hD(B){var A=RB();this.eI(B,PS,A);return A;}QS(A,B){return A^B;}kM(B){var A=RB();this.eI(B,QS,A);return A;}jG(){var C=this.X;var A=RB();var D=A.X;for(var B=0;B<this.P; ++B){D[B]=AC&~C[B];}A.P=this.P;A.Y=~this.Y;return A;}XM(A){var B=RB();if(A<0){this.GD(-A,B);}else{this.fG(A,B);}return B;}YM(A){var B=RB();if(A<0){this.fG(-A,B);}else{this.GD(A,B);}return B;}XG(C,G){var H=this.X;var J=C.X;var D=G.X;var B=0,A=0,K=rE.min(C.P,this.P);while(B<K){A+= H[B]+J[B];D[B++ ]=A&AC;A>>= n;}if(C.P<this.P){A+= C.Y;while(B<this.P){A+= H[B];D[B++ ]=A&AC;A>>= n;}A+= this.Y;}else{A+= this.Y;while(B<C.P){A+= J[B];D[B++ ]=A&AC;A>>= n;}A+= C.Y;}G.Y=(A<0)?-1:0;if(A>0){D[B++ ]=A;}else if(A<-1)D[B++ ]=EE+A;G.P=B;G.clamp();}U add(B){var A=RB();this.XG(B,A);return A;}U subtract(B){var A=RB();this.IB(B,A);return A;}U PM(B){var A=RB();this.HS(B,A);return A;}U cG(B){var A=RB();this.XF(B,A,null);return A;}U remainder(U B){U A=RB();this.XF(B,null,A);return (A.nC()>=0)?A:(A+B);}yL(A){var B=this.X;B[this.P]=this.dI(0,A-1,this,0,0,this.P); ++this.P;this.clamp();}xL(C,A){var B=this.X;while(this.P<=A)B[this.P++ ]=0;B[A]+=C;while(B[A]>=EE){B[A]-=EE;if( ++A>=this.P)B[this.P++ ]=0; ++B[A];}}U modInverse(U B){var K=B.isEven();if((this.isEven()&&K)||B.nC()==0)return U.JD;var G=B.VF(),C=this.VF();if(C.nC()<0)C=-C;var H=FE(1),D=FE(0),J=FE(0),A=FE(1);while(G.nC()!=0){while(G.isEven()){G.GD(1,G);if(K){if(!H.isEven()||!D.isEven()){H.XG(this,H);D.IB(B,D);}H.GD(1,H);}else if(!D.isEven())D.IB(B,D);D.GD(1,D);}while(C.isEven()){C.GD(1,C);if(K){if(!J.isEven()||!A.isEven()){J.XG(this,J);A.IB(B,A);}J.GD(1,J);}else if(!A.isEven())A.IB(B,A);A.GD(1,A);}if(G.compareTo(C)>=0){G.IB(C,G);if(K)H.IB(J,H);D.IB(A,D);}else{C.IB(G,C);if(K)J.IB(H,J);A.IB(D,A);}}if(C.compareTo(U.CN)!=0)return U.JD;if(A.compareTo(B)>=0)return Kc(A.subtract(B),B);if(A.nC()<0)A.XG(B,A);else return Kc(A,B);if(A.nC()<0)return Kc(A.add(B),B);else return Kc(A,B);}Kc(A,B)=>(nC()<0)?(B-A):A;U operator+(U A)=>add(A);U operator-(U A)=>subtract(A);U operator*(U A)=>PM(A);U operator%(U A)=>remainder(A);U operator/(U A)=>cG(A);U operator~/(U A)=>cG(A);U operator-()=>this.eF();bool operator<(U A)=>compareTo(A)<0?true:false;bool operator<=(U A)=>compareTo(A)<=0?true:false;bool operator>(U A)=>compareTo(A)>0?true:false;bool operator>=(U A)=>compareTo(A)>=0?true:false;bool operator==(A)=>compareTo(A)==0?true:false;U operator&(U A)=>YG(A);U operator|(U A)=>hD(A);U operator^(U A)=>kM(A);U operator~()=>jG();U operator<<(int A)=>XM(A);U operator>>(int A)=>YM(A);}const int PJ=0x0A;const int FN=0x0D;const int QJ=0x2B;const int RJ=0x2D;const int yG=0x2E;const int uE=0x30;const int zG=0x39;const int dT=0x46;const int eT=0x4E;const int fT=0x54;const int gT=0x66;const int hT=0x6E;const int iT=0x6F;const int jT=0x74;const int kT=0x78;const int lT=0x7E;const String OW='\u001b[31m';const String jO='\u001b[0m';abstract class kD{}class lD{static String ON(List<int> A){return TJ.nT(A);}static String FH(List<int> A,{bool urlSafe: false,bool addLineSeparator: false}){return TJ.pT(A,urlSafe,addLineSeparator);}static List<int> QN(String A){return TJ.rT(A);}}const WJ NN=const WJ();const List<int> UJ=const[-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-1,-2,-2,-1,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,62,-2,62,-2,63,52,53,54,55,56,57,58,59,60,61,-2,-2,-2,0,-2,-2,-2,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-2,-2,-2,-2,63,-2,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2];const String uT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";const String vT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const int wT=76;const int xT=13;const int yT=10;const List<int> PN=const[61];const List<int> KE=const[37,51,68];const String zT="=";const String VJ="%3D";class WJ extends Codec<List<int>,String>{final bool Lc;final bool Mc;final bool Nc;const WJ({bool urlSafe: false,bool addLineSeparator: false,bool encodePaddingCharacter: false}):Lc=urlSafe,Mc=addLineSeparator,Nc=encodePaddingCharacter;String get name=>"base64";String encode(List<int> A,{bool urlSafe,bool addLineSeparator,bool encodePaddingCharacter}){if(urlSafe==null)urlSafe=Lc;if(addLineSeparator==null)addLineSeparator=Mc;if(encodePaddingCharacter==null){encodePaddingCharacter=Nc;}return new wE(urlSafe:urlSafe,addLineSeparator:addLineSeparator,encodePaddingCharacter:encodePaddingCharacter).convert(A);}wE get encoder=>new wE(urlSafe:Lc,addLineSeparator:Mc,encodePaddingCharacter:Nc);lF get decoder=>new lF();}class wE extends Converter<List<int>,String>{final bool Lc;final bool Mc;final bool Nc;final List<int> Oc;const wE({bool urlSafe: false,bool addLineSeparator: false,bool encodePaddingCharacter: false}):Lc=urlSafe,Mc=addLineSeparator,Nc=encodePaddingCharacter,Oc=encodePaddingCharacter==true?KE:PN;String convert(List<int> G,[int W=0,int K]){int p=G.length;RangeError.checkValidRange(W,K,p);if(K==null)K=p;int L=K-W;if(L==0){return "";}final String D=Lc?uT:vT;final int J=L.remainder(3);final int GC=L-J;int ID=((L~/3)*4);int f;if(Nc){f=((J>0)?6:0);}else{f=((J>0)?4:0);}int S=ID+f;if(Mc){S+= ((S-1)~/wT)<<1;}List<int> B=new List<int>(S);int A=0,H=W,XB=0;while(H<GC){int C=((G[H++ ]<<16)&0x00FFFFFF)|((G[H++ ]<<8)&0x00FFFFFF)|G[H++ ];B[A++ ]=D.codeUnitAt(C>>18);B[A++ ]=D.codeUnitAt((C>>12)&0x3F);B[A++ ]=D.codeUnitAt((C>>6)&0x3F);B[A++ ]=D.codeUnitAt(C&0x3F);if(Mc&& ++XB==19&&A<S-2){B[A++ ]=xT;B[A++ ]=yT;XB=0;}}if(J==1){int C=G[H];B[A++ ]=D.codeUnitAt(C>>2);B[A++ ]=D.codeUnitAt((C<<4)&0x3F);B.setRange(A,A+Oc.length,Oc);B.setRange(A+Oc.length,A+2*Oc.length,Oc);}else if(J==2){int C=G[H];int vB=G[H+1];B[A++ ]=D.codeUnitAt(C>>2);B[A++ ]=D.codeUnitAt(((C<<4)|(vB>>4))&0x3F);B[A++ ]=D.codeUnitAt((vB<<2)&0x3F);B.setRange(A,A+Oc.length,Oc);}return new String.fromCharCodes(B);}XJ startChunkedConversion(Sink<String> A){StringConversionSink B;if(A is StringConversionSink){B=A;}else{B=new StringConversionSink.from(A);}return new XJ(B,Lc,Mc);}}class XJ extends ChunkedConversionSink<List<int>>{final wE Pc;final ChunkedConversionSink<String> Qc;final List<int> Rc=new List<int>();int Sc=0;XJ(this.Qc,A,B):Pc=new wE(urlSafe:A,addLineSeparator:B);void add(List<int> A){var B=(A.length+Sc)%3;int C=Sc+A.length-B;if(Sc+A.length>Rc.length){Rc.replaceRange(Sc,Rc.length,A.sublist(0,Rc.length-Sc));Rc.addAll(A.sublist(Rc.length-Sc));}else{Rc.replaceRange(Sc,Sc+A.length,A);}Qc.add(Pc.convert(Rc,0,C));Rc.removeRange(0,C);Sc=B;}void close(){if(Sc>0){Qc.add(Pc.convert(Rc.sublist(0,Sc)));}Qc.close();}}class lF extends Converter<String,List<int>>{const lF();List<int> convert(String B){int J=B.length;if(J==0){return new Uint8List(0);}int D=0;int A=0;while(A<J){int f=B.codeUnitAt(A);int G=UJ[f];if(G==-2){if(f==KE[0]&&A<J-2&&B.codeUnitAt(A+1)==KE[1]&&B.codeUnitAt(A+2)==KE[2]){D++ ;A+= 2;}else{throw new FormatException('Invalid character',B,A);}}if(G>=0)D++ ;A++ ;}if(D%4!=0){throw new FormatException('''Size of Base 64 characters in Input
          must be a multiple of 4''',B,D);}int S=0;A=J-1;while(A>=0){int W=B.codeUnitAt(A);if(W==KE[2]&&A>=2&&B.codeUnitAt(A-1)==KE[1]&&B.codeUnitAt(A-2)==KE[0]){S++ ;A-= 2;}else if(UJ[W]>0){break;}else if(W==PN[0]){S++ ;}A-- ;}int K=((D*6)>>3)-S;List<int> L=new Uint8List(K);for(int A=0,C=0;C<K;){int H=0;for(int p=4;p>0;){int G=UJ[B.codeUnitAt(A++ )];if(G>=0){H=((H<<6)&0x00FFFFFF)|G;p-- ;}}L[C++ ]=H>>16;if(C<K){L[C++ ]=(H>>8)&0xFF;if(C<K)L[C++ ]=H&0xFF;}}return L;}YJ startChunkedConversion(Sink<List<int>> A){if(A is!ByteConversionSink){A=new ByteConversionSink.from(A);}return new YJ(A);}}class YJ extends ChunkedConversionSink<String>{final lF Tc=new lF();final ChunkedConversionSink<List<int>> Qc;String Uc="";YJ(this.Qc);void add(String A){if(A.isEmpty)return;if(Uc.isNotEmpty){A=Uc+A;}A=A.replaceAll(VJ,zT);int B=A.length;if(A.length>3&&A.contains(VJ[0],A.length-2)){B=A.lastIndexOf(VJ[0]);}B-= B%4;Uc=A.substring(B);if(B>0){Qc.add(Tc.convert(A.substring(0,B)));}}void close(){if(Uc.isNotEmpty){Qc.add(Tc.convert(Uc));}Qc.close();}}abstract class TJ{static String nT(List<int> C){var A=new StringBuffer();for(var B in C){A.write('${B<16?'0':''}${B.toRadixString(16)}');}return A.toString();}static String pT(List<int> A,[bool B=false,bool C=false]){return NN.encode(A,urlSafe:B,addLineSeparator:C);}static List<int> rT(String A){return NN.decode(A);}}const JE=0xff;const aC=0xffffffff;const oT=8;const kF=4;int CH(int A,int C){var B=C&31;return ((A<<B)&aC)|((A&aC)>>(32-B));}abstract class EH implements kD{final int Vc;final int Wc;final bool Xc;final Uint32List Yc;final Uint32List Zc;int ac=0;List<int> bc;bool cc=false;EH(int A,int B,bool this.Xc):bc=[] ,Yc=new Uint32List(A),Zc=new Uint32List(B),Vc=A,Wc=B;void add(List<int> A){if(cc){throw new StateError('Hash update method called after digest was retrieved');}ac+= A.length;bc.addAll(A);dc();}List<int> close(){if(cc){return ec();}cc=true;fc();dc();assert(bc.length==0);return ec();}int get blockSize{return Vc*kF;}void gc(Uint32List A);int hc(A,B)=>(A+B)&aC;int ic(B,A)=>(B+A-1)&-A;List<int> ec(){var B=[] ;for(var A=0;A<Zc.length;A++ ){B.addAll(jc(Zc[A]));}return B;}void kc(List<int> B,int A){assert((B.length-A)>=(Vc*kF));for(var D=0;D<Vc;D++ ){var G=Xc?B[A]:B[A+3];var H=Xc?B[A+1]:B[A+2];var J=Xc?B[A+2]:B[A+1];var K=Xc?B[A+3]:B[A];A+= 4;var C=(G&0xff)<<24;C|= (H&JE)<<16;C|= (J&JE)<<8;C|= (K&JE);Yc[D]=C;}}List<int> jc(int B){List A=new List<int>(kF);A[0]=(B>>(Xc?24:0))&JE;A[1]=(B>>(Xc?16:8))&JE;A[2]=(B>>(Xc?8:16))&JE;A[3]=(B>>(Xc?0:24))&JE;return A;}void dc(){var B=bc.length;var C=Vc*kF;if(B>=C){var A=0;for(;(B-A)>=C;A+= C){kc(bc,A);gc(Yc);}bc=bc.sublist(A,B);}}void fc(){bc.add(0x80);var B=ac+9;var D=Vc*kF;var G=ic(B,D);var H=G-B;for(var C=0;C<H;C++ ){bc.add(0);}var A=ac*oT;assert(A<pow(2,32));if(Xc){bc.addAll(jc(0));bc.addAll(jc(A&aC));}else{bc.addAll(jc(A&aC));bc.addAll(jc(0));}}}class DH{final List<int> lc;kD mc;List<int> nc;bool oc=false;DH(kD this.mc,List<int> this.nc):lc=[] ;void add(List<int> A){if(oc)throw new StateError("HMAC is closed");lc.addAll(A);}List<int> get kZ{var B=mc.blockSize;if(nc.length>B){mc=mc.newInstance();mc.add(nc);nc=mc.close();}if(nc.length<B){var D=new List(B);D.setRange(0,nc.length,nc);for(var A=nc.length;A<B;A++ ){D[A]=0;}nc=D;}var C=new List(B);for(var A=0;A<B;A++ ){C[A]=0x36^nc[A];}mc=mc.newInstance();mc.add(C);mc.add(lc);var G=mc.close();for(var A=0;A<B;A++ ){C[A]=0x5c^nc[A];}mc=mc.newInstance();mc.add(C);mc.add(G);return mc.close();}List<int> close(){oc=true;return kZ;}}class BH extends EH{BH():super(16,4,false){Zc[0]=0x67452301;Zc[1]=0xefcdab89;Zc[2]=0x98badcfe;Zc[3]=0x10325476;}BH newInstance(){return new BH();}static const qT=const[0xd76aa478,0xe8c7b756,0x242070db,0xc1bdceee,0xf57c0faf,0x4787c62a,0xa8304613,0xfd469501,0x698098d8,0x8b44f7af,0xffff5bb1,0x895cd7be,0x6b901122,0xfd987193,0xa679438e,0x49b40821,0xf61e2562,0xc040b340,0x265e5a51,0xe9b6c7aa,0xd62f105d,0x02441453,0xd8a1e681,0xe7d3fbc8,0x21e1cde6,0xc33707d6,0xf4d50d87,0x455a14ed,0xa9e3e905,0xfcefa3f8,0x676f02d9,0x8d2a4c8a,0xfffa3942,0x8771f681,0x6d9d6122,0xfde5380c,0xa4beea44,0x4bdecfa9,0xf6bb4b60,0xbebfbc70,0x289b7ec6,0xeaa127fa,0xd4ef3085,0x04881d05,0xd9d4d039,0xe6db99e5,0x1fa27cf8,0xc4ac5665,0xf4292244,0x432aff97,0xab9423a7,0xfc93a039,0x655b59c3,0x8f0ccc92,0xffeff47d,0x85845dd1,0x6fa87e4f,0xfe2ce6e0,0xa3014314,0x4e0811a1,0xf7537e82,0xbd3af235,0x2ad7d2bb,0xeb86d391];static const tT=const[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];void gc(Uint32List K){assert(K.length==16);var J=Zc[0];var B=Zc[1];var D=Zc[2];var C=Zc[3];var G;var H;for(var A=0;A<64;A++ ){if(A<16){G=(B&D)|((~B&aC)&C);H=A;}else if(A<32){G=(C&B)|((~C&aC)&D);H=((5*A)+1)%16;}else if(A<48){G=B^D^C;H=((3*A)+5)%16;}else{G=D^(B|(~C&aC));H=(7*A)%16;}var L=C;C=D;D=B;B=hc(B,CH(hc(hc(J,G),hc(qT[A],K[H])),tT[A]));J=L;}Zc[0]=hc(J,Zc[0]);Zc[1]=hc(B,Zc[1]);Zc[2]=hc(D,Zc[2]);Zc[3]=hc(C,Zc[3]);}}class vE extends EH{final Uint32List pc;vE():pc=new Uint32List(80),super(16,5,true){Zc[0]=0x67452301;Zc[1]=0xEFCDAB89;Zc[2]=0x98BADCFE;Zc[3]=0x10325476;Zc[4]=0xC3D2E1F0;}vE newInstance(){return new vE();}void gc(Uint32List K){assert(K.length==16);var H=Zc[0];var B=Zc[1];var D=Zc[2];var G=Zc[3];var J=Zc[4];for(var A=0;A<80;A++ ){if(A<16){pc[A]=K[A];}else{var L=pc[A-3]^pc[A-8]^pc[A-14]^pc[A-16];pc[A]=CH(L,1);}var C=hc(hc(CH(H,5),J),pc[A]);if(A<20){C=hc(hc(C,(B&D)|(~B&G)),0x5A827999);}else if(A<40){C=hc(hc(C,(B^D^G)),0x6ED9EBA1);}else if(A<60){C=hc(hc(C,(B&D)|(B&G)|(D&G)),0x8F1BBCDC);}else{C=hc(hc(C,B^D^G),0xCA62C1D6);}J=G;G=D;D=CH(B,30);B=H;H=C&aC;}Zc[0]=hc(H,Zc[0]);Zc[1]=hc(B,Zc[1]);Zc[2]=hc(D,Zc[2]);Zc[3]=hc(G,Zc[3]);Zc[4]=hc(J,Zc[4]);}}class AH extends EH{final Uint32List pc;AH():pc=new Uint32List(64),super(16,8,true){Zc[0]=0x6a09e667;Zc[1]=0xbb67ae85;Zc[2]=0x3c6ef372;Zc[3]=0xa54ff53a;Zc[4]=0x510e527f;Zc[5]=0x9b05688c;Zc[6]=0x1f83d9ab;Zc[7]=0x5be0cd19;}AH newInstance(){return new AH();}static const List<int> sT=const[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0x0fc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x06ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2];qc(A,B)=>(B>>A)|((B<<(32-A))&aC);rc(A,B,C)=>(A&B)^((~A&aC)&C);sc(A,B,C)=>(A&B)^(A&C)^(B&C);tc(A)=>qc(2,A)^qc(13,A)^qc(22,A);uc(A)=>qc(6,A)^qc(11,A)^qc(25,A);vc(A)=>qc(7,A)^qc(18,A)^(A>>3);wc(A)=>qc(17,A)^qc(19,A)^(A>>10);void gc(Uint32List W){assert(W.length==16);var A=0;for(;A<16;A++ ){pc[A]=W[A];}for(;A<64;A++ ){pc[A]=hc(hc(wc(pc[A-2]),pc[A-7]),hc(vc(pc[A-15]),pc[A-16]));}var B=Zc[0];var D=Zc[1];var G=Zc[2];var L=Zc[3];var C=Zc[4];var H=Zc[5];var J=Zc[6];var S=Zc[7];for(var K=0;K<64;K++ ){var f=hc(hc(S,uc(C)),hc(rc(C,H,J),hc(sT[K],pc[K])));var p=hc(tc(B),sc(B,D,G));S=J;J=H;H=C;C=hc(L,f);L=G;G=D;D=B;B=hc(f,p);}Zc[0]=hc(B,Zc[0]);Zc[1]=hc(D,Zc[1]);Zc[2]=hc(G,Zc[2]);Zc[3]=hc(L,Zc[3]);Zc[4]=hc(C,Zc[4]);Zc[5]=hc(H,Zc[5]);Zc[6]=hc(J,Zc[6]);Zc[7]=hc(S,Zc[7]);}}const String CT="""
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>Label</key>
  <string>com.dglogik.dglux-server</string>
  <key>ProgramArguments</key>
  <array>
    <string>{{dart.path}}</string>
    <string>{{watcher.file}}</string>
    <string>--log-file=logs/dglux_server.log</string>
  </array>
  <key>RunAtLoad</key>
  <true/>
  <key>KeepAlive</key>
  <false/>
  <key>WorkingDirectory</key>
  <string>{{dir.path}}</string>
  <key>HardResourceLimits</key>
  <dict>
    <key>NumberOfFiles</key>
    <integer>4096</integer>
  </dict>
  <key>SoftResourceLimits</key>
  <dict>
    <key>NumberOfFiles</key>
    <integer>4096</integer>
  </dict>
</dict>
</plist>
""";final Map<String,String> lM={"start":"Start DGLux Server","stop":"Stop DGLux Server","restart":"Restart DGLux Server","run":"Run DGLux Server","configure":"Configure DGLux Server","verify":"Verify DGLux Server Configuration","install-service":"Install DGLux Server System Service","uninstall-service":"Uninstall DGLux Server System Service","rebind":"Rebind DGLux Server","help":"Display this Help Message"};main(List<String> A)async{zU();if(A.isEmpty||(A.length==1&&const["--help","help"].contains(A[0]))){print("Usage: daemon <command> [args]");print("Commands:");for(String B in lM.keys){print("  ${B}: ${lM[B]}");}exit(A.isEmpty?1:0);}var D=Platform.script.toFilePath(windows:Platform.isWindows);var G=UH(D);var C=UH(G);var H=new File(YB(C,"bin","daemon.dart"));if(await H.exists()){Directory.current=new Directory(C);}await gF(A.join(" "));exit(0);}String JJ;gF(String B,{bool doExit: true})async{var ID=Platform.script;var rG=ID.toFilePath(windows:Platform.isWindows);JJ=UH(rG);if(B=="start"){await mM();if(doExit){exit(0);}}else if(B=="stop"){if(!(await qM())){print("Server is not running.");try {await DE.delete(recursive:true);}catch (vB){}if(doExit){exit(1);}}var A=await oM("stop");if(!A){print("Failed to stop server.");if(doExit){exit(1);}return;}else{print("Server Stopped.");}try {await DE.delete(recursive:true);}catch (vB){}if(doExit){exit(0);}}else if(B=="restart"){await gF("stop",doExit:false);await gF("start");}else if(B=="verify"){await nM();}else if(B=="install-service"){await gF("verify");if(Platform.isWindows){var G=rO.bK==32?"nssm-x32.exe":"nssm-x64.exe";var L=new File(YB("bin","server_watcher.bat")).absolute;if(!(await L.exists())){L=new File(YB("bin","dglux_server.bat")).absolute;}if(!(await L.exists())){print("Failed to find the server script.");exit(1);}var S=await Process.run("sc.exe",["query","dglux_server"]);var H=Directory.current.absolute.path;var GC=new vE();GC.add(UTF8.encode(H));var A=lD.ON(GC.close());var J=new File("C:\\services\\${A}_dgserver.bat");if(!(await J.exists())){await J.create(recursive:true);}H=VH(H).map((W){return W.contains(" ")?'"${W}"':W;}).join("\\");await J.writeAsString("""
      @echo off
      cd /d ${H}
      bin\\server_watcher.bat --log-file=logs\\dglux_server.log
      """);if(S.exitCode!=0){var K=await Process.run("cmd",["/C",YB("bin","tools",G),"install","dglux_server",J.path]);var sG=await Process.run(YB("bin","tools",G),["set","dglux_server","DisplayName","DGLux Server"]);var tG=await Process.run(YB("bin","tools",G),["set","dglux_server","Description","DGLux Server"]);if(K.exitCode!=0||sG.exitCode!=0||tG.exitCode!=0){print("Failed to Install Windows Service!");print("STDOUT:");print(K.stdout);if(K.stderr.isNotEmpty){print("STDERR:");print(K.stderr);}exit(1);}else{print("Windows Service Installed.");var uG=await Process.run("net",["start","dglux_server"]);if(uG.exitCode!=0){print("Failed to start Windows Service.");exit(1);}print("Windows Service Started.");}exit(0);}else{print("Windows Service is already installed.");exit(1);}}else if(Platform.isMacOS){var C=new File(YB(Platform.environment["HOME"],"Library","LaunchAgents","com.dglogik.dglux-server.plist"));if(await C.exists()){print("Service is already installed.");exit(1);}var f=new File("bin/server_watcher.dart");if(!(await f.exists())){f=new File("bin/watcher.dart");}String D=CT;D=D.replaceAll("{{dart.path}}",vN());D=D.replaceAll("{{dir.path}}",Directory.current.absolute.path);D=D.replaceAll("{{watcher.file}}",f.absolute.path);await C.writeAsString(D);var A=await Process.run("launchctl",["load",C.absolute.path]);if(A.exitCode!=0){print("Failed to Install Service:");if(A.stdout.isNotEmpty){print("STDOUT:");print(A.stdout);}if(A.stderr.isNotEmpty){print("STDERR:");print(A.stderr);}exit(A.exitCode);}print("Service Installed.");exit(0);}else{print("Services are not supported on your Operating System.");exit(1);}}else if(B=="uninstall-service"){if(Platform.isWindows){var G=rO.bK==32?"nssm-x32.exe":"nssm-x64.exe";var S=await Process.run("sc.exe",["query","dglux_server"]);if(S.exitCode==0){var p=await Process.run(YB("bin","tools",G),["remove","dglux_server","confirm"]);if(p.exitCode!=0){print("Failed to Uninstall Windows Service!");print("STDOUT:");print(p.stdout);print("STDERR:");print(p.stderr);exit(1);}else{print("Windows Service Uninstalled.");}}else{print("Windows Service is Not Installed");exit(1);}}else if(Platform.isMacOS){var C=new File(YB(Platform.environment["HOME"],"Library","LaunchAgents","com.dglogik.dglux-server.plist"));if(!(await C.exists())){print("Service is not installed.");exit(1);}await Process.run("launchctl",["unload",C.absolute.path]);await C.delete();print("Service Uninstalled.");exit(0);}else{print("Services are not supported on your Operating System.");exit(1);}}else if(B=="rebind"){var A=await oM("rebind");if(A){print("Server Rebound.");if(doExit){exit(0);return;}}else{print("Rebind Failed.");if(doExit){exit(1);return;}}}else if(B=="run"){await mM(true);}else if(B=="configure"){String XB;try {XB=Platform.resolvedExecutable;}catch (vB){XB=Platform.executable.isNotEmpty?Platform.executable:"dart";}var A=await JV(XB,args:["bin/configure.dart"],inherit:true);exit(A.exitCode);}else{print("Unknown Command: ${B}");exit(1);}}mM([bool H=false])async{if(await qM()){print("Server is already started.");exit(1);}var B=YB(JJ,"server_watcher.dart");var A=new File(B);File C;if(!(await A.exists())){B=YB(JJ,"watcher.dart");A=new File(B);}await nM();{var J=await HV(A.path);var S=YB(A.parent.path,rV(A.path)+".snapshot");C=new File(S);if(!(await C.exists())){J=ChecksumState.MODIFIED;}if(J!=ChecksumState.SAME){try {await KV(C.path,A.path);}catch (W){}}A=C;}String G;try {G=Platform.resolvedExecutable;}catch (W){G=Platform.executable.isNotEmpty?Platform.executable:"dart";}var K=await DT();String L=await CV();Process D=await Process.start(G,["--old_gen_heap_size=16","--new_gen_semi_max_size=2",B,"--log-file=logs/dglux_server.log","--manager-port=${K}","--manager-token=${L}"],mode:H?ProcessStartMode.NORMAL:ProcessStartMode.DETACHED);if(!(await DE.exists())){await DE.create(recursive:true);}await DE.writeAsString("ws://${InternetAddress.LOOPBACK_IP_V4.address}:${K}" "/ws?${L}");if(!H){print("Server Started. (pid: ${D.pid})");}else{D.stdout.pipe(BT.stdout);D.stderr.pipe(BT.stderr);KJ=ProcessSignal.SIGINT.watch().listen((p)async{await gF("stop");KJ.cancel();});var f=await D.exitCode;KJ.cancel();await new Future.delayed(const Duration(milliseconds:50));exit(f);}}StreamSubscription KJ;nM()async{print("DSA Version: ${RV}");var G=await FT();if(G!="unknown"){print("DGLux5 Build: r${G}");}var H=await ET();if(H!="unknown"){print("DGLux Server Build: ${H}");}var J=new File("install.json");var C=true;print("Verifying Environment...");if(await J.exists()){print("Detected a Get DSA installation.");var L=await J.readAsString();var D=const JsonDecoder().convert(L);if(D["links"].any((B)=>B["language"]=="Java")){var S=await oD("java");if(S==null){print("Warning: Please install Java." " See https://www.java.com/ for more information.");}}if(D["links"].any((B)=>B["language"]=="JavaScript")){var W=await oD("node");if(W==null){print("Warning: Please install NodeJS." " See https://nodejs.org/ for more information.");}}if(D["links"].any((B)=>B["language"]=="Ruby")){var f=await oD("ruby");if(f==null){print("Warning: Please install Ruby." "See https://www.ruby-lang.org/en/documentation/installation/ " "for more information.");}}if(D["links"].any((B)=>B["language"]=="Python")){var p=await oD("python");if(p==null){print("Warning: Please install Python." " See https://www.python.org/downloads/" " for more information.");}}}print("Verifying Configuration...");var A=new ME();await A.Ta();if(A.zI&&A.port!=null&&A.port>0){if(!(await uN(A.port))){print("Error: The configured HTTP Port" " (${A.port}) is currently in use.");C=false;}}if(A.zI&&A.rI!=null&&A.rI>0&&A.gI!=null&&A.gI.isNotEmpty&&A.hI!=null&&A.hI.isNotEmpty){if(!(await uN(A.port))){print("Error: The configured HTTPS Port (${A.port}) is currently in use.");C=false;}}KD K=mN(A.qL);if(K==null){C=false;}else{try {await K.init(A);}catch (XB){print("Failed to initialize Authentication System: ${XB}");C=false;}}if(!C){print("Verification Failed. Please fix the above problems and then try again.");exit(1);}}File DE=new File("dglux_server.run");Future<bool> oM(String B)async{var A=await pM();A.add(B);var C=await A.where((D)=>!D.startsWith("STD")).first.timeout(const Duration(seconds:8),onTimeout:(){return "ERROR";});if(C=="OK"){return true;}else{return false;}try {await A.close();}catch (G){}}Future<WebSocket> pM()async{if(!(await DE.exists())){throw new Exception("No Server Run File Found");}var A=await DE.readAsString();return await WebSocket.connect(A.trim());}Future<int> DT()async{var A=await ServerSocket.bind(InternetAddress.LOOPBACK_IP_V4.address,0);var B=A.port;await A.close();return B;}Future<String> ET()async{var A=new File("BUILD_NUMBER");if(!(await A.exists())){return "unknown";}else{return (await A.readAsString()).trim();}}Future<String> FT()async{var A=new File("www/dglux5/REVISION");if(!(await A.exists())){return "unknown";}else{return (await A.readAsString()).trim();}}Future<bool> qM()async{try {var A=await pM().timeout(const Duration(seconds:6));try {await A.close();}catch (B){}return true;}catch (B){return false;}}KD mN(String A){KD B;if(A=="file"||A=="json"){B=new lN();}else if(A=="ldap"){B=new vU();}else if(A=="external"){B=new rU();}else if(A=="open"){B=new qU();}else if(A.startsWith("composite[")&&A.endsWith("]")){String C=A.substring(9,A.length-1);List<String> D=C.split(",").map((G)=>G.trim()).toList();return new kN(D.map(mN).toList());}else{IC.qG("Invalid Authentication Method: ${A}");}return B;}abstract class KD{Future init(ME A);}abstract class JH{}abstract class uU{}abstract class gJ{}class nN{final String message;nN(this.message);String toString()=>message;}class HC{final String username;final bool aM;final Map NM;HC(this.username,this.aM,[Map A]):NM=A is!Map?{}:A;static HC wU(Map A){var B=new HC(A["username"],A["superuser"] is bool?A["superuser"]:false,A["metadata"]);for(String C in A.keys.where((D)=>!(const["username","superuser","metadata"]).contains(D))){B.JM[C]=A[C];}return B;}Map ra([List<String> B]){var C={"username":username,"superuser":aM,"metadata":NM};if(B!=null){for(String A in B){if(JM.containsKey(A)){C[A]=JM[A];}}}return C;}HC VF(){return new HC(username,aM,new Map.from(NM));}Map<String,dynamic> JM={};}class kN extends KD implements JH{final List<KD> FS;kN(this.FS);Future init(ME A)async{for(var B in FS){await B.init(A);}}}class rU extends KD implements JH,gJ{WebSocket socket;String qE;String oB;bool pG;Future init(ME C)async{var A=C.get("externalAuth");B(String D){IC.gE(D);exit(1);}if(A==null){B("External Authentication not configured.");}qE=A["url"];if(qE==null){B("External Authentication URL not configured.");}oB=A["token"];if(oB==null){B("External Authentication token not configured.");}pG=A["verifyOnStart"];if(pG==null){pG=true;}await connect(true);}connect([bool A=false])async{if(xc){return;}try {socket=await NV.QV(qE);xc=true;yc=0;socket.done.then((K){xc=false;new Timer(const Duration(seconds:5),(){connect();});});socket.listen((String G){try {var B=const JsonDecoder().convert(G);if(B is!Map){return;}if(B["event"]=="changed"){for(var H in zc){H();}return;}Ad.add(B);}catch (D){}});socket.add(const JsonEncoder().convert({"token":oB}));Map C=await Bd.first.timeout(const Duration(seconds:5));if(C["error"]!=null){if(A){IC.oE("External Authentcation system says '${C["error"]}'");if(pG){exit(1);}}else{throw new nN(C["error"]);}}if(A){IC.gE("External Authentication System Connected.");}}catch (D,J){IC.oE("Failed to connect to the External Authentication system.",D,J);if(A&&pG){exit(1);}new Timer(const Duration(seconds:5),(){connect();});}}StreamController<Map> Ad=new StreamController.broadcast();Stream<Map> get Bd=>Ad.stream;bool xc=false;int yc=0;List<Function> zc=[] ;}CK sU=new CK();class lN extends KD implements gJ,JH,uU{static final String tU=new String.fromCharCodes(lD.QN(new String.fromCharCodes(const[90,71,100,115,100,88,103,120,77,106,77,48])));File file=new File("users.json");List<HC> yS=[] ;lN();Future init(ME C)async{await load();if(!Platform.isAndroid){var A=new DF(file.path);A.mI.listen((CC B)async{if(B.type==tC.eH){IC.gE("Reloading Users");await load();}});}}String Ba(){var A={"username":"dgSuper"};var B=[A];A["password"]=sU.Ka(tU);A["superuser"]=true;A["metadata"]={};return hJ.convert(B);}Future load()async{if(Cd){return;}Cd=true;try {if(!(await file.exists())){await file.create(recursive:true);await file.writeAsString(Ba()+"\n");}var B=await file.readAsString();var A=const JsonDecoder().convert(B);if(A is!List){A=[] ;}List C=A;yS=C.map(HC.wU).toList();Dd();}on FormatException catch (D){IC.qG("Failed to load Users File: ${D.toString().trim()}");}Cd=false;}bool Cd=false;VM()async{var A=const JsonEncoder.withIndent("  ");var B=A.convert(yS.map((HC C){return C.ra(const["password"]);}).toList())+"\n";await file.writeAsString(B);}List<Function> zc=[] ;void Dd(){for(var A in zc){A();}}}class pU<dB>{}class vU extends KD implements JH,gJ{bJ yR;List<String> WM;String HM;String hM;bool pL;Map<String,String> OM;dynamic bM;Future init(ME H)async{B(String S){IC.oE("Error while initializing LDAP: ${S}");exit(1);}if(H.get("ldap")==null){B("LDAP Authentication is not configured.");}var A=H.get("ldap");var J=A["url"];if(J==null){B("LDAP URL was not specified.");}Uri C;try {C=Uri.parse(J);}catch (D){B("Failed to parse LDAP URL: ${D}");}var G=new bJ(C.host,port:C.port!=0?C.port:null,ssl:C.scheme=="ldaps");var K=A["dn"];if(K==null){B("LDAP DN is not configured.");}G.ZG=K;var L=A["password"];if(L!=null){G.password=L;}if(A["searchBase"] is String){WM=[A["searchBase"]];}else{WM=A["searchBase"];}if(WM==null){B("LDAP Search Base is not configured.");}HM=A["groupAttribute"];if(HM==null){HM="gid";}hM=A["usernameAttribute"];if(hM==null){hM="uid";}pL=A["allowListUsers"];if(pL==null){pL=false;}bM=A["superuserGroup"];if(bM==null){bM="superuser";}OM=A["metadata"];if(OM==null){OM={};}yR=G;try {WF=await Fa();IC.gE("LDAP Authentication Configured.");}catch (D){B("Failed to connect to LDAP Server: ${D}");}new Timer.periodic(const Duration(seconds:10),(W){Ed.clear();});new Timer.periodic(const Duration(hours:1),(W){Dd();});Fd();Gd();}nD WF;Future<nD> Fa()async{if(WF!=null&&!WF.isClosed()){try {await WF.close();}catch (A){}}WF=await yR.Ea();return WF;}Map<String,HC> Ed=new Map<String,HC>();Map<String,pU<HC>> Hd={};Fd(){var A=new File("ldap_meta.json");if(A.existsSync()){Id=pN.convert(A.readAsStringSync());}}Gd(){var A=new File("ldap_meta.json");A.writeAsStringSync(hJ.convert(Id)+"\n");}Map<String,Map<String,dynamic>> Id={};void Dd(){for(var A in zc){A();}}List<Function> zc=[] ;}class qU extends KD{Future init(ME A)async{}final HC lb=new HC("dgUser",false,{"open":true});}class ME{bool RR;int port;int rI;String hI;String gI;String NR;bool UR;bool MR;int zS;String host;int rS;String sL;String uL;Map<String,String> CJ;Map<String,Map<String,dynamic>> zR;Map<String,Map<String,dynamic>> sS;String tL;bool UM;List<String> VR;String tS;bool VS;bool HR;List SR;bool wS;int RS;int SS;String ES;String pR;String qL;String pS;String BS;String XR;bool uS;bool vS;String YR;bool zI;bool cR;String eS;List<String> DS;Map<String,String> proxies;Map<String,List<String>> rR;List<String> fS;List<String> QR;List<String> wR;int xS;bool IR;bool bR;bool JR;bool xR;Map<String,String> AS;bool lS;String lR;bool aR;String KR;Map<String,List<String>> sR;bool tR;String iS;dynamic MS;dynamic get(A,[B]){if(A is!List){A=[A];}for(var C in A){if(map[C]!=null){return map[C];}}if(B is Function){return B();}else{return B;}}dynamic map;void load(Map B){this.map=B;RR=get("debug",false);port=get("port",Jd);rI=get(["httpsPort","httpsport"],Kd);gI=get("certName","");hI=get("certPassword","");NR=get("certKeyName","");UR=get("disableFileSecurity",false);MR=get("broadcast",false);sL=get("broadcastUrl");zS=get("workers",Platform.numberOfProcessors==1?1:2);rS=get("updateInterval",200);var A=<String,String>{"/.well-known":"${Directory.current.absolute.path}/.well-known"};CJ=get("static",A);if(!CJ.containsKey("/.well-known")){CJ.addAll(A);}zR=get("linkConfig",{});uL=get("brokerUrl");tL=get("brokerName","broker-");VR=get("disabledLinks",[] );UM=get("runBrokerInMain",Platform.numberOfProcessors==1?true:false);tS=get("uptimeCheckUrl");cR=get("enableUptimeChecker",true);sS=get("upstream",{});VS=get("quarantine",false);HR=get("allowAllLinks",true);SR=get("defaultPermission",null);wS=get("useRuntimeManager",false);uS=get("useDartRuntimeManager",false);vS=get("useJavaRuntimeManager",false);RS=get("passwordHasherIterations",1000);SS=get("passwordHasherKeyLength",32);ES=get("loginRedirectPath","/");qL=get("authType","file");pS=get("twoFactorAuth","none");YR=get("downstreamName","conns");zI=get("runPortChecks",true);iS=get("storageDriver",'simple');MS=get("observe",false);host=get("host","0.0.0.0");DS=get("loggers",[] );proxies=get("proxies",{});rR=get("hooks",{});XR=get("distributionUrl",yU);BS=get("linkRepositoryUrl",xU);fS=get("serverVmFlags",[] );QR=get("dartRuntimeManagerVmFlags",[] );wR=get("javaRuntimeManagerVmFlags",[] );xS=get("userTimeout",525600);IR=get("allowBrowserCaching",false);eS=get("serverLogLevel","INFO");bR=get("enableIPv6",false);pR=get("guestLoginRedirectPath",null);JR=get("allowPasswordChanges",true);xR=get("keepCustomAssets",false);AS=get("linkManagerEnvironment",{});lS=get("timeHttpRequests",false);lR=get("generatedCertificateSubject","/C=US/ST=California/L=Oakland/O=DGLogik Inc./OU=Customers/CN=*");aR=get("enableCertificateGeneration",true);KR=get("alternativeBrokerUrl",null);sR=get("httpPathClassification",{});tR=get("isAlwaysOffline",false);}Future<bool> Ta([String A="server"])async{if(await pF.lJ.GM(".docker").exists()){Jd=80;Kd=443;}var B=await oN(A);if(!(await B.exists())){load({"downstreamName":"downstream"});await bS(A);return true;}var C=await AV(B);load(C);var D=VM();if(const JsonEncoder().convert(C)!=const JsonEncoder().convert(D)){await bS(A);}return false;}int Kd=8443;int Jd=8080;Map VM(){var A={"debug":RR,"host":host,"port":port,"httpsPort":rI,"certName":gI,"certKeyName":NR,"certPassword":hI,"disableFileSecurity":UR,"isAlwaysOffline":tR,"broadcast":MR,"workers":zS,"updateInterval":rS,"static":CJ,"linkConfig":zR,"disabledLinks":VR,"uptimeCheckUrl":tS,"upstream":sS,"quarantine":VS,"allowAllLinks":HR,"defaultPermission":SR,"useRuntimeManager":wS,"useDartRuntimeManager":uS,"useJavaRuntimeManager":vS,"passwordHasherIterations":RS,"passwordHasherKeyLength":SS,"loginRedirectPath":ES,"guestLoginRedirectPath":pR,"authType":qL,"twoFactorAuth":pS,"runPortChecks":zI,"storageDriver":iS,"downstreamName":YR,"enableUptimeChecker":cR,"observe":MS,"loggers":DS,"proxies":proxies,"hooks":rR,"distributionUrl":XR,"linkRepositoryUrl":BS,"serverVmFlags":fS,"userTimeout":xS,"allowBrowserCaching":IR,"serverLogLevel":eS,"enableIPv6":bR,"dartRuntimeManagerVmFlags":QR,"javaRuntimeManagerVmFlags":wR,"allowPasswordChanges":JR,"keepCustomAssets":xR,"linkManagerEnvironment":AS,"timeHttpRequests":lS,"generatedCertificateSubject":lR,"enableCertificateGeneration":aR,"alternativeBrokerUrl":KR,"httpPathClassification":sR};if(sL!=null){A["broadcastUrl"]=sL;}if(tL!=null){A["brokerName"]=tL;}if(uL!=null){A["brokerUrl"]=uL;}if(UM!=null){A["runBrokerInMain"]=UM;}if(map["ldap"]!=null){A["ldap"]=map["ldap"];}if(map["duo"]!=null){A["duo"]=map["duo"];}if(map["externalAuth"]!=null){A["externalAuth"]=map["externalAuth"];}if(map["authServer"]!=null){A["authServer"]=map["authServer"];}return A;}bool Ld=false;Future bS([String A="server"])async{if(Ld){return;}Ld=true;var B=await oN(A);await BV(B,VM());Ld=false;}}const String xU="https://dsa.s3.amazonaws.com/links/links.json";const String yU="https://dsa.s3.amazonaws.com/dists/dists.json";MB IC;zU(){if(IC==null){TH=true;IC=new MB("DGServer");IC.ba.listen((A){List<String> B=A.message.split("\n");for(String C in B){print("[${A.level.name}] ${C}");}if(A.error!=null){print(A.error);}if(A.stackTrace!=null){print(A.stackTrace);}});}}Future<yE> oN(String A)async{var B=["${A}.json","${A}.toml","${A}.yaml"];for(var D in B){var C=pF.lJ.GM(D);if(await C.exists()){return C;}}return pF.lJ.GM(B.first);}Future<dynamic> AV(yE B)async{if(!(await B.exists())){return null;}var A=await B.readAsString();var C=MO(B.path);if(C==".toml"){var D=new uO();return xE(D.kB(A).value);}else if(C==".yaml"){return xE(dX(A));}else{if(A.trim().isEmpty||A==" "){A="{}";}return xE(pN.convert(A));}}Future BV(yE B,dynamic C)async{if(!(await B.exists())){await B.create();}var A="";var D=MO(B.path);if(D==".toml"){var G=new XW();A=G.encode(C);}else if(D==".yaml"){A=gX(C);}else{A=hJ.convert(C);}if(!A.endsWith("\n")){A=A+"\n";}await B.writeAsString(A);}JsonEncoder hJ=const JsonEncoder.withIndent("  ");JsonDecoder pN=const JsonDecoder();dynamic xE(A){if(A is Map){var B={};for(var C in A.keys){B[xE(C)]=xE(A[C]);}return B;}else if(A is List){return A.map((D)=>xE(D)).toList();}else{return A;}}Future<String> CV({int length: 50})async{var G=new Random();var B=new StringBuffer();for(int C=1;C<=length;C++ ){await new Future.value();var A=new Random(G.nextInt(0x70000000)+(new DateTime.now()).millisecondsSinceEpoch);if(A.nextBool()){String D=qN[A.nextInt(qN.length)];B.write(A.nextBool()?D.toLowerCase():D);}else{B.write(rN[A.nextInt(rN.length)]);}}return B.toString();}const List<String> qN=const["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];const List<int> rN=const[0,1,2,3,4,5,6,7,8,9];typedef dynamic DV<dB>(dB _0);typedef void EV(Process _0);typedef void iJ(String _0);class jJ extends ProcessResult{final ca;jJ(int A,int B,C,D,this.ca):super(A,B,C,D);}class FV{}Future<String> sN(File B,{bool useSmartHash: true})async{var C=await oD("md5sum");if(useSmartHash&&C!=null){try {var A=await Process.run(C,[B.absolute.path]);if(A.exitCode!=0){throw "Fail";}var G=A.stdout.split("\n").first;return G.split(" ").first;}catch (J){}}var H=await B.readAsBytes();var D=new BH();D.add(H);var A=D.close();return lD.ON(A);}Future<bool> GV(File A,String B)async{var C=await sN(A);return B==C;}Future tN(File A)async{var B=A.path+".md5";var C=new File(B);var D=await sN(A);await C.writeAsString(D);}enum ChecksumState {CREATED,SAME,MODIFIED}Future<ChecksumState> HV(String C)async{var A=new File(C);var B=new File(A.path+".md5");if(!(await B.exists())){await tN(A);return ChecksumState.CREATED;}var D=(await B.readAsString()).trim();var G=await GV(A,D);if(G){return ChecksumState.SAME;}else{await tN(A);return ChecksumState.MODIFIED;}}bool IV=false;Future<jJ> JV(String D,{List<String> args: const[] ,String workingDirectory,Map<String,String> environment,bool includeParentEnvironment: true,bool runInShell: true,stdin,EV handler,iJ stdoutHandler,iJ stderrHandler,iJ outputHandler,FV controller,File outputFile,DV<int> exitHandler,bool inherit: false,bool writeToBuffer: false,bool binary: false,bool capture: true,bool inheritStdin: false,Duration timeout,bool sudo: false})async{if(sudo&&(Platform.isLinux||Platform.isMacOS)&&(await oD("sudo"))!=null){var XB=D;D=await oD("sudo");args=new List<String>.from(args);args.insert(0,XB);}IOSink B;if(outputFile!=null){if(!(await outputFile.exists())){await outputFile.create(recursive:true);}B=await outputFile.openWrite(mode:FileMode.APPEND);}if(workingDirectory==null){workingDirectory=Directory.current.path;}try {if(IV){IC.gE("Execute '${D} ${args.join(' ')}' in ${workingDirectory}");}Process A=await Process.start(D,args,workingDirectory:workingDirectory,environment:environment,includeParentEnvironment:includeParentEnvironment,runInShell:runInShell);if(controller!=null){controller.Md=A;controller.Nd.complete();}if(B!=null){B.writeln("[${KH}] == Executing ${D} with arguments ${args} (pid: ${A.pid}) ==");}var H=new StringBuffer();var L=new StringBuffer();var S=new StringBuffer();var J=<int>[] ;var W=<int>[] ;var f=<int>[] ;if(capture){if(!binary){A.stdout.transform(const Utf8Decoder(allowMalformed:true)).transform(const LineSplitter()).listen((C)async{if(writeToBuffer){L.writeln(C);H.writeln(C);}if(stdoutHandler!=null){stdoutHandler(C);}if(outputHandler!=null){outputHandler(C);}if(inherit){BT.stdout.writeln(C);}if(B!=null){await B.writeln("[${KH}] ${C}");}});A.stderr.transform(const Utf8Decoder(allowMalformed:true)).transform(const LineSplitter()).listen((C)async{if(writeToBuffer){S.writeln(C);H.writeln(C);}if(stderrHandler!=null){stderrHandler(C);}if(outputHandler!=null){outputHandler(C);}if(inherit){BT.stderr.writeln(C);}if(B!=null){await B.writeln("[${KH}] ${C}");}});}else{A.stdout.listen((G){if(writeToBuffer){J.addAll(G);f.addAll(G);}});A.stderr.listen((G){if(writeToBuffer){J.addAll(G);W.addAll(G);}});}}if(handler!=null){handler(A);}if(stdin!=null){if(stdin is File){stdin=await stdin.openRead();}if(stdin is Stream){stdin.listen(A.stdin.add,onDone:A.stdin.close);}else if(stdin is List){A.stdin.add(stdin);}else{A.stdin.write(stdin);await A.stdin.close();}}else if(inherit&&inheritStdin){BT.stdin.listen(A.stdin.add,onDone:A.stdin.close);}var p=false;if(timeout!=null){new Future.delayed(timeout,(){if(!p){A.kill(ProcessSignal.SIGKILL);}});}var K=await A.exitCode;p=true;var vB=A.pid;await new Future.delayed(const Duration(milliseconds:5));try {if(B!=null){B.writeln("[${KH}] == Exited with status ${K} ==");await B.flush();await B.close();}}catch (GC){}if(exitHandler!=null){exitHandler(K);}return new jJ(vB,K,binary?f:L.toString(),binary?W:S.toString(),binary?J:H.toString());}finally {try {if(B!=null){await B.flush();await B.close();}}catch (GC){}}}Map<String,String> oF={};Future<String> oD(String B)async{if(oF.containsKey(B)){var A=new File(oF[B]);if(await A.exists()){return A.path;}}if(const["dart","pub"].contains(B)){try {var J=new File(Platform.resolvedExecutable);var K=J.parent;var A=new File(YB(K.path,B));if(await A.exists()){return oF[B]=A.absolute.path;}}catch (p){}}if(const["openssl"].contains(B)&&Platform.isWindows){var L=<String>[r"C:\OpenSSL-Win32\bin\openssl.exe",r"C:\OpenSSL-Win64\bin\openssl.exe",YB(Directory.current.path,"bin","tools","openssl","openssl.exe")];for(var S in L){var A=new File(S);if(await A.exists()){return oF[B]=A.absolute.path;}}}var W=Platform.environment["PATH"].split(Platform.isWindows?";":":");var G=[B];if(Platform.isWindows){G.addAll(["${B}.exe","${B}.bat"]);}for(var C in W){if(C.startsWith('"')&&C.endsWith('"')){C=C.substring(1,C.length-1);}if(Platform.environment.containsKey("HOME")){var D=Platform.environment["HOME"];if(!D.endsWith("/")){D+= "/";}C=C.replaceAll("~/",D);}var H=new Directory(uV(C)).absolute;if(!(await H.exists())){continue;}for(var f in G){var A=new File("${H.path}/${f}").absolute;if(await A.exists()){oF[B]=A.path;return A.path;}}}return null;}Future<bool> uN(int A,{String host: "0.0.0.0"})async{try {if((Platform.isLinux||Platform.isMacOS)&&await oD("lsof")!=null){var B=await Process.run("lsof",["-n","-i4TCP@${host}:${A}"]);if(B.exitCode==0&&B.stdout.contains("LISTEN")){return false;}else{return true;}}ServerSocket C=await ServerSocket.bind(host,A);await C.close();return true;}catch (D){return false;}}Future KV(String B,String A)async{var C=await Process.run(vN(),["--snapshot=${B}",A]);if(C.exitCode!=0){throw new Exception("Failed to generate snapshot for ${A}.");}}String vN(){String A;try {A=Platform.resolvedExecutable;}catch (B){try {A=Platform.executable.isNotEmpty?Platform.executable:"dart";}catch (B){A="dart";}}return A;}String get KH{return new DateTime.now().toString();}abstract class kJ{}abstract class yE implements kJ{}abstract class LH implements kJ{}abstract class pF{static pF lJ=new LV();LH get EB;yE GM(String A){return EB.gZ(A);}}class wN implements yE{final File file;wN(this.file);Future create()async{await file.create(recursive:true);}Future delete()async{await file.delete(recursive:true);}Future<bool> exists(){return file.exists();}kJ get parent{return new MH(file.parent);}String get path=>file.path;Future<List<int>> readAsBytes(){return file.readAsBytes();}Future<String> readAsString(){return file.readAsString();}Future writeAsString(String A){return file.writeAsString(A);}}class MH implements LH{final Directory fE;MH(this.fE);yE gZ(String A){var B=YB(fE.path,A);return new wN(new File(B));}Future create(){return fE.create(recursive:true);}Future delete(){return fE.delete(recursive:true);}Future<bool> exists(){return fE.exists();}LH get parent=>new MH(fE.parent);String get path=>fE.path;}class LV extends pF{LH get EB=>new MH(Directory.current);}const bool MV=const bool.fromEnvironment("dsa.io.tcpNoDelay",defaultValue:true);class NV{static const String OV="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";static const bool PV=const bool.fromEnvironment("calzone.build",defaultValue:false)||const bool.fromEnvironment("websocket.standard",defaultValue:true);static Future<WebSocket> QV(String S,{Iterable<String> protocols,Map<String,dynamic> headers,HttpClient httpClient,bool useStandardWebSocket})async{Uri A=Uri.parse(S);if(useStandardWebSocket==null){useStandardWebSocket=PV;}if(useStandardWebSocket==true&&A.scheme!="wss"){return await WebSocket.connect(S,protocols:protocols,headers:headers);}if(A.scheme!="ws"&&A.scheme!="wss"){throw new WebSocketException("Unsupported URL scheme '${A.scheme}'");}Random GC=new Random();Uint8List W=new Uint8List(16);for(int C=0;C<16;C++ ){W[C]=GC.nextInt(256);}String f=lD.FH(W);int J=A.port;if(J==0){J=A.scheme=="wss"?443:80;}A=new Uri(scheme:A.scheme=="wss"?"https":"http",userInfo:A.userInfo,host:A.host,port:J,path:A.path,query:A.query);HttpClient ID=httpClient==null?(new HttpClient()..badCertificateCallback=(AT,nb,ob)=>true):httpClient;return ID.openUrl("GET",A).then((HttpClientRequest D)async{if(A.userInfo!=null&&!A.userInfo.isEmpty){String rG=lD.FH(UTF8.encode(A.userInfo));D.headers.set(HttpHeaders.AUTHORIZATION,"Basic ${rG}");}if(headers!=null){headers.forEach((sG,K)=>D.headers.add(sG,K));}D.headers..set(HttpHeaders.CONNECTION,"Upgrade")..set(HttpHeaders.UPGRADE,"websocket")..set("Sec-WebSocket-Key",f)..set("Cache-Control","no-cache")..set("Sec-WebSocket-Version","13");if(protocols!=null){D.headers.add("Sec-WebSocket-Protocol",protocols.toList());}return D.close();}).then((B){return B;}).then((HttpClientResponse B){void G(String tG){B.detachSocket().then((Socket H){H.destroy();});throw new WebSocketException(tG);}if(B.statusCode!=HttpStatus.SWITCHING_PROTOCOLS||B.headers[HttpHeaders.CONNECTION]==null||!B.headers[HttpHeaders.CONNECTION].any((K)=>K.toLowerCase()=="upgrade")||B.headers.value(HttpHeaders.UPGRADE).toLowerCase()!="websocket"){G("Connection to '${A}' was not upgraded to websocket");}String p=B.headers.value("Sec-WebSocket-Accept");if(p==null){G("Response did not contain a 'Sec-WebSocket-Accept' header");}vE XB=new vE();XB.add("${f}${OV}".codeUnits);List<int> L=XB.close();List<int> vB=lD.QN(p);if(L.length!=vB.length){G("Response header 'Sec-WebSocket-Accept' is the wrong length");}for(int C=0;C<L.length;C++ ){if(L[C]!=vB[C]){G("Bad response 'Sec-WebSocket-Accept' header");}}var uG=B.headers.value('Sec-WebSocket-Protocol');return B.detachSocket().then((H){H.setOption(SocketOption.TCP_NODELAY,MV);return new WebSocket.fromUpgradedSocket(H,protocol:uG,serverSide:false);});});}}const String RV="1.1.2";final mO=new RegExp(r"\r\n?|\n");class XK extends CF{int get jB=>Od;int Od=0;int get DB=>Pd;int Pd=0;tD get state=>new nO(this,position,jB,DB);bool get Qd=>e(-1)==FN&&e()==PJ;set position(int A){var C=position;super.position=A;if(A>C){var B=Rd(string.substring(C,A));Od+= B.length;if(B.isEmpty){Pd+= A-C;}else{Pd=A-B.last.end;}}else{var B=Rd(string.substring(A,C));if(Qd)B.removeLast();Od-= B.length;if(B.isEmpty){Pd-= C-A;}else{Pd=A-string.lastIndexOf(mO,A)-1;}}}XK(String A,{sourceUrl,int position}):super(A,sourceUrl:sourceUrl,position:position);int d(){var A=super.d();Sd(A);return A;}void Sd(int A){if(A==PJ||(A==FN&&e()!=PJ)){Od+= 1;Pd=0;}else{Pd+= 1;}}bool QB(Pattern B){if(!super.QB(B))return false;var A=Rd(aF[0]);Od+= A.length;if(A.isEmpty){Pd+= aF[0].length;}else{Pd=aF[0].length-A.last.end;}return true;}List<Match> Rd(String B){var A=mO.allMatches(B).toList();if(Qd)A.removeLast();return A;}}class nO implements tD{final XK Td;final int position;final int jB;final int DB;nO(this.Td,this.position,this.jB,this.DB);}const int HE=0x7fffffff;abstract class IE<b>{}class SJ<b> implements IE<b>{const SJ();bool ED(b A,b B)=>A==B;int hash(b A)=>A.hashCode;bool KM(Object A)=>true;}class GN<b> implements IE<Iterable<b>>{final IE<b> Ud;const GN([IE<b> A=const SJ()]):Ud=A;bool ED(Iterable<b> A,Iterable<b> B){if(identical(A,B))return true;if(A==null||B==null)return false;var C=A.iterator;var D=B.iterator;while(true){bool G=C.moveNext();if(G!=D.moveNext())return false;if(!G)return true;if(!Ud.ED(C.current,D.current))return false;}}int hash(Iterable<b> B){int A=0;for(b C in B){int D=Ud.hash(C);A=(A+D)&HE;A=(A+(A<<10))&HE;A^= (A>>6);}A=(A+(A<<3))&HE;A^= (A>>11);A=(A+(A<<15))&HE;return A;}bool KM(Object A)=>A is Iterable<b>;}abstract class HN<b,dB extends Iterable<b>> implements IE<dB>{final IE<b> Ud;const HN(this.Ud);bool ED(dB D,dB G){if(identical(D,G))return true;if(D==null||G==null)return false;HashMap<b,int> C=new HashMap(equals:Ud.ED,hashCode:Ud.hash,isValidKey:Ud.KM);int H=0;for(var B in D){int A=C[B];if(A==null)A=0;C[B]=A+1;H++ ;}for(var B in G){int A=C[B];if(A==null||A==0)return false;C[B]=A-1;H-- ;}return H==0;}int hash(dB B){int A=0;for(b C in B){int D=Ud.hash(C);A=(A+D)&HE;}A=(A+(A<<3))&HE;A^= (A>>11);A=(A+(A<<15))&HE;return A;}}class IN<b> extends HN<b,Iterable<b>>{const IN([IE<b> A=const SJ()]):super(A);bool KM(Object A)=>A is Iterable<b>;}class bH extends WK{String get source=>super.source;Uri get m=>N.m;bH(String A,JB B,String C):super(A,B,C);}const int UK=10;const int PW=13;class QE{final Uri qE;final Vd=<int>[0];final Uint32List Wd;int get length=>Wd.length;int get bF=>Vd.length;int Xd;QE(String A,{url}):this.Tb(A.runes,url:url);QE.Tb(Iterable<int> D,{url}):qE=url is String?Uri.parse(url):url,Wd=new Uint32List.fromList(D.toList()){for(var A=0;A<Wd.length;A++ ){var B=Wd[A];if(B==PW){var C=A+1;if(C>=Wd.length||Wd[C]!=UK)B=UK;}if(B==UK)Vd.add(A+1);}}FB N(int B,[int A]){if(A==null)A=length-1;return new PD(this,B,A);}sD location(int A)=>new sD.Ub(this,A);int qI(int A){if(A<0){throw new RangeError("Offset may not be negative, was ${A}.");}else if(A>length){throw new RangeError("Offset ${A} must not be greater than the number " "of characters in the file, ${length}.");}if(A<Vd.first)return -1;if(A>=Vd.last)return Vd.length-1;if(Yd(A))return Xd;Xd=Zd(A)-1;return Xd;}bool Yd(int A){if(Xd==null)return false;if(A<Vd[Xd])return false;if(Xd>=Vd.length-1||A<Vd[Xd+1]){return true;}if(Xd>=Vd.length-2||A<Vd[Xd+2]){Xd++ ;return true;}return false;}int Zd(int D){int A=0;int B=Vd.length-1;while(A<B){var C=A+((B-A)~/2);if(Vd[C]>D){B=C;}else{A=C+1;}}return B;}int FM(int A,{int line}){if(A<0){throw new RangeError("Offset may not be negative, was ${A}.");}else if(A>length){throw new RangeError("Offset ${A} must be not be greater than the " "number of characters in the file, ${length}.");}if(line==null){line=qI(A);}else if(line<0){throw new RangeError("Line may not be negative, was ${line}.");}else if(line>=bF){throw new RangeError("Line ${line} must be less than the number of " "lines in the file, ${bF}.");}var B=Vd[line];if(B>A){throw new RangeError("Line ${line} comes after offset ${A}.");}return A-B;}int mR(int A,[int B]){if(B==null)B=0;if(A<0){throw new RangeError("Line may not be negative, was ${A}.");}else if(A>=bF){throw new RangeError("Line ${A} must be less than the number of " "lines in the file, ${bF}.");}else if(B<0){throw new RangeError("Column may not be negative, was ${B}.");}var C=Vd[A]+B;if(C>length||(A+1<bF&&C>=Vd[A+1])){throw new RangeError("Line ${A} doesn't have ${B} columns.");}return C;}String oR(int A,[int B])=>new String.fromCharCodes(Wd.sublist(A,B));}class sD extends QW implements JC{final QE file;final int offset;Uri get m=>file.qE;int get jB=>file.qI(offset);int get DB=>file.FM(offset);sD.Ub(this.file,this.offset){if(offset<0){throw new RangeError("Offset may not be negative, was ${offset}.");}else if(offset>file.length){throw new RangeError("Offset ${offset} must not be greater than the number " "of characters in the file, ${file.length}.");}}FB mB()=>new PD(file,offset,offset);}abstract class FB implements aH{}class PD extends lO implements FB{final QE file;final int ad;final int bd;Uri get m=>file.qE;int get length=>bd-ad;sD get start=>new sD.Ub(file,ad);sD get end=>new sD.Ub(file,bd);String get pE=>file.oR(ad,bd);String get context=>file.oR(file.mR(start.jB),end.jB==file.bF-1?null:file.mR(end.jB+1));PD(this.file,this.ad,this.bd){if(bd<ad){throw new ArgumentError('End ${bd} must come after start ${ad}.');}else if(bd>file.length){throw new RangeError("End ${bd} must not be greater than the number " "of characters in the file, ${file.length}.");}else if(ad<0){throw new RangeError("Start may not be negative, was ${ad}.");}}int compareTo(JB A){if(A is!PD)return super.compareTo(A);PD B=A;var C=ad.compareTo(B.ad);return C==0?bd.compareTo(B.bd):C;}bool operator==(A){if(A is!FB)return super==A;if(A is!PD){return super==A&&m==A.m;}return ad==A.ad&&bd==A.bd&&m==A.m;}int get hashCode=>super.hashCode;FB expand(FB A){if(m!=A.m){throw new ArgumentError("Source URLs \"${m}\" and " " \"${A.m}\" don't match.");}if(A is PD){var B=rE.min(this.ad,A.ad);var C=rE.max(this.bd,A.bd);return new PD(file,B,C);}else{var B=rE.min(this.ad,A.start.offset);var C=rE.max(this.bd,A.end.offset);return new PD(file,B,C);}}}class xN extends Object with ListMixin<String>{static final bool AO=Platform.isWindows;final Directory kI;bool cd;List<String> dd;Function ed;String fd;xN(this.kI,String A,{bool caseSensitive,void notify(String path)}){if(kI==null){throw new ArgumentError("directory: ${kI}");}if(A==null){throw new ArgumentError("pattern: ${A}");}if(caseSensitive==null){if(AO){caseSensitive=false;}else{caseSensitive=true;}}cd=caseSensitive;ed=notify;fd=mJ.nJ(A);dd=gd();}int get length{return dd.length;}void set length(int A){throw new UnsupportedError("length=");}String operator[](int A){return dd[A];}void operator[]=(int A,String B){throw new UnsupportedError("[]=");}bool hd(String A){if(!new Directory(A).existsSync()){if(!new File(A).existsSync()){if(!new Link(A).existsSync()){return false;}}}return true;}List<String> gd(){var A=new CO(fd,caseSensitive:cd,exists:hd,isDirectory:jd,isWindows:AO,list:kd);return A.list(kI.path,notify:ed);}bool jd(String A){return new Directory(A).existsSync();}List<String> kd(String C,bool D){List<String> A;try {A=new Directory(C).listSync(followLinks:D).map((B)=>B.path).toList();}catch (B){A=new List<String>();}return A;}}class mJ{static final bool yN=Platform.isWindows;static String nJ(String A){if(A==null||A.isEmpty){return A;}A=TV(A);if(A[0]!="~"){return A;}String B;if(yN){var C=Platform.environment["HOMEDRIVE"];var A=Platform.environment["HOMEPATH"];if(C!=null&&!C.isEmpty&&A!=null&&!A.isEmpty){B=C+A;}else{B=Platform.environment["USERPROFILE"];}B=B.replaceAll("\\","/");}else{B=Platform.environment["HOME"];}if(B==null||B.isEmpty){return A;}if(B.endsWith("/")||B.endsWith("\\")){B=B.substring(0,B.length-1);}if(A=="~"||A=="~/"){return B;}if(A.startsWith("~/")){return B+"/"+A.substring(2);}return A;}static String TV(String G){var D=new StringBuffer();var J=G.length;for(var A=0;A<J;A++ ){var B=G[A];switch (B){case "\$":if(A+1<J){var H=A+1;var C=G.codeUnitAt(H);if((C>=65&&C<=90)||C==95){while(true){if(H==J){break;}var C=G.codeUnitAt(H);if((C>=65&&C<=90)||(C>=48&&C<=57)||C==95){H++ ;continue;}break;}}if(H>A+1){var L=G.substring(A+1,H);var K=Platform.environment[L];if(K==null){K="";}else if(yN){K=K.replaceAll("\\","/");}D.write(K);A=H-1;}else{D.write(B);}}else{D.write(B);}break;case "[":D.write(B);if(A+1<J){B=G[ ++A];D.write(B);while(true){if(A==J){break;}B=G[ ++A];D.write(B);if(B=="]"){break;}}}break;default:D.write(B);break;}}return D.toString();}}class NH{static final bool zN=Platform.isWindows;static String SV(String A){if(A==null){return null;}if(A.isEmpty){return ".";}var D=VH(A);if(D.length==1){if(NO(A)){var B=sV(A);if(zN){B=B.replaceAll("\\","/");}return B;}else{return ".";}}var C=UH(A);if(zN){C=C.replaceAll("\\","/");}return C;}static List<String> BO(String A,{bool caseSensitive,void notify(String path)}){if(A==null){return null;}A=mJ.nJ(A);Directory B;if(NO(A)){var K=new EO();var D=K.kB(A);var G=[] ;var H=D.FC;var L=H.length;for(var C=1;C<L;C++ ){var J=D.FC[C];if(J.strict){G.add(J);}else{break;}}var S=H.first.source+G.join("/");B=new Directory(S);}else{B=Directory.current;}return new xN(B,A,caseSensitive:caseSensitive,notify:notify);}static bool UV(String A,String B){if(A==null){return false;}A=mJ.nJ(A);switch (B){case "directory":return new Directory(A).existsSync();case "exists":return FileStat.statSync(A).type!=FileSystemEntityType.NOT_FOUND;case "file":return new File(A).existsSync();case "link":return new Link(A).existsSync();default:return null;}}}abstract class DF implements jK{factory DF(String A,{Duration pollingDelay}){if(FileSystemEntity.isWatchSupported&&!Platform.isWindows){return new vO(A);}return new xO(A,pollingDelay:pollingDelay);}}class yJ implements Pattern{final bool caseSensitive;final String pattern;bool ld;Pattern md;bool nd;List<LD> od;yJ(this.pattern,{this.caseSensitive: true}){if(pattern==null){throw new ArgumentError("pattern: ${pattern}");}if(caseSensitive==null){throw new ArgumentError("caseSensitive: ${caseSensitive}");}pd(caseSensitive);}bool get crossesDirectory=>ld;bool get isAbsolute=>nd;List<LD> get AJ=>od;Iterable<Match> allMatches(String A,[int B=0]){return md.allMatches(A,B);}bool jE(String A){return !allMatches(A).isEmpty;}Match matchAsPrefix(String A,[int B=0]){return md.matchAsPrefix(A,B);}String toString(){return pattern;}void pd(bool B){var C=new bV();var A=C.iZ(pattern,caseSensitive:B);ld=A.crossesDirectory;md=A.hR;nd=A.isAbsolute;od=A.AJ;}}class LD implements Pattern{Pattern md;final bool crossesDirectory;final bool onlyDirectory;final String pattern;final bool strict;LD(this.pattern,Pattern A,{this.crossesDirectory,this.onlyDirectory,this.strict}){if(pattern==null){throw new ArgumentError("pattern: ${pattern}");}if(A==null){throw new ArgumentError("expression: ${A}");}if(crossesDirectory==null){throw new ArgumentError("crossing: ${crossesDirectory}");}if(strict==null){throw new ArgumentError("strict: ${strict}");}if(onlyDirectory==null){throw new ArgumentError("trailingSlash: ${onlyDirectory}");}md=A;}Iterable<Match> allMatches(String A,[int B=0]){return md.allMatches(A,B);}bool jE(String A){return !allMatches(A).isEmpty;}Match matchAsPrefix(String A,[int B=0]){return md.matchAsPrefix(A,B);}String toString(){return pattern;}}class bV{static const String cV="Cannot escape slash '/' character";static const String dV="Range out of order in character class";static const String zJ="Explicit slash '/' not allowed in character class";static const String GO="Unterminated backslash '\\' escape sequence";static const String AK="Unexpected end of character class";bool qd;StringBuffer rd;String sd;StringBuffer td;HO iZ(String A,{bool caseSensitive: true}){if(A==null){throw new ArgumentError("input: ${A}");}if(caseSensitive==null){throw new ArgumentError("caseSensitive: ${caseSensitive}");}qd=caseSensitive;sd=A;return pd();}pd(){ud();var C=new EO();var B=C.kB(sd);var D=vd(B.FC);var A=new HO();A.crossesDirectory=B.crossesDirectory;A.hR=new RegExp(rd.toString(),caseSensitive:qd);A.isAbsolute=B.isAbsolute;A.AJ=D;return A;}void wd(oJ B,bool A){if(A){xd("(?![.])");}xd("[^/]*");}void yd(pJ B,bool A){if(A){xd("(?![.])");}xd(".*");}void zd(OH D,bool B){xd("(?:");var G=D.FC;var H=G.length;for(var C=0;C<H;C++ ){var A=G[C];switch (A.type){case a.qJ:wd(A,B);break;case a.rJ:yd(A,B);break;case a.sJ:zd(A,B);break;case a.tJ:Ae(A);break;case a.uJ:Be(A);break;case a.vJ:Ce(A);break;default:De(D,A);}B=false;if(C<H-1){xd("|");}}xd(")");}void Ae(PH D){var B="";var G=D.source;var H=G.length;var A=0;var J=(){switch (B){case "/":var C=zJ;Ee(C,D.position+A);break;case "\\":if(A>=H){var C=GO;Ee(C,D.position+A);}B=G[A++ ];switch (B){case "/":var C=zJ;Ee(C,D.position+A);break;default:xd("\\");xd(B);break;}break;case "^":xd(B);break;default:xd(B);break;}var W=B.codeUnitAt(0);if(A<H){B=G[A++ ];}else{B="";}return W;};if(A<H){B=G[A++ ];}if(B!="["){Fe(D.type,"starts","[",0);}xd("[");B=G[A++ ];if(B=="!"){xd("^");if(A<H){B=G[A++ ];}else{var C=AK;Ee(C,D.position+A);}}if(B=="]"){xd("\\]-\\]'");if(A<H){B=G[A++ ];}else{var C=AK;Ee(C,D.position+A);}}var K=false;while(true){if(B==""){Fe(D.type,"ends","]",0);}switch (B){case "/":var C=zJ;Ee(C,D.position+1+A);break;case "]":if(A!=H){Fe(D.type,"ends","]",0);}K=true;break;default:if(B=="-"){if(A<H){if(G[A]=="]"){B="]";A++ ;xd("-");break;}}}int L=J();var S=L;switch (B){case "-":if(A>=H){var C=AK;Ee(C,D.position+A);}B=G[A++ ];if(B=="]"){A-= 2;B=G[A];}else{xd("-");S=J();if(L>S){var C=dV;Ee(C,A);}}break;}}if(K){break;}}xd("]");}void Be(QC C){var D=C.source;var H=D.length;var B=0;while(true){if(B==H){break;}var A=D[B++ ];switch (A){case "\\":if(B==H){var G=GO;Ee(G,C.position+B);}A=D[B++ ];switch (A){case "/":var G=cV;Ee(G,C.position+B);break;case "*":case "{":case "[":case "?":case "}":xd("\\");xd(A);break;case "\\":xd("\\");xd(A);break;default:xd(A);}break;case "\$":case "(":case ")":case "*":case "+":case ".":case "?":case "[":case "]":case "^":case "{":case "|":case "}":xd("\\");xd(A);break;default:xd(A);break;}}}void Ce(RH A){xd(".");}LD Ge(RC B){He();var C=true;for(var A in B.FC){switch (A.type){case a.qJ:wd(A,C);break;case a.rJ:yd(A,C);break;case a.sJ:zd(A,C);break;case a.tJ:Ae(A);break;case a.uJ:Be(A);break;case a.vJ:Ce(A);break;default:De(B,A);}C=false;}td.write("\$");var D=td.toString();var G=new RegExp(D,caseSensitive:qd);var H=B.crossesDirectory;var J=B.onlyDirectory;var K=B.source;var L=B.strict;var S=new LD(K,G,crossesDirectory:H,onlyDirectory:J,strict:L);return S;}List<LD> vd(List<RC> C){rd.write("^");var D=new List<LD>();var G=C.length;for(var A=0;A<G;A++ ){var B=C[A];switch (B.type){case a.DO:var H=Ge(B);D.add(H);break;default:throw new StateError("Illegal node: '${B}'.");break;}if(A<G-1){if(!B.vR){rd.write("/");}}}rd.write("\$");return D;}void Ee(String A,int B){throw new FormatException("(column: ${B+1}), ${A} in '${sd}'.");}void De(LB A,LB B){var C=A.position;var D="<null>";if(B!=null){D=B.type.toString();C=B.position;}var G=A.type;var H="Illegal element '${D}' in ${G} node '${A}'";Ee(H,C);}void Fe(a A,String B,String C,int D){var G="'${A}' should ${B} with '${C}'";Ee(G,D);}void ud(){rd=new StringBuffer();}void He(){td=new StringBuffer();td.write("^");}void xd(String A){rd.write(A);td.write(A);}}class HO{bool isAbsolute;bool crossesDirectory;Pattern hR;List<LD> AJ;}class CO{final String pattern;bool Ie;Function Je;List<String> Ke;bool Le;yJ Me;Function Ne;bool Oe;Function Pe;Function Qe;int Re;bool Se;List<LD> Te;bool Ue;CO(this.pattern,{bool caseSensitive,bool exists(String path),bool followLinks: true,bool isDirectory(String path),bool isWindows,List<String> list(String path,bool followLinks)}){if(pattern==null){throw new ArgumentError("pattern: ${pattern}");}if(exists==null){throw new ArgumentError("exists: ${exists}");}if(followLinks==null){throw new ArgumentError("followLinks: ${followLinks}");}if(isDirectory==null){throw new ArgumentError("isDirectory: ${isDirectory}");}if(isWindows==null){throw new ArgumentError("isWindows: ${isWindows}");}if(list==null){throw new ArgumentError("list: ${list}");}if(caseSensitive==null){if(isWindows){caseSensitive=false;}else{caseSensitive=true;}}Ie=caseSensitive;Je=exists;Le=followLinks;Ne=isDirectory;Oe=isWindows;Pe=list;Me=new yJ(pattern,caseSensitive:caseSensitive);Te=Me.AJ;if(!Te.isEmpty){Se=Te.last.onlyDirectory;}else{Se=false;}}List<String> list(String A,{void notify(String path)}){Ke=<String>[] ;if(!Ne(A)){return Ke;}Qe=notify;if(Ie){if(Oe){Ue=false;}else{Ue=true;}}else{if(Oe){Ue=true;}else{Ue=false;}}var B=Me.isAbsolute;if(B){Re=0;}else{Re=A.length;}if(B){if(Me.crossesDirectory){Ve(A);}else{We(A);}}else{if(Te[0].crossesDirectory){Xe(A);}else{Ye(A,0);}}return Ke;}void Ze(String A){Ke.add(A);if(Qe!=null){Qe(A);}}void Ve(String A){if(Oe){A=A.replaceAll("\\","/");}var D=VH(A);var C=D.length;if(C>Te.length){C=Te.length;}for(var B=0;B<C;B++ ){var G=Te[B];if(G.crossesDirectory){break;}if(!Te[B].jE(D[B])){return;}}if(Je(A)&&Ne(A)){Xe(A);}}void We(String A){if(Oe){A=A.replaceAll("\\","/");}var H=VH(A);var D=H.length;if(D>Te.length){return;}var B=0;for(;B<D;B++ ){var J=H[B];var C=Te[B];if(C.onlyDirectory){J+= "/";}if(!C.jE(J)){return;}}if(B==Te.length){var C=Te[B-1];var G=false;if(C.onlyDirectory){G=Ne(A);}else{G=Je(A);}if(G){Ze(A);}return;}if(Ne(A)){ae(A,D);}}void ae(String A,int D){var C=Te[D];if(C.strict&&Ue){A=YB(A,C.pattern);var G=Ne(A);var L=false;if(!G){L=Je(A);}if(!(G||L)){return;}if(D==Te.length-1){if(Oe){A=A.replaceAll("\\","/");}if(C.onlyDirectory){if(G){Ze(A);}}else{Ze(A);}return;}if(G){ae(A,D+1);}return;}List<String> W=Pe(A,Le);for(var J in W){var B=J;if(Oe){B=B.replaceAll("\\","/");}var S=B.lastIndexOf("/");String H;if(S!=-1){H=B.substring(S+1);}else{H=B;}bool K=Ne(J);if(C.onlyDirectory){if(K){H+= "/";}}if(!C.jE(H)){continue;}if(D==Te.length-1){if(C.onlyDirectory){if(K){Ze(B);}}else{Ze(B);}continue;}if(K){ae(J,D+1);}}}void Xe(String G){List<String> H=Pe(G,Le);for(var C in H){var A=C;if(Oe){A=A.replaceAll("\\","/");}var B=A;if(Re>0){B=A.substring(Re+1);}bool D=Ne(C);if(Se){if(D){B+= "/";if(Me.jE(B)){Ze(A);}}}else{if(Me.jE(B)){Ze(A);}}if(D){Xe(C);}}}void Ye(String A,int G){var D=Te[G];if(D.strict&&Ue){A=YB(A,D.pattern);bool H=Ne(A);var W=false;if(!H){W=Je(A);}if(!(H||W)){return;}if(G==Te.length-1){if(Oe){A=A.replaceAll("\\","/");}if(D.onlyDirectory){if(H){Ze(A);}}else{Ze(A);}return;}if(H){var B=G+1;var L=Te[B];if(!L.crossesDirectory){Ye(A,B);}else{Xe(A);}}return;}List<String> f=Pe(A,Le);for(var J in f){var C=J;if(Oe){C=C.replaceAll("\\","/");}var B=C.lastIndexOf("/");String K;if(B!=-1){K=C.substring(B+1);}else{K=C;}bool S=Ne(J);if(D.onlyDirectory){if(S){K+= "/";}}if(!D.jE(K)){continue;}if(G==Te.length-1){if(D.onlyDirectory){if(S){Ze(C);}}else{Ze(C);}continue;}if(S){var B=G+1;var L=Te[B];if(!L.crossesDirectory){Ye(J,B);}else{Xe(J);}}}}}abstract class LB{final String source;final int position;LB(this.source,this.position){if(source==null){throw new ArgumentError("source: ${source}");}if(position==null){throw new ArgumentError("position: ${position}");}}bool get crossesDirectory;bool get strict;a get type;String toString(){return source;}}class oJ extends LB{oJ(String A,int B):super(A,B);bool get crossesDirectory=>false;bool get strict=>false;a get type=>a.qJ;}class pJ extends LB{pJ(String A,int B):super(A,B);bool get crossesDirectory=>true;bool get strict=>false;a get type=>a.rJ;}class OH extends QH{OH(String A,int B,List<LB> C):super(A,B,C){if(be.length<2){throw new ArgumentError("The number of elements in the list of nodes must be at least 2");}}bool get strict=>false;a get type=>a.sJ;}class PH extends LB{PH(String A,int B):super(A,B){if(A==null||A.length<3){throw new ArgumentError("source: ${A}");}if(A[0]!="["||A[A.length-1]!="]"){throw new ArgumentError("source: ${A}");}}bool get crossesDirectory=>false;bool get strict=>false;a get type=>a.tJ;}abstract class QH extends LB{bool ce;List<LB> be;bool de;QH(String B,int C,List<LB> A):super(B,C){if(A==null||A.isEmpty){throw new ArgumentError("nodes: ${A}");}for(var D in A){if(D is!LB){throw new ArgumentError("List of nodes contains invalid elements.");}}be=A.toList();}bool get crossesDirectory{if(ce==null){ce=false;for(var A in be){if(A.crossesDirectory){ce=true;break;}}}return ce;}List<LB> get FC=>new UnmodifiableListView<LB>(be);bool get strict{if(de==null){de=true;for(var A in be){if(!A.strict){de=false;break;}}}return de;}}class QC extends LB{QC(String A,int B):super(A,B);bool get crossesDirectory=>false;bool get strict=>true;a get type=>a.uJ;}class RH extends LB{RH(String A,int B):super(A,B);bool get crossesDirectory=>false;bool get strict=>false;a get type=>a.vJ;}class RC extends QH{bool ee;bool fe;RC(String B,int C,bool A,List<LB> D):super(B,C,D){if(A==null){throw new ArgumentError("isRoot: ${A}");}ee=A;}bool get vR=>ee;bool get onlyDirectory{if(fe==null){fe=false;if(!ee){var A=be.last;if(A is QC){fe=A.source.endsWith("/");}}}return fe;}a get type=>a.DO;}class SH extends QH{bool ge;List<RC> be;SH(String A,int B,List<RC> C):super(A,B,C);bool get isAbsolute{if(ge==null){ge=be.first.vR;}return ge;}List<RC> get FC=>new UnmodifiableListView<RC>(be);a get type=>a.VV;}class a{static const a qJ=const a("ASTERISK");static const a rJ=const a("ASTERISKS");static const a sJ=const a("BRACE");static const a tJ=const a("CHARACTER_CLASS");static const a uJ=const a("LITERAL");static const a vJ=const a("QUESTION");static const a DO=const a("SEGMENT");static const a VV=const a("SEGMENTS");final String name;const a(this.name);}class EO{static const String pB="";static const String WV="Cannot escape slash '/' character";static const String XV="Choice should contains at least two elements";static const String YV="Range out of order in character class";static const String wJ="Explicit slash '/' not allowed in character class";static const String ZV="Explicit slash '/' not allowed in brace";static const String FO="Unterminated backslash '\\' escape sequence";static const String xJ="Unexpected end of character class";static const String aV="Unexpected end of brace";String he;String ie;bool je;bool ee;int ke;int le;List<LB> me;List<RC> ne;int oe;SH kB(String A){if(A==null){throw new ArgumentError("input: ${A}");}if(A.isEmpty){var B=new QC("",0);var C=new RC("",0,false,[B]);return new SH("",0,[C]);}this.ie=A;pe();qe();return new SH(ie,0,ne);}bool re(String B){if(B.isEmpty){return false;}var A=B.codeUnitAt(0);if(A>=65&&A<=90||A>=97&&A<=122){return true;}return false;}RC se(){var G=le;var C=ie.substring(oe,le);var D=false;if(he=="/"){while(true){te();if(he!="/"){break;}}if(he==pB&&!ee){D=true;}}if(D){C+= "/";if(!me.isEmpty){var A=me.last;if(A is QC){var B=new QC(A.source+"/",A.position);me[me.length-1]=B;}else{var B=new QC("/",G);me.add(B);}}}var H=new RC(C,oe,ee,me);ue();return H;}void ve(String A,int B){throw new FormatException("(column: ${B+1}), ${A} in '${ie}'.");}int we(){int B;switch (he){case pB:var A=xJ;ve(A,le);break;case "/":var A=wJ;ve(A,le);break;case "\\":te();switch (he){case pB:var A=FO;ve(A,le);break;case "/":var A=wJ;ve(A,le);break;default:B=he.codeUnitAt(0);te();break;}break;case "^":B=he.codeUnitAt(0);te();break;default:B=he.codeUnitAt(0);te();break;}return B;}String xe(int B){var A=le+B;if(A<ke){return ie[A];}return pB;}String te(){if(le+1>=ke){he=pB;le=ke;return pB;}he=ie[ ++le];return he;}void qe(){switch (he){case pB:break;case "/":te();ee=true;var A=new QC("/",0);me.add(A);var B=se();ne.add(B);break;default:if(re(he)&&xe(1)==":"&&xe(2)=="/"){ee=true;le+= 2;te();var C=ie.substring(0,3);var A=new QC(C,0);me.add(A);var B=se();ne.add(B);}break;}if(he!=pB){ye();}}OH ze(){var D=le;var B=me.length;te();var G=true;var H=je;var C=false;je=true;while(true){switch (he){case pB:var A=aV;ve(A,le);break;case "/":var A=ZV;ve(A,le);break;case ",":te();if(he=="}"){te();var J=new QC("",le);me.add(J);C=true;}G=false;break;case "}":te();C=true;break;default:Af();break;}if(C){break;}}if(G){var A=XV;ve(A,le);}je=H;me.sublist(B,me.length);var K=me.sublist(B,me.length);me.length=B;var L=ie.substring(D,le);return new OH(L,D,K);}void Af(){LB A;switch (he){case "*":A=Bf();break;case "?":A=Cf();break;case "[":A=Df();break;case "{":A=ze();break;default:A=Ef();break;}me.add(A);}PH Df(){var B=le;te();var G=le;if(he=="!"){te();}if(he=="]"){te();}var C=false;while(true){switch (he){case "/":var A=wJ;ve(A,le);break;case pB:var A=xJ;ve(A,le);break;case "]":te();C=true;break;default:Ff();break;}if(C){break;}}var D=ie.substring(B,le);return new PH(D,B);}QC Ef(){var C=le;var A=false;while(true){switch (he){case pB:case "*":case "{":case "[":case "}":case "?":case "/":A=true;break;case ",":if(je){A=true;}else{te();}break;case "\\":te();if(he==pB){var B=FO;ve(B,le);}switch (he){case "/":var B=WV;ve(B,le);break;case "*":case "{":case "[":case "?":case "}":te();break;case "\\":te();break;default:break;}break;case "^":case "\$":case "(":case ".":case "+":case ")":case "|":te();break;default:te();break;}if(A){break;}}var D=ie.substring(C,le);return new QC(D,C);}RH Cf(){te();return new RH("?",le-1);}void Ff(){if(he=="-"){if(xe(1)=="]"){te();return;}}var B=we();var C=B;switch (he){case "-":te();if(he==pB){var A=xJ;ve(A,le);return;}else if(he=="]"){le-= 2;te();}else{var D=le;C=we();if(B>C){var A=YV;ve(A,D);}}break;}}void Gf(){while(true){LB A;switch (he){case pB:case "/":break;case "*":A=Bf();break;case "?":A=Cf();break;case "[":A=Df();break;case "{":A=ze();break;default:A=Ef();break;}if(A!=null){me.add(A);}else{break;}}}void ye(){var A=false;while(true){Gf();var B=se();ne.add(B);switch (he){case pB:A=true;break;}if(A){break;}}}LB Bf(){var A=le;te();var B=false;switch (he){case "*":B=true;while(true){te();if(he!="*"){break;}}B=true;break;}var C=ie.substring(A,le);if(B){return new pJ(C,A);}else{return new oJ(C,A);}}void pe(){je=false;ke=ie.length;le=0;ne=<RC>[] ;if(le<ke){he=ie[le];}else{le=ke;he=pB;}ue();}void ue(){ee=false;me=new List<LB>();oe=le;}}class BC{String Hf;Set If=new Set();String get name=>Hf;Set get values=>If;BC(this.Hf,dynamic A){if(A is Iterable){If.addAll(A);}else{If.add(A);}}String toString()=>"${If}";bool operator==(BC A)=>(Hf==A.Hf)&&If.containsAll(A.If)&&A.If.containsAll(If);static Map<String,BC> AU(Map<String,dynamic> D){var B=new Map<String,BC>();D.forEach((C,A){B[C]=(A is BC?A:new BC(C,A));});return B;}}MB s=new MB("LDAP");class bJ{static const String GU="localhost";static const int HU=389;static const int IU=636;String host;int port;bool BJ;String ZG;String password;bool Jf;String Kf;String Lf;nD Mf;void Nf(String A,int B,bool C,String D,String G){this.host=(A!=null)?A:GU;this.BJ=(C!=null)?C:false;this.port=(B!=null)?B:((this.BJ)?IU:HU);this.ZG=(D!=null)?D:"";this.password=(G!=null)?G:"";}bJ(String A,{int port,bool ssl: false,String bindDN,String password}){Nf(A,port,ssl,bindDN,password);Jf=false;}Future Of()async{if(Jf==false){}else{}}Future<nD> Ea([bool B=true])async{if(Mf!=null&&!Mf.isClosed()){return Mf;}await Of();s.gE(this.toString());Mf=new nD(host,port,BJ,ZG,password);await Mf.connect();if(B){var A=await Mf.bind();if(A.yI!=0)throw new mF("BIND Failed",A);}return Mf;}Future close([bool A=false]){if(Mf!=null){var B=Mf.close(A);Mf=null;return B;}else{assert(Mf!=null);return null;}}String toString(){return "${BJ?"ldaps://":"ldap://"}${host}:${port}${(ZG!=null)?"/${ZG}":""}";}}class nD{GH Pf;String Qf;String Rf;Function onError;bool isClosed()=>(Pf==null||Pf.isClosed());nD(String A,int B,[bool C=false,this.Qf,this.Rf]){Pf=new GH(A,B,C);}Future<nD> connect(){var A=new Completer<nD>();Pf.connect().then((C){A.complete(this);}).catchError((B){s.oE("Connect error ${B}");A.completeError(B);});return A.future;}Future<pC> bind([String A=null,String B=null]){if(A!=null)return Pf.process(new dJ(A,B));else return Pf.process(new dJ(Qf,Rf));}Future<pC> add(String A,Map<String,dynamic> B)=>Pf.process(new XN(A,BC.AU(B)));close([bool A=false])async{await Pf.close(A);Pf=null;}}abstract class LE{Stopwatch Sf=new Stopwatch()..start();gB message;LE(this.message);String toString()=>"PendingOp m=${message}";bool US(bC A);done(){var A=Sf.elapsedMilliseconds;s.YF("Request ${message} serviced in ${A} ms");}}class RN extends LE{Completer vL=new Completer();RN(gB A):super(A);bool US(bC B){var A=B.MM;if(Tf(A.yI)){vL.completeError(A);}else{vL.complete(A);}done();return true;}bool Tf(int A){switch (A){case 0:case cJ.WN:case cJ.VN:return false;}return true;}}class GH{Queue<LE> Uf=new Queue<LE>();Map<int,LE> Vf=new Map();static const BU=const Duration(seconds:3);bool Wf=false;Socket Xf;bool isClosed()=>Xf==null;int Yf=1;int Zf;String af;bool bf;GH(this.af,this.Zf,this.bf);Future<GH> connect()async{s.NC("Creating socket to ${af}:${Zf} ssl=${bf}");Xf=await (bf?SecureSocket.connect(af,Zf,onBadCertificate:cf):Socket.connect(af,Zf));s.YF("Connected to ${af}:${Zf}");Xf.transform(CU()).listen((C)=>df(C),onError:(A,B){s.oE("Socket error = ${A}  stacktrace=${B}");throw new mF("Socket error = ${A} stacktrace=${B}");});return this;}bool cf(X509Certificate A){s.qG("Invalid Certificate issuer= ${A.issuer} subject=${A.subject}");s.qG("SSL Connection will proceed. Please fix the certificate");return true;}Future<pC> process(nF B)async{var C=new gB( ++Yf,B);var A=new RN(C);ef(A);return await A.vL.future;}ef(LE A){Uf.add(A);ff();}ff(){while(gf()){var A=Uf.removeFirst();hf(A);}}bool gf()=>(!Uf.isEmpty)&&(Wf==false);hf(LE A)async{if(Xf==null){await connect();}s.YF("Sending message ${A.message}");var B=A.message.toBytes();Xf.add(B);Vf[A.message.gG]=A;if(A.message.RM==eJ)Wf=true;}Future close(bool B){if(B||jf()){return kf();}else{var A=new Completer();new Timer.periodic(BU,(Timer C){if(jf()){C.cancel();kf().then((D)=>A.complete());}});return A.future;}}bool jf(){if(Vf.isEmpty&&Uf.isEmpty){return true;}s.NC("close() waiting for queue to drain pendingResponse=${Vf}");ff();return false;}Future kf(){s.gE("Closing ldap connection");if(Xf==null){return new Future.value();}var A=Xf.done;new Future((){if(Xf!=null){Xf.destroy();Xf=null;}});return A;}void df(gB A){var B=dU.eU(A);if(B is IH){var D=B as IH;s.oE("Got extended response ${D.XS} code=${B.MM.yI}");}var C=Vf[A.gG];if(C==null)throw new mF("Server sent us an unknown message id = ${A.gG}" " opCode=${A.RM}");if(C.US(B)){Vf.remove(A.gG);}if(A.RM==fJ)Wf=false;}}abstract class mD{String get QM;static const DU=0xA0;bool Oa=false;u mG()=>throw new Exception("Not implemented. Subclass must implement");mD();static List<mD> EU(u A){s.NC("Create Controls from ${A}");var B=[] ;if(A!=null){A.c.forEach((C)=>B.add(FU(C)));}return B;}static FU(u A){var B=(A.c.first as fB).KB;s.NC("Got control ${B}");switch (B){case aJ.TN:return new aJ.Hb(A.c[1]);case ZJ.SN:return new ZJ.Gb(A.c[1]);default:throw new Exception("Control ${B} not implemented");}}String toString()=>"${QM} ${this.runtimeType}, isCritical=${Oa}}";}class ZJ extends mD{static const SN="1.2.840.113556.1.4.474";String get QM=>SN;ZJ.Gb(fB A){}}class aJ extends mD{static const TN="2.16.840.1.113730.3.4.10";get QM=>TN;int kS;int PR;int iR=0;int kb;aJ.Hb(fB B){var C=B.ZC;C[0]=vG;var D=new u.Ab(C);s.NC("Create control from ${B}  seq=${D}");var A=(D.c.first as u);A.c.forEach((G)=>s.NC(" ${G.runtimeType}  ${G}"));kS=(A.c[0] as oC).yB;PR=(A.c[1] as oC).yB;iR=(A.c[2] as oC).yB;}String toString()=>"${super.toString()}(targetpos=${kS}, contentCount=${PR},x=${iR})";}class mF implements Exception{String lf;pC mf;String get message=>lf;pC get MM=>mf;mF(this.lf,[this.mf]);String toString()=>"LDAPException(${message}, result=${mf})";}UN(bool A,String B){if(!A)throw new mF(B);}class XN extends nF{String nf;Map<String,BC> pf;XN(this.nf,Map<String,BC> this.pf):super(fN);v mG(){var A=qf();A.add(new fB(nf));var C=new u();pf.forEach((J,BC D){var B=new u();B.add(new fB(D.name));var G=new u();D.values.forEach((dynamic H){G.add(new fB(H));});B.add(G);C.add(B);});A.add(C);return A;}}class dJ extends nF{String rf;String sf;static const int fU=0x80;dJ(this.rf,this.sf):super(eJ);v mG(){var A=qf();var B=new oC(3);A.add(B);var C=new fB(rf);var D=new fB(sf,tag:fU);A.add(C);A.add(D);return A;}}class gB{int tf;int uf;int get RM=>uf;u vf;u wf;v xf;List<v> get c=>(xf as u).c;int get gG=>tf;bool get Ia=>wf!=null;u get fF=>vf;int get Wa=>xf.oS;gB(this.tf,nF B,[List<mD> A=null]){uf=B.ha;xf=B.mG();if(A!=null&&A.length>0){wf=new u(tag:oU);A.forEach((C){wf.add(C.mG());s.NC("adding control ${C}");});}String D()=>"LDAPMessage(id=${tf} ${fF} controls=${wf}";}gB.Jb(Uint8List A){xf=new u.Ab(A);UN(xf!=null,"Parsing error on ${A}");UN(c.length==2||c.length==3,"Expecting two or three elements.actual = ${c.length} obj=${xf}");var C=c[0] as oC;tf=C.yB;vf=c[1] as u;uf=vf.tag;if(c.length==3){var B=c[2].ZC;if(B[0]==mD.DU)wf=new u.Ab(B);}s.YF("Got LDAP Message. Id = ${gG} protocolOp = ${fF}");}List<int> toBytes(){u A=new u();A.add(new oC(tf));A.add(xf);if(wf!=null)A.add(wf);var B=A.ZC;return B;}String toString(){var A=jN(uf);return "Msg(id=${tf}, op=${A},controls=${wf})";}}const int eJ=0x60;const int fJ=0x61;const int gU=0x63;const int cN=0x64;const int eN=0x65;const int hU=0x73;const int iU=0x66;const int jU=0x67;const int fN=0x68;const int gN=0x69;const int kU=0x78;const int lU=0x6B;const int mU=0x6C;const int hN=0x6D;const int nU=0x6E;const int iN=0x6F;const int oU=0xA0;String jN(int A){switch (A){case eJ:return "BND_REQ";case fJ:return "BND_RESP";case gU:return "SRCH_REQ";case cN:return "SRCH_RES_ENTRY";case eN:return "SRCH_RES_DONE";case hU:return "SRCH_RES_REF";case iU:return "MODIFY_REQUEST";case fN:return "ADD_REQUEST";case gN:return "ADD_RESPONSE";case mU:return "MODIFY_DN_REQ";case hN:return "MODIFY_DN_RESP";case nU:return "COMPARE_REQ";case iN:return "COMPARE_RESP";default:return A.toRadixString(16);}}class ZN extends bC{ZN(gB A):super(A);}class bN extends bC{bN(gB A):super(A);}class dN extends bC{dN(gB A):super(A);}class IH extends bC{String XS;String response;IH(gB A):super(A){if(A.c.length>2){XS=yf(A.c[2]);if(A.c.length==4){response=yf(A.c[3]);}}}String yf(v A){var B=new fB.Eb(A.ZC);return B.KB;}}class YN{int vf;int get ha=>vf;YN(this.vf);u qf(){var A=new u(tag:vf);return A;}}abstract class nF extends YN{nF(int A):super(A);v mG();}class bC{pC zf;List<mD> wf=[] ;int Ag;pC get MM=>zf;bC.Ib();bC(gB A){s.NC("+++++ new response op = ${A}");zf=Bg(A.fF);if(A.Ia)wf=mD.EU(A.wf);}pC Bg(u A){s.NC("parse ldap result == ${A}");oC B=A.c[0];var C=B.yB;var D=A.c[1] as fB;var G=D.KB;var H=A.c[2] as fB;var J=H.KB;var K=[] ;if(A.c.length>3){var L=A.c[3];s.YF("parse LDAP Result type = ${L}");}return new pC(C,G,J,K);}}class dU{static bC eU(gB A){s.NC("handle response tag=${jN(A.fF.tag)}");bC B;switch (A.fF.tag){case fJ:return new ZN(A);case cN:return new aN(A);case eN:return new bN(A);case kU:return new IH(A);case gN:case lU:case jU:case hN:case iN:return new dN(A);default:throw "Not done";}return B;}}class aN extends bC{HH Cg;HH get cS=>Cg;aN(gB G):super.Ib(){var A=G.fF;var H=A.c[0] as fB;var B=H.KB;s.NC("Search Entry dn=${B}");var J=A.c[1] as u;Cg=new HH(B);J.c.forEach((u C){var D=C.c[0] as fB;var K=C.c[1] as MJ;var L=K.c.map((S)=>(S as fB).KB).toSet();cS.dZ[D.KB]=new BC(D.KB,L);});if(A.c.length>=3){var W=A.c[2];s.NC("Controls = ${W}");}}String toString(){return "SearchResultEntry(${cS}})";}}StreamTransformer<Uint8List,gB> CU(){Uint8List C=null;return new StreamTransformer.fromHandlers(handleData:(Uint8List H,EventSink<gB> S){var A;if(C==null){A=new Uint8List.view(H.buffer);}else{A=new Uint8List(C.length+H.length);A.setRange(0,C.length,C);A.setRange(C.length,A.length,H);C=null;}assert(0<A.length);do{var B=null;var D;if(2<=A.length){int J=A[1];if(J&0x80==0){D=1;B=J&0x7F;}else{var K=(J&0x7F);if(2+K<=A.length){D=1+K;B=0;for(int L=2;L<K+2;L++ ){B<<= 8;B|= A[L]&0xFF;}}}}if(B!=null&&(1+D+B)<=A.length){var G=(1+D+B);s.vZ("Bytes parsed for ASN.1 object: ${G}");s.YF("ASN.1 object received: tag=${A[0]}, length=${B}");s.NC("ASN.1 value: ${new Uint8List.view(A.buffer,1+D,B)}");if(A[0]==10){s.qG("LDAP stream transformer: got a tag 10 object");}var W=new gB.Jb(A);assert(W.Wa==G);S.add(W);if(A.length==G){A=null;}else{A=new Uint8List.view(A.buffer,A.offsetInBytes+G);}}else{C=A;A=null;}}while(A!=null);},handleError:(Object f,StackTrace p,EventSink<gB> S){s.oE("LDAP stream transformer: error=${f}, stacktrace=${p}");assert(false);throw f;});}class pC{int Dg;String Eg;String Fg;List<String> Gg;int get yI=>Dg;String get Ua=>Fg;pC(this.Dg,this.Fg,this.Eg,this.Gg);String toString()=>"${JU(yI)} msg=${Eg} dn=${Ua}";}class HH{String Hg;Map<String,BC> Ig=new Map<String,BC>();Map<String,BC> get dZ=>Ig;HH(this.Hg);String toString()=>"Entry[${Hg},${Ig}]";}String JU(int A)=>"${cJ.cU(A)} (${A})";class cJ{static const int KU=0;static const int LU=1;static const int MU=2;static const int NU=3;static const int OU=4;static const int VN=5;static const int WN=6;static const int PU=7;static const int QU=8;static const int RU=9;static const int SU=11;static const int TU=12;static const int UU=13;static const int VU=14;static const int WU=16;static const int XU=17;static const int YU=32;static const int ZU=49;static const int aU=50;static const int bU=68;static String cU(int A){switch (A){case KU:return "OK";case LU:return "Operations Error";case MU:return "Protocol Error";case NU:return "Time Limit Exceeded";case OU:return "Size Limit Exceeded";case WN:return "Compare True";case VN:return "Compare False";case PU:return "Auth Method Not supported";case QU:return "String Auth Required";case RU:return "Referral";case SU:return "Admin Limit Exceeded";case TU:return "UNAVAILABLE_CRITICAL_EXTENSION";case UU:return "CONFIDENTIALITY_REQUIRED";case VU:return "SASL_BIND_IN_PROGRESS";case WU:return "NO_SUCH_ATTRIBUTE";case XU:return "Undefined Attribute Type";case YU:return "Object does not exist";case ZU:return "Invalid Credentials";case aU:return "Insufficient Access Rights";case bU:return "Entry already exists";default:return "LDAP Error code ${A}";}}}class SW extends YK{}class tD{}class JC implements Comparable<JC>{}abstract class QW implements JC{String get sa{var A=m==null?'unknown source':m;return '${A}:${jB+1}:${DB+1}';}int WR(JC A){if(m!=A.m){throw new ArgumentError("Source URLs \"${m}\" and " "\"${A.m}\" don't match.");}return (offset-A.offset).abs();}JB mB()=>new JB(this,this,"");int compareTo(JC A){if(m!=A.m){throw new ArgumentError("Source URLs \"${m}\" and " "\"${A.m}\" don't match.");}return offset-A.offset;}bool operator==(A)=>A is JC&&m==A.m&&offset==A.offset;int get hashCode=>m.hashCode+offset;String toString()=>'<${runtimeType}: ${offset} ${sa}>';}bool TH=false;j eV=j.hV;j fV=j.JO;class MB{final String name;String get kR=>(parent==null||parent.name=='')?name:'${parent.kR}.${name}';final MB parent;j Jg;final Map<String,MB> Kg;final Map<String,MB> zD;StreamController<pD> Lg;factory MB(String A){return gV.putIfAbsent(A,()=>new MB.Kb(A));}factory MB.Kb(String A){if(A.startsWith('.')){throw new ArgumentError("name shouldn't start with a '.'");}int B=A.lastIndexOf('.');MB C=null;String D;if(B==-1){if(A!='')C=new MB('');D=A;}else{C=new MB(A.substring(0,B));D=A.substring(B+1);}return new MB.Lb(D,C,new Map<String,MB>());}MB.Lb(this.name,this.parent,Map<String,MB> A):this.Kg=A,this.zD=new UnmodifiableMapView(A){if(parent!=null)parent.Kg[name]=this;}j get level{if(TH){if(Jg!=null)return Jg;if(parent!=null)return parent.level;}return fV;}Stream<pD> get ba=>Mg();bool Pa(j A)=>(A>=level);void cF(j B,A,[Object D,StackTrace G,Zone H]){Object J;if(Pa(B)){if(A is Function)A=A();if(A is!String){J=A;A=A.toString();}if(G==null&&B>=eV){try {throw "autogenerated stack trace for ${B} ${A}";}catch (L,S){G=S;if(D==null)D=L;}}if(H==null)H=Zone.current;var K=new pD(B,A,kR,D,G,H,J);if(TH){var C=this;while(C!=null){C.Ng(K);C=C.parent;}}else{IO.Ng(K);}}}void NC(A,[Object B,StackTrace C])=>cF(j.iV,A,B,C);void vZ(A,[Object B,StackTrace C])=>cF(j.jV,A,B,C);void YF(A,[Object B,StackTrace C])=>cF(j.kV,A,B,C);void gE(A,[Object B,StackTrace C])=>cF(j.JO,A,B,C);void qG(A,[Object B,StackTrace C])=>cF(j.lV,A,B,C);void oE(A,[Object B,StackTrace C])=>cF(j.mV,A,B,C);Stream<pD> Mg(){if(TH||parent==null){if(Lg==null){Lg=new StreamController<pD>.broadcast(sync:true);}return Lg.stream;}else{return IO.Mg();}}void Ng(pD A){if(Lg!=null){Lg.add(A);}}static final MB IO=new MB('');static final Map<String,MB> gV=<String,MB>{};}class j implements Comparable<j>{final String name;final int value;const j(this.name,this.value);static const j hV=const j('OFF',2000);static const j iV=const j('FINEST',300);static const j jV=const j('FINER',400);static const j kV=const j('FINE',500);static const j JO=const j('INFO',800);static const j lV=const j('WARNING',900);static const j mV=const j('SEVERE',1000);bool operator==(A)=>A is j&&value==A.value;bool operator<(j A)=>value<A.value;bool operator<=(j A)=>value<=A.value;bool operator>(j A)=>value>A.value;bool operator>=(j A)=>value>=A.value;int compareTo(j A)=>value-A.value;int get hashCode=>value;String toString()=>name;}class pD{final j level;final String message;final Object aa;final String CS;final DateTime na;final int la;static int nV=0;final Object error;final StackTrace stackTrace;final Zone zone;pD(this.level,this.message,this.CS,[this.error,this.stackTrace,this.zone,this.aa]):na=new DateTime.now(),la=pD.nV++ ;String toString()=>'[${level.name}] ${CS}: ${message}';}class vO extends hK implements DF{vO(String A):super(A,()=>new wO(A));}class wO implements DF,iK{final String path;Stream<CC> get mI=>Og.stream;final Og=new StreamController<CC>.broadcast();Future get SM=>Pg.future;final Pg=new Completer();StreamSubscription Qg;wO(this.path){Rg();Pg.complete();}void Rg(){Qg=new File(path).watch().transform(new fW<FileSystemEvent>()).listen(Sg,onError:Og.addError,onDone:Tg);}void Sg(List<FileSystemEvent> A){if(A.any((B)=>B.type==FileSystemEvent.DELETE)){return;}Og.add(new CC(tC.eH,path));}Tg()async{var A=await new File(path).exists();if(Og.isClosed)return;if(A){Og.add(new CC(tC.eH,path));Rg();}else{Og.add(new CC(tC.AP,path));close();}}void close(){if(Qg!=null)Qg.cancel();Qg=null;Og.close();}}abstract class BK{}class oV implements BK{var ja=new Random(new DateTime.now().millisecondsSinceEpoch);List<int> Da(int C){var A=new List<int>();for(var B=0;B<C;B++ ){A.add(ja.nextInt(256));}return A;}}class CK{BK aS;kD hash;int Ug;int Vg;CK({BK saltGenerator,kD hash,int iterations: 1000,int keyLength: 32}){this.aS=saltGenerator==null?new oV():saltGenerator;this.hash=hash==null?new AH():hash;this.Ug=iterations;this.Vg=keyLength;}String Ka(String A,{List<int> salt}){if(salt==null){salt=aS.Da(32);}var B=KO.pV(salt,A,hash,Ug,Vg);return KO.qV(salt,B);}}class KO{static List<int> pV(List<int> A,String B,kD C,int D,int G){var H=new SO(hash:C);return H.Ca(B,new String.fromCharCodes(A),D,G);}static String qV(List<int> C,List<int> D){var B=lD.FH(C);var G=lD.FH(D);var H=B.length;var A="${H}";while(A.length<3){A="0${A}";}return "${A}${B}${G}";}}final MD qC=BW();String get LO{var C=Uri.base;if(SB.FK==SB.qF){return C.resolve('.').toString();}else{var A=C.toFilePath();int B=A.length-1;assert(A[B]=='/'||A[B]=='\\');return A.substring(0,B);}}String rV(String A)=>qC.rL(A);String UH(String A)=>qC.lZ(A);String MO(String A)=>qC.DM(A);String sV(String A)=>qC.ZS(A);bool NO(String A)=>qC.isAbsolute(A);bool tV(String A)=>qC.eG(A);String YB(String A,[String B,String C,String D,String G,String H,String J,String K])=>qC.join(A,B,C,D,G,H,J,K);List<String> VH(String A)=>qC.split(A);String uV(String A)=>qC.kE(A);String vV(A)=>qC.ga(A);const WH=0x2e;const qD=0x2f;const wV=0x3a;const xV=0x41;const yV=0x5a;const zV=0x61;const AW=0x7a;const DK=0x5c;MD BW()=>new MD.Mb();class MD{factory MD({SB style,String current}){if(current==null){if(style==null){current=LO;}else{current=".";}}if(style==null){style=SB.FK;}else if(style is!ND){throw new ArgumentError("Only styles defined by the path package are " "allowed.");}return new MD.Nb(style as ND,current);}MD.Mb():Z=SB.FK as ND,Wg=null;MD.Nb(this.Z,this.Wg);final ND Z;final String Wg;String get current=>Wg!=null?Wg:LO;String get mC=>Z.mC;String absolute(String A,[String B,String C,String D,String G,String H,String J]){OO("absolute",[A,B,C,D,G,H,J]);if(B==null&&isAbsolute(A)&&!zB(A)){return A;}return join(current,A,B,C,D,G,H,J);}String rL(String A)=>Xg(A).rL;String lZ(String B){var A=Xg(B);A.wI();if(A.o.isEmpty)return A.EB==null?'.':A.EB;if(A.o.length==1){return A.EB==null?'.':A.EB;}A.o.removeLast();A.cB.removeLast();A.wI();return A.toString();}String DM(String A)=>Xg(A).DM;String ZS(String A)=>A.substring(0,Z.jD(A));bool isAbsolute(String A)=>Z.jD(A)>0;bool eG(String A)=>!this.isAbsolute(A);bool zB(String A)=>Z.zB(A);String join(String B,[String C,String D,String G,String H,String J,String K,String L]){var A=<String>[B,C,D,G,H,J,K,L];OO("join",A);return Ra(A.where((S)=>S!=null));}String Ra(Iterable<String> H){var B=new StringBuffer();var D=false;var G=false;for(var A in H.where((A)=>A!='')){if(this.zB(A)&&G){var C=Xg(A);C.EB=this.ZS(B.toString());if(Z.dF(C.EB)){C.cB[0]=Z.mC;}B.clear();B.write(C.toString());}else if(this.isAbsolute(A)){G=!this.zB(A);B.clear();B.write(A);}else{if(A.length>0&&Z.iI(A[0])){}else if(D){B.write(mC);}B.write(A);}D=Z.dF(A);}return B.toString();}List<String> split(String B){var A=Xg(B);A.o=A.o.where((C)=>!C.isEmpty).toList();if(A.EB!=null)A.o.insert(0,A.EB);return A.o;}String kE(String A){if(!Yg(A))return A;var B=Xg(A);B.kE();return B.toString();}bool Yg(String J){var K=0;var D=J.codeUnits;var B;var A;var G=Z.jD(J);if(G!=0){K=G;A=qD;if(Z==SB.XH){for(var C=0;C<G;C++ ){if(D[C]==qD)return true;}}}for(var C=K;C<D.length;C++ ){var H=D[C];if(Z.uB(H)){if(Z==SB.XH&&H==qD)return true;if(A!=null&&Z.uB(A))return true;if(A==WH&&(B==null||B==WH||Z.uB(B))){return true;}}B=A;A=H;}if(A==null)return true;if(Z.uB(A))return true;if(A==WH&&(B==null||B==qD||B==WH)){return true;}return false;}String ka(String C,{String from}){if(from==null){from=current;}else if(this.eG(from)||this.zB(from)){from=this.join(current,from);}if(this.eG(from)&&this.isAbsolute(C)){return this.kE(C);}if(this.eG(C)||this.zB(C)){C=this.absolute(C);}if(this.eG(C)&&this.isAbsolute(from)){throw new EK('Unable to find a path to "${C}" from "${from}".');}var B=Xg(from)..kE();var A=Xg(C)..kE();if(B.o.length>0&&B.o[0]=='.'){return A.toString();}if(B.EB!=A.EB&&((B.EB==null||A.EB==null)||B.EB.toLowerCase().replaceAll('/','\\')!=A.EB.toLowerCase().replaceAll('/','\\'))){return A.toString();}while(B.o.length>0&&A.o.length>0&&B.o[0]==A.o[0]){B.o.removeAt(0);B.cB.removeAt(1);A.o.removeAt(0);A.cB.removeAt(1);}if(B.o.length>0&&B.o[0]=='..'){throw new EK('Unable to find a path to "${C}" from "${from}".');}A.o.insertAll(0,new List.filled(B.o.length,'..'));A.cB[0]='';A.cB.insertAll(1,new List.filled(B.o.length,Z.mC));if(A.o.length==0)return '.';if(A.o.length>1&&A.o.last=='.'){A.o.removeLast();A.cB..removeLast()..removeLast()..add('');}A.EB='';A.wI();return A.toString();}String yZ(A){if(A is String)A=Uri.parse(A);return Z.kG(A);}String ga(A){if(A is String)A=Uri.parse(A);if(A.scheme=='file'&&Z==SB.qF)return A.toString();if(A.scheme!='file'&&A.scheme!=''&&Z!=SB.qF){return A.toString();}var B=kE(yZ(A));var C=ka(B);return split(C).length>split(B).length?B:C;}NE Xg(String A)=>new NE.Ob(A,Z);}OO(String H,List<String> A){for(var B=1;B<A.length;B++ ){if(A[B]==null||A[B-1]!=null)continue;var C;for(C=A.length;C>=1;C-- ){if(A[C-1]!=null)break;}var D=new StringBuffer();D.write("${H}(");D.write(A.take(C).map((G)=>G==null?"null":'"${G}"').join(", "));D.write("): part ${B-1} was null, but part ${B} was not.");throw new ArgumentError(D.toString());}}abstract class ND extends SB{String get mC;bool iI(String A);bool uB(int A);bool dF(String A);int jD(String A);String nR(String A){var B=jD(A);if(B>0)return A.substring(0,B);return zB(A)?A[0]:null;}bool zB(String A);String kG(Uri A);}class NE{ND Z;String EB;bool zB;List<String> o;List<String> cB;String get DM=>Zg()[1];bool get isAbsolute=>EB!=null;factory NE.Ob(String A,ND D){var H=D.nR(A);var K=D.zB(A);if(H!=null)A=A.substring(H.length);var J=<String>[] ;var G=<String>[] ;var B=0;if(A.isNotEmpty&&D.uB(A.codeUnitAt(0))){G.add(A[0]);B=1;}else{G.add('');}for(var C=B;C<A.length;C++ ){if(D.uB(A.codeUnitAt(C))){J.add(A.substring(B,C));G.add(A[C]);B=C+1;}}if(B<A.length){J.add(A.substring(B));G.add('');}return new NE.Pb(D,H,K,J,G);}NE.Pb(this.Z,this.EB,this.zB,this.o,this.cB);String get rL=>Zg()[0];void wI(){while(!o.isEmpty&&o.last==''){o.removeLast();cB.removeLast();}if(cB.length>0)cB[cB.length-1]='';}void kE(){var C=0;var A=<String>[] ;for(var B in o){if(B=='.'||B==''){}else if(B=='..'){if(A.length>0){A.removeLast();}else{C++ ;}}else{A.add(B);}}if(!isAbsolute){A.insertAll(0,new List.filled(C,'..'));}if(A.length==0&&!isAbsolute){A.add('.');}var D=new List<String>.generate(A.length,(G)=>Z.mC,growable:true);D.insert(0,isAbsolute&&A.length>0&&Z.dF(EB)?Z.mC:'');o=A;cB=D;if(EB!=null&&Z==SB.XH){EB=EB.replaceAll('/','\\');}wI();}String toString(){var A=new StringBuffer();if(EB!=null)A.write(EB);for(var B=0;B<o.length;B++ ){A.write(cB[B]);A.write(o[B]);}A.write(cB.last);return A.toString();}List<String> Zg(){var A=o.lastWhere((C)=>C!='',orElse:()=>null);if(A==null)return ['',''];if(A=='..')return ['..',''];var B=A.lastIndexOf('.');if(B<=0)return [A,''];return [A.substring(0,B),A.substring(B)];}NE VF()=>new NE.Pb(Z,EB,zB,new List.from(o),new List.from(cB));}class EK implements Exception{String message;EK(this.message);String toString()=>"PathException: ${message}";}abstract class SB{static final SB CW=new PO();static final SB XH=new RO();static final SB qF=new QO();static final SB FK=DW();static SB DW(){if(Uri.base.scheme!='file')return SB.qF;if(!Uri.base.path.endsWith('/'))return SB.qF;if(new Uri(path:'a/b').toFilePath()=='a\\b')return SB.XH;return SB.CW;}String get name;MD get context=>new MD(style:this);String get mC;String nR(String A);String kG(Uri A);String toString()=>name;}class PO extends ND{PO();final name='posix';final mC='/';final cB=const['/'];final dS=new RegExp(r'/');final JS=new RegExp(r'[^/]$');final YS=new RegExp(r'^/');final WS=null;bool iI(String A)=>A.contains('/');bool uB(int A)=>A==qD;bool dF(String A)=>A.isNotEmpty&&!uB(A.codeUnitAt(A.length-1));int jD(String A){if(A.isNotEmpty&&uB(A.codeUnitAt(0)))return 1;return 0;}bool zB(String A)=>false;String kG(Uri A){if(A.scheme==''||A.scheme=='file'){return Uri.decodeComponent(A.path);}throw new ArgumentError("Uri ${A} must have scheme 'file:'.");}}class QO extends ND{QO();final name='url';final mC='/';final cB=const['/'];final dS=new RegExp(r'/');final JS=new RegExp(r"(^[a-zA-Z][-+.a-zA-Z\d]*://|[^/])$");final YS=new RegExp(r"[a-zA-Z][-+.a-zA-Z\d]*://[^/]*");final WS=new RegExp(r"^/");bool iI(String A)=>A.contains('/');bool uB(int A)=>A==qD;bool dF(String A){if(A.isEmpty)return false;if(!uB(A.codeUnitAt(A.length-1)))return true;return A.endsWith("://")&&jD(A)==A.length;}int jD(String A){if(A.isEmpty)return 0;if(uB(A.codeUnitAt(0)))return 1;var B=A.indexOf("/");if(B>0&&A.startsWith('://',B-1)){B=A.indexOf('/',B+2);if(B>0)return B;return A.length;}return 0;}bool zB(String A)=>A.isNotEmpty&&uB(A.codeUnitAt(0));String kG(Uri A)=>A.toString();}class RO extends ND{RO();final name='windows';final mC='\\';final cB=const['/','\\'];final dS=new RegExp(r'[/\\]');final JS=new RegExp(r'[^/\\]$');final YS=new RegExp(r'^(\\\\[^\\]+\\[^\\/]+|[a-zA-Z]:[/\\])');final WS=new RegExp(r"^[/\\](?![/\\])");bool iI(String A)=>A.contains('/');bool uB(int A)=>A==qD||A==DK;bool dF(String A){if(A.isEmpty)return false;return !uB(A.codeUnitAt(A.length-1));}int jD(String A){if(A.isEmpty)return 0;if(A.codeUnitAt(0)==qD)return 1;if(A.codeUnitAt(0)==DK){if(A.length<2||A.codeUnitAt(1)!=DK)return 1;var B=A.indexOf('\\',2);if(B>0){B=A.indexOf('\\',B+1);if(B>0)return B;}return A.length;}if(A.length<3)return 0;if(!EW(A.codeUnitAt(0)))return 0;if(A.codeUnitAt(1)!=wV)return 0;if(!uB(A.codeUnitAt(2)))return 0;return 3;}bool zB(String A)=>jD(A)==1;String kG(Uri A){if(A.scheme!=''&&A.scheme!='file'){throw new ArgumentError("Uri ${A} must have scheme 'file:'.");}var B=A.path;if(A.host==''){if(B.startsWith('/'))B=B.replaceFirst("/","");}else{B='\\\\${A.host}${B}';}return Uri.decodeComponent(B.replaceAll("/","\\"));}}bool EW(int A)=>(A>=xV&&A<=yV)||(A>=zV&&A<=AW);class SO{kD hash;List<int> aG=new List<int>(4);SO({kD this.hash});List<int> Ca(String K,String L,int S,int B){var H=hash.newInstance();H.add([1,2,3]);var C=H.close().length;if(B>((2<<31)-1)*C){throw "derived key too long";}var D=(B/C).ceil();var W=B-(D-1)*C;var G=[] ;for(var A=1;A<=D;A++ ){var J=ag(K,L,S,A);if(A<D){G.addAll(J);}else{G.addAll(J.sublist(0,W));}}return G;}List<int> ag(String C,String J,int K,int L){var A=new DH(hash,C.codeUnits);A.add(J.codeUnits);bg(A,L);var B=A.close();var D=B;for(var G=1;G<K;G++ ){A=new DH(hash,C.codeUnits);A.add(B);var H=A.close();cg(D,H);B=H;}return D;}bg(DH B,int A){aG[0]=A>>24;aG[1]=A>>16;aG[2]=A>>8;aG[3]=A;B.add(aG);}cg(List<int> B,List<int> C){for(var A=0;A<B.length;A++ ){B[A]=B[A]^C[A];}}}class GK extends cC{final Function dg;GK(A,this.dg):super(A);GB r(TB B){var A=eg.r(B);if(A.gD){return A.PC(dg(A.value));}else{return A;}}bool iB(O A){return A is GK&&super.iB(A)&&dg==A.dg;}}class TO extends cC{O fg;O gg;TO(A,this.fg,this.gg):super(A);GB r(TB C){var A=C;do{A=fg.r(A);}while((A as GB).gD);var B=eg.r(A);if(B.hE){return B;}A=B;do{A=gg.r(A);}while((A as GB).gD);return A.PC(B.value);}List<O> get zD=>[eg,fg,gg];void replace(O A,O B){super.replace(A,B);if(fg==A){fg=B;}if(gg==A){gg=B;}}}class YO extends cC{YO(A):super(A);GB r(TB A){var B=eg.r(A);if(B.gD){var C=A.buffer is String?A.buffer.substring(A.position,B.position):A.buffer.sublist(A.position,B.position);return B.PC(C);}else{return B;}}}class dO extends cC{dO(A):super(A);GB r(TB B){var A=eg.r(B);if(A.gD){var C=new OE(A.value,B.buffer,B.position,A.position);return A.PC(C);}else{return A;}}}class zE extends O{final OD hg;final String ig;zE(this.hg,this.ig);GB r(TB A){var C=A.buffer;var B=A.position;if(B<C.length&&hg.test(C.codeUnitAt(B))){return A.PC(C[B],B+1);}return A.eD(ig);}String toString()=>'${super.toString()}[${ig}]';bool iB(O A){return A is zE&&super.iB(A)&&hg==A.hg&&ig==A.ig;}}abstract class OD{}class VO implements OD{final OD TS;VO(this.TS);bool test(int A)=>!TS.test(A);}OD HW(Iterable<AF> K){var H=new List.from(K,growable:false);H.sort((C,D){return C.start!=D.start?C.start-D.start:C.stop-D.stop;});var A=new List();for(var B in H){if(A.isEmpty){A.add(B);}else{var J=A.last;if(J.stop+1>=B.start){var L=new AF(J.start,B.stop);A[A.length-1]=L;}else{A.add(B);}}}if(A.length==1){return A[0].start==A[0].stop?new TK(A[0].start):A[0];}else{return new hO(A.length,A.map((G)=>G.start).toList(growable:false) as List<int>,A.map((G)=>G.stop).toList(growable:false) as List<int>);}}O h(A,[String B]){return new zE(new TK(uF(A)),B!=null?B:'"${A}" expected');}class TK implements OD{final int value;const TK(this.value);bool test(int A)=>identical(this.value,A);}O YH([String A]){return new zE(IW,A!=null?A:'digit expected');}class eO implements OD{const eO();bool test(int A)=>48<=A&&A<=57;}const IW=const eO();O gO(String A,[String B]){return new zE(KW.kB(A).value,B!=null?B:'[${A}] expected');}O JW(){var B=rD().map((A)=>new AF(uF(A),uF(A)));var C=rD().nE(h('-')).nE(rD()).map((A)=>new AF(uF(A[0]),uF(A[2])));var D=C.hD(B).vI().map((A)=>HW(A as Iterable<AF>));return h('^').FD().nE(D).map((A)=>A[0]==null?A[1]:new VO(A[1]));}final KW=JW();class hO implements OD{final int length;final List<int> gS;final List<int> hS;hO(this.length,this.gS,this.hS);bool test(int D){var A=0;var B=length;while(A<B){var C=A+((B-A)>>1);var G=gS[C]-D;if(G==0){return true;}else if(G<0){A=C+1;}else{B=C;}}return 0<A&&D<=hS[A-1];}}class AF implements OD{final int start;final int stop;AF(this.start,this.stop);bool test(int A)=>start<=A&&A<=stop;}O LW([String A]){return new zE(MW,A!=null?A:'whitespace expected');}class iO implements OD{const iO();bool test(int A){if(A<256){return A==0x09||A==0x0A||A==0x0B||A==0x0C||A==0x0D||A==0x20||A==0x85||A==0xA0;}else{return A==0x1680||A==0x180E||A==0x2000||A==0x2001||A==0x2002||A==0x2003||A==0x2004||A==0x2005||A==0x2006||A==0x2007||A==0x2008||A==0x2009||A==0x200A||A==0x2028||A==0x2029||A==0x202F||A==0x205F||A==0x3000||A==0xFEFF;}}}const MW=const iO();int uF(A){if(A is num){return A.round();}var B=A.toString();if(B.length!=1){throw new ArgumentError('${B} is not a character');}return B.codeUnitAt(0);}class cC extends O{O eg;cC(this.eg);GB r(TB A){return eg.r(A);}List<O> get zD=>[eg];void replace(O A,O B){super.replace(A,B);if(eg==A){eg=B;}}}class JK extends cC{final String ig;JK(A,this.ig):super(A);GB r(TB B){var A=eg.r(B);if(A.hE||A.position==A.buffer.length){return A;}return A.eD(ig,A.position);}String toString()=>'${super.toString()}[${ig}]';bool iB(O A){return A is JK&&super.iB(A)&&ig==A.ig;}}class XO extends cC{XO(A):super(A);GB r(TB B){var A=eg.r(B);if(A.gD){return B.PC(A.value);}else{return A;}}}class PK extends cC{final String ig;PK(A,this.ig):super(A);GB r(TB A){var B=eg.r(A);if(B.hE){return A.PC(null);}else{return A.eD(ig);}}String toString()=>'${super.toString()}[${ig}]';bool iB(O A){return A is PK&&super.iB(A)&&ig==A.ig;}}class RK extends cC{final jg;RK(A,this.jg):super(A);GB r(TB A){var B=eg.r(A);if(B.gD){return B;}else{return A.PC(jg);}}bool iB(O A){return A is RK&&super.iB(A)&&jg==A.jg;}}abstract class SK extends O{final List<O> kg;SK(this.kg);List<O> get zD=>kg;void replace(O B,O C){super.replace(B,C);for(var A=0;A<kg.length;A++ ){if(kg[A]==B){kg[A]=C;}}}}class tF extends SK{factory tF(Iterable<O> A){return new tF.Qb(new List.from(A,growable:false));}tF.Qb(List<O> A):super(A);GB r(TB C){var A;for(var B=0;B<kg.length;B++ ){A=kg[B].r(C);if(A.gD){return A;}}return A;}O hD(O A){return new tF(new List()..addAll(kg)..add(A));}}class PE extends SK{factory PE(Iterable<O> A){return new PE.Rb(new List.from(A,growable:false));}PE.Rb(List<O> A):super(A);GB r(TB G){var C=G;var D=new List(kg.length);for(var A=0;A<kg.length;A++ ){var B=kg[A].r(C);if(B.hE){return B;}D[A]=B.value;C=B;}return C.PC(D);}O nE(O A){return new PE(new List()..addAll(kg)..add(A));}}class TB{const TB(this.buffer,this.position);final buffer;final int position;GB PC(B,[int A]){return new WO(buffer,A==null?this.position:A,B);}GB eD(String B,[int A]){return new LK(buffer,A==null?this.position:A,B);}String toString()=>'Context[${HJ()}]';String HJ()=>OE.bO(buffer,position);}abstract class GB extends TB{const GB(A,B):super(A,B);bool get gD=>false;bool get hE=>false;get value;String get message;}class WO extends GB{const WO(A,B,this.value):super(A,B);bool get gD=>true;final value;String get message=>null;String toString()=>'Success[${HJ()}]: ${value}';}class LK extends GB{const LK(A,B,this.message):super(A,B);bool get hE=>true;get value=>throw new ZO(this);final String message;String toString()=>'Failure[${HJ()}]: ${message}';}class ZO extends Error{final LK eD;ZO(this.eD);String toString()=>'${eD.message} at ${eD.HJ()}';}abstract class NK{const NK();O start();O Q(Function A,[B,C,D,G,H,J]){var K=[B,C,D,G,H,J].takeWhile((L)=>L!=null).toList(growable:false);return new rC(A,K);}O fZ({Function start: null,List arguments: const[] }){return lg(new rC(start!=null?start:this.start,arguments));}O lg(rC C){var H=new Map();O J(rC C){var A=H[C];if(A==null){var D=[C];A=C.resolve();while(A is rC){if(D.contains(A)){throw new StateError('Recursive references detected: ${D}');}D.add(A);A=A.resolve();}for(var W in D){H[W]=A;}}return A;}var G=[J(C)];var K=new Set.from(G);while(G.isNotEmpty){var L=G.removeLast();for(var B in L.zD){if(B is rC){var S=J(B);L.replace(B,S);B=S;}if(!K.contains(B)){K.add(B);G.add(B);}}}return H[C];}}class fO extends cC{fO(NK A):super(A.fZ());}class rC extends O{final Function function;final List arguments;rC(this.function,this.arguments);O resolve()=>Function.apply(function,arguments);bool operator==(A){if(A is!rC||A.function!=function||A.arguments.length!=arguments.length){return false;}for(var B=0;B<arguments.length;B++ ){var C=arguments[B],D=A.arguments[B];if(C is O&&C is!rC&&D is O&&D is!rC){if(!C.uR(D)){return false;}}else{if(C!=D){return false;}}}return true;}int get hashCode=>function.hashCode;GB r(TB A)=>throw new UnsupportedError('References cannot be parsed.');}abstract class O{GB r(TB A);GB kB(A){return r(new TB(A,0));}Iterable BE(B){var A=new List();YG().map((C)=>A.add(C)).nE(rD()).hD(rD()).HD().kB(B);return A;}Iterable Va(B){var A=new List();map((C)=>A.add(C)).hD(rD()).HD().kB(B);return A;}O FD([A])=>new RK(this,A);O HD()=>xI(0,rF);O vI()=>xI(1,rF);O xI(int A,int B){return new UO(this,A,B);}O GJ(int A)=>xI(A,A);O nE(O A)=>new PE([this,A]);O operator&(O A)=>this.nE(A);O hD(O A)=>new tF([this,A]);O operator|(O A)=>this.hD(A);O YG()=>new XO(this);O jG([String A])=>new PK(this,A);O KS([String A])=>jG(A).nE(rD()).iD(1);O EM()=>new YO(this);O oB()=>new dO(this);O trim([O A,O B]){if(A==null)A=LW();if(B==null)B=A;return new TO(this,A,B);}O end([String A='end of input expected']){return new JK(this,A);}O map(Function A)=>new GK(this,A);O iD(int A){return this.map((List B){return B[A<0?B.length+A:A];});}O fa(List<int> C){return this.map((List B){return C.map((A){return B[A<0?B.length+A:A];}).toList();});}O lG(O B,{bool includeSeparators: true,bool optionalSeparatorAtEnd: false}){var D=new PE([B,this]).HD();var H=new PE(optionalSeparatorAtEnd?[this,D,B.FD(B)]:[this,D]);return H.map((List C){var A=new List();A.add(C[0]);for(var G in C[1]){if(includeSeparators){A.add(G[0]);}A.add(G[1]);}if(includeSeparators&&optionalSeparatorAtEnd&&!identical(C[2],B)){A.add(C[2]);}return A;});}bool uR(O B,[Set<O> A]){if(A==null){A=new Set();}if(this==B||A.contains(this)){return true;}A.add(this);return runtimeType==B.runtimeType&&iB(B)&&Ja(B,A);}bool iB(O A)=>true;bool Ja(O D,Set<O> G){var B=zD,C=D.zD;if(B.length!=C.length){return false;}for(var A=0;A<B.length;A++ ){if(!B[A].uR(C[A],G)){return false;}}return true;}List<O> get zD=>const[] ;void replace(O A,O B){}}O rD([String A='input expected']){return new IK(A);}class IK extends O{final String ig;IK(this.ig);GB r(TB A){var B=A.position;var C=A.buffer;return B<C.length?A.PC(C[B],B+1):A.eD(ig);}bool iB(O A){return A is IK&&super.iB(A)&&ig==A.ig;}}O KK(A,[String B]){return cO(1,(C)=>A.indexOf(C)>=0,B!=null?B:'any of ${A} expected');}O sF(String A,[String B]){return cO(A.length,(String C)=>A==C,B!=null?B:'${A} expected');}typedef bool aO(_0);O cO(int A,aO B,String C){return new QK(A,B,C);}class QK extends O{final int mg;final aO hg;final String ig;QK(this.mg,this.hg,this.ig);GB r(TB A){final C=A.position;final B=C+mg;if(B<=A.buffer.length){var D=A.buffer is String?A.buffer.substring(C,B):A.buffer.sublist(C,B);if(hg(D)){return A.PC(D,B);}}return A.eD(ig);}String toString()=>'${super.toString()}[${ig}]';bool iB(O A){return A is QK&&super.iB(A)&&mg==A.mg&&hg==A.hg&&ig==A.ig;}}const int rF=-1;abstract class HK extends cC{final int ng;final int og;HK(O A,this.ng,this.og):super(A){assert(0<=ng);assert(og==rF||ng<=og);}String toString(){var A=og==rF?'*':og;return '${super.toString()}[${ng}..${A}]';}bool iB(O A){return A is HK&&super.iB(A)&&ng==A.ng&&og==A.og;}}class UO extends HK{UO(O A,int B,int C):super(A,B,C);GB r(TB D){var B=D;var C=new List();while(C.length<ng){var A=eg.r(B);if(A.hE){return A;}C.add(A.value);B=A;}while(og==rF||C.length<og){var A=eg.r(B);if(A.hE){return B.PC(C);}C.add(A.value);B=A;}return B.PC(C);}}class OE{final value;final buffer;final int start;final int stop;const OE(this.value,this.buffer,this.start,this.stop);int get length=>stop-start;int get jB=>OE.MK(buffer,start)[0];int get DB=>OE.MK(buffer,start)[1];String toString()=>'Token[${bO(buffer,start)}]: ${value}';bool operator==(A){return A is OE&&value==A.value&&start==A.start&&stop==A.stop;}int get hashCode=>value.hashCode+start.hashCode+stop.hashCode;static O FW()=>GW;static final O GW=h('\n')|(h('\r')&h('\n').FD());static List<int> MK(String G,int A){var B=1,C=0;for(var D in FW().oB().Va(G)){if(A<D.stop){return [B,A-C+1];}B++ ;C=D.stop;}return [B,A-C+1];}static String bO(A,int B){if(A is String){var C=OE.MK(A,B);return '${C[0]}:${C[1]}';}else{return '${B}';}}}class xO extends hK implements DF{xO(String A,{Duration pollingDelay}):super(A,(){return new yO(A,pollingDelay!=null?pollingDelay:new Duration(seconds:1));});}class yO implements DF,iK{final String path;Stream<CC> get mI=>pg.stream;final pg=new StreamController<CC>.broadcast();Future get SM=>qg.future;final qg=new Completer();Timer rg;DateTime sg;yO(this.path,Duration A){rg=new Timer.periodic(A,(B)=>tg());tg();}Future tg()async{var B=await new File(path).exists();if(pg.isClosed)return;if(sg!=null&&!B){pg.add(new CC(tC.AP,path));close();return;}var A;try {try {A=await eW(path);}finally {if(pg.isClosed)return;}}on FileSystemException catch (C,D){pg.addError(C,D);close();return;}if(sg==A)return;if(sg==null){sg=A;qg.complete();}else{sg=A;pg.add(new CC(tC.eH,path));}}void close(){rg.cancel();pg.close();}}class JN<b> extends Object with ListMixin<b> implements Queue<b>{static const int KN=8;List<b> ug;int vg;int wg;JN([int A]):vg=0,wg=0{if(A==null||A<KN){A=KN;}else if(!LN(A)){A=MN(A);}assert(LN(A));ug=new List<b>(A);}void add(b A){xg(A);}void addAll(Iterable<b> G){if(G is List){var B=G;int A=B.length;int C=this.length;if(C+A>=ug.length){yg(C+A);ug.setRange(C,C+A,B,0);wg+= A;}else{int D=ug.length-wg;if(A<D){ug.setRange(wg,wg+A,B,0);wg+= A;}else{int H=A-D;ug.setRange(wg,wg+D,B,0);ug.setRange(0,H,B,D);wg=H;}}}else{for(b J in G)xg(J);}}String toString()=>IterableBase.iterableToFullString(this,"{","}");void addLast(b A){xg(A);}void addFirst(b A){vg=(vg-1)&(ug.length-1);ug[vg]=A;if(vg==wg)zg();}b removeFirst(){if(vg==wg)throw new StateError("No element");b A=ug[vg];ug[vg]=null;vg=(vg+1)&(ug.length-1);return A;}b removeLast(){if(vg==wg)throw new StateError("No element");wg=(wg-1)&(ug.length-1);b A=ug[wg];ug[wg]=null;return A;}int get length=>(wg-vg)&(ug.length-1);void set length(int A){if(A<0)throw new RangeError("Length ${A} may not be negative.");int C=A-length;if(C>=0){if(ug.length<=A){yg(A);}wg=(wg+C)&(ug.length-1);return;}int B=wg+C;if(B>=0){ug.fillRange(B,wg,null);}else{B+= ug.length;ug.fillRange(0,wg,null);ug.fillRange(B,ug.length,null);}wg=B;}b operator[](int A){if(A<0||A>=length){throw new RangeError("Index ${A} must be in the range [0..${length}).");}return ug[(vg+A)&(ug.length-1)];}void operator[]=(int A,b B){if(A<0||A>=length){throw new RangeError("Index ${A} must be in the range [0..${length}).");}ug[(vg+A)&(ug.length-1)]=B;}static bool LN(int A)=>(A&(A-1))==0;static int MN(int A){assert(A>0);A=(A<<1)-1;for(;;){int B=A&(A-1);if(B==0)return A;A=B;}}void xg(b A){ug[wg]=A;wg=(wg+1)&(ug.length-1);if(vg==wg)zg();}void zg(){List<b> A=new List<b>(ug.length*2);int B=ug.length-vg;A.setRange(0,B,ug,vg);A.setRange(B,B+vg,ug,0);vg=0;wg=ug.length;ug=A;}int Ah(List<b> A){assert(A.length>=length);if(vg<=wg){int C=wg-vg;A.setRange(0,C,ug,vg);return C;}else{int B=ug.length-vg;A.setRange(0,B,ug,vg);A.setRange(B,B+wg,ug,0);return wg+B;}}void yg(int A){assert(A>=length);A+= A>>1;int C=MN(A);List<b> B=new List<b>(C);wg=Ah(B);ug=B;vg=0;}}abstract class BF<aB,BB> implements Map<aB,BB>{factory BF()=>new ZH();}class ZH<aB,BB> implements BF<aB,BB>{final Map<aB,BB> Bh;final Map<BB,aB> Ch;BF<BB,aB> Dh;ZH():this.Sb(new HashMap(),new HashMap());ZH.Sb(this.Bh,this.Ch);BB operator[](Object A)=>Bh[A];void operator[]=(aB A,BB B){Eh(A,B,false);}void replace(aB A,BB B){Eh(A,B,true);}void addAll(Map<aB,BB> A)=>A.forEach((B,C)=>Eh(B,C,false));bool containsKey(Object A)=>Bh.containsKey(A);bool containsValue(Object A)=>Ch.containsKey(A);void forEach(void A(aB key,BB value))=>Bh.forEach(A);bool get isEmpty=>Bh.isEmpty;bool get isNotEmpty=>Bh.isNotEmpty;Iterable<aB> get keys=>Bh.keys;int get length=>Bh.length;Iterable<BB> get values=>Ch.keys;BF<BB,aB> get Na{if(Dh==null){Dh=new ZH.Sb(Ch,Bh);}return Dh;}BB putIfAbsent(aB A,BB C()){var B=Bh[A];if(B!=null)return B;if(!Bh.containsKey(A))return Eh(A,C(),false);return null;}BB remove(Object A){Ch.remove(Bh[A]);return Bh.remove(A);}void clear(){Bh.clear();Ch.clear();}BB Eh(aB B,BB A,bool D){if(B==null)throw new ArgumentError("null key");if(A==null)throw new ArgumentError("null value");var C=Bh[B];if(C==A)return A;if(Ch.containsKey(A)){if(!D)throw new ArgumentError("Mapping for ${A} exists");Bh.remove(Ch[A]);}Ch.remove(C);Bh[B]=A;Ch[A]=B;return A;}}Iterable NW(Iterable<Iterable> A)=>A.expand((B)=>B);typedef iK cW();abstract class hK implements jK{final cW Fh;final String path;Stream<CC> get mI=>Gh.stream;StreamController<CC> Gh;Future get SM=>Hh.future;var Hh=new Completer();hK(this.path,this.Fh){var A;var B;Gh=new StreamController<CC>.broadcast(onListen:(){A=Fh();B=A.mI.listen(Gh.add,onError:Gh.addError,onDone:Gh.close);A.SM.then(Hh.complete);},onCancel:(){B.cancel();A.close();Hh=new Completer();},sync:true);}}abstract class iK implements jK{}abstract class JB implements Comparable<JB>{factory JB(JC A,JC B,String C)=>new VK(A,B,C);}class VK extends lO{final JC start;final JC end;final String pE;VK(this.start,this.end,this.pE){if(end.m!=start.m){throw new ArgumentError("Source URLs \"${start.m}\" and " " \"${end.m}\" don't match.");}else if(end.offset<start.offset){throw new ArgumentError('End ${end} must come after start ${start}.');}else if(pE.length!=start.WR(end)){throw new ArgumentError('Text "${pE}" must be ${start.WR(end)} ' 'characters long.');}}}class kO implements Exception{String get message=>Ih;final String Ih;JB get N=>Jh;final JB Jh;kO(this.Ih,this.Jh);String toString({color}){if(N==null)return message;return "Error on "+N.message(message,color:color);}}class WK extends kO implements FormatException{dynamic get source=>Kh;final Kh;int get offset=>N==null?null:N.start.offset;WK(String A,JB B,[this.Kh]):super(A,B);}abstract class lO implements JB{Uri get m=>start.m;int get length=>end.offset-start.offset;int compareTo(JB A){var B=start.compareTo(A.start);return B==0?end.compareTo(A.end):B;}String message(String K,{color}){if(color==true)color=OW;if(color==false)color=null;var L=start.jB;var B=start.DB;var A=new StringBuffer();A.write('line ${L+1}, column ${B+1}');if(m!=null)A.write(' of ${vV(m)}');A.write(': ${K}');if(length==0&&this is!aH)return A.toString();A.write("\n");var C;if(this is aH){var D=(this as aH).context;var G=RW(D,pE,B);if(G!=null&&G>0){A.write(D.substring(0,G));D=D.substring(G);}var J=D.indexOf('\n');C=J==-1?D:D.substring(0,J+1);B=rE.min(B,C.length);}else{C=pE.split("\n").first;B=0;}var H=rE.min(B+end.offset-start.offset,C.length);if(color!=null){A.write(C.substring(0,B));A.write(color);A.write(C.substring(B,H));A.write(jO);A.write(C.substring(H));}else{A.write(C);}if(!C.endsWith('\n'))A.write('\n');A.write(' '*B);if(color!=null)A.write(color);A.write('^'*rE.max(H-B,1));if(color!=null)A.write(jO);return A.toString();}bool operator==(A)=>A is JB&&start==A.start&&end==A.end;int get hashCode=>start.hashCode+(31*end.hashCode);String toString()=>'<${runtimeType}: from ${start} to ${end} "${pE}">';}class CF extends YK implements SW{final QE Lh;int get jB=>Lh.qI(position);int get DB=>Lh.FM(position);tD get state=>new oO(this,position);FB Mh;sD get location=>Lh.location(position);FB get tB=>location.mB();CF(String A,{sourceUrl,int position}):Lh=new QE(A,url:sourceUrl),super(A,sourceUrl:sourceUrl,position:position);factory CF.pb(String string,{sourceUrl,int position})=XK;FB nB(tD B,[tD A]){var C=A==null?position:A.position;return Lh.N(B.position,C);}bool BE(Pattern A){if(!super.BE(A)){Mh=null;return false;}Mh=Lh.N(position,aF.end);return true;}void error(String A,{Match match,int position,int length}){pO(string,match,position,length);if(match==null&&position==null&&length==null)match=aF;if(position==null){position=match==null?this.position:match.start;}if(length==null)length=match==null?1:match.end-match.start;var B=Lh.N(position,position+length);throw new bH(A,B,string);}}class oO implements tD{final CF Nh;final int position;int get jB=>Nh.Lh.qI(position);int get DB=>Nh.Lh.FM(position);oO(this.Nh,this.position);}class aH extends VK{}typedef DateTime dW(String _0);dW zO;Future<DateTime> eW(String A){if(zO!=null){return new Future.value(zO(A));}return FileStat.stat(A).then((B)=>B.modified);}final TW=new RegExp("/").pattern=="\\/";class YK{final Uri m;final String string;int get position=>Oh;set position(int A){if(A<0||A>string.length){throw new ArgumentError("Invalid position ${A}");}Oh=A;}int Oh=0;Match get aF=>Ph;Match Ph;bool get fD=>position==string.length;YK(this.string,{sourceUrl,int position}):m=sourceUrl is String?Uri.parse(sourceUrl):sourceUrl{if(position!=null)this.position=position;}int d(){if(fD)Qh("more input");return string.codeUnitAt(Oh++ );}int e([int A]){if(A==null)A=0;var B=position+A;if(B<0||B>=string.length)return null;return string.codeUnitAt(B);}bool QB(Pattern B){var A=BE(B);if(A)Oh=Ph.end;return A;}void nI(Pattern A,{String name}){if(QB(A))return;if(name==null){if(A is RegExp){var B=A.pattern;if(!TW)B=B.replaceAll("/","\\/");name="/${B}/";}else{name=A.toString().replaceAll("\\","\\\\").replaceAll('"','\\"');name='"${name}"';}}Qh(name);}bool BE(Pattern A){Ph=A.matchAsPrefix(string,position);return Ph!=null;}String substring(int B,[int A]){if(A==null)A=position;return string.substring(B,A);}void error(String A,{Match match,int position,int length}){pO(string,match,position,length);if(match==null&&position==null&&length==null)match=aF;if(position==null){position=match==null?this.position:match.start;}if(length==null)length=match==null?1:match.end-match.start;var B=new QE(string,url:m);var C=B.N(position,position+length);throw new bH(A,C,string);}void Qh(String A){error("expected ${A}.",position:this.position,length:0);}}sC vF(dynamic A)=>new sC(A);class sC{dynamic value;sC(this.value);int get yB{if(value is int){return value;}return 0;}String get KB{if(value is String){return value;}return "";}sC operator[](dynamic A){try {value=value[A];}catch (B){value=null;}return this;}sC elementAt(int B,[dynamic A]){try {value=value[B];}catch (C){value=null;}if(value==null&&A!=null){value=A;}return this;}sC last(){if(value is Iterable){value=value.last;}else{value=null;}return this;}sC da([int A=0]){if(value==null){value=A;}else{value=int.parse(value.toString(),onError:(B)=>A);}return this;}sC replaceAll(String A,String B){value=value.toString().replaceAll(A,B);return this;}sC split(String A){value=value.toString().split(A);return this;}sC trim(){value=value.toString().trim();return this;}}abstract class rO{static final int bK=VW();static final int UW=WW();static final Map<String,String> cH=Platform.environment;static final String sO=Platform.operatingSystem;static dynamic tO(){throw new UnsupportedError("Unsupported operating system.");}static int VW(){switch (sO){case "android":case "linux":if(UW==64){return 64;}var A=<String>[] ;var B=aK("/etc/ld.so.conf");if(B!=null){qO(B,A,new Set<String>());}A.add("/lib");A.add("/lib64");for(var B in A){var G=NH.BO(YB(B,"libc.so.*"));for(var C in G){C=aK(C);if(C==null){continue;}var D=new File(C);if(D.existsSync()){var H=vF(ZK("file",["-b",D.path])).trim().KB;if(H.startsWith("ELF 64-bit")){return 64;}}}}return 32;case "macos":if(vF(ZK("uname",["-m"])).trim().KB=="x86_64"){return 64;}return 32;case "windows":var J=vF(cH["PROCESSOR_ARCHITEW6432"]).KB;if(!J.isEmpty){return 64;}switch (cH["PROCESSOR_ARCHITECTURE"]){case "AMD64":case "IA64":return 64;}return 32;default:tO();}return null;}static int WW(){switch (sO){case "android":case "linux":return vF(ZK("getconf",["LONG_BIT"])).trim().da().yB;case "macos":if(Platform.version.contains("macos_ia32")){return 32;}else if(Platform.version.contains("macos_x64")){return 64;}else{return bK;}break;case "windows":var A=vF(cH["PROCESSOR_ARCHITEW6432"]).KB;if(!A.isEmpty){return 32;}switch (cH["PROCESSOR_ARCHITECTURE"]){case "AMD64":case "IA64":return 64;}return 32;default:tO();}return null;}}String ZK(String B,List<String> C,{bool runInShell: false}){try {var A=Process.runSync(B,C,runInShell:runInShell);if(A.exitCode==0){return A.stdout.toString();}}catch (D){}return null;}String aK(String A){while(true){if(!NH.UV(A,"link")){break;}try {A=new Link(A).resolveSymbolicLinksSync();}catch (B){return null;}}return A;}void qO(String B,List<String> D,Set<String> C){B=aK(B);if(B==null){return;}var G=new File(B);if(!G.existsSync()){return;}var K=NH.SV(B);for(var A in G.readAsLinesSync()){A=A.trim();var H=A.indexOf("#");if(H!=-1){A=A.substring(0,H);}if(A.isEmpty){continue;}var J=false;if(A.startsWith("include ")){A=A.substring(8);J=true;}if(tV(A)){A=YB(K,A);}if(J){for(var B in NH.BO(A)){if(!C.contains(B)){C.add(B);qO(B,D,C);}}}else{D.add(A);}}}class uO extends fO{uO():super(new bW());}class XW{String encode(Map<String,dynamic> B){var A=new ZW();A.CM(B,name:[] );return A.toString();}}abstract class YW{}typedef void cK<BB>(BB _0);class ZW{static final RegExp aW=new RegExp(r'^[A-Za-z0-9_-]+$');final StringBuffer Rh=new StringBuffer();void IM(){if(Rh.isNotEmpty)Rh.writeln();}void La(List<String> B,{bool array: false}){if(B.isNotEmpty){IM();IM();Rh.write(array?'[[':'[');for(int A=0;A<B.length;A++ ){if(A!=0)Rh.write('.');eR(B[A]);}Rh.write(array?']]':']');}}gM(A){while(A is YW)A=A.mb();return A;}void CM(Map<String,dynamic> H,{List<String> name,bool array: false}){var C={};var D={};H.forEach((B,A){A=gM(A);if(A is Map){D[B]=A;return;}if(A is Iterable&&A.length>0){A=A.map(gM);if(A.every((G)=>G is Map)){D[B]=A;return;}}C[B]=A;});if(array||C.isNotEmpty){La(name,array:array);C.forEach(Ma);}D.forEach((B,A){name.add(B);if(A is Map){CM(A,name:name);}else if(A is Iterable){A.forEach((G){CM(G,name:name,array:true);});}name.removeLast();});}void Ma(String A,B){IM();eR(A);Rh.write(' = ');fR(B);}void eR(String A){if(aW.hasMatch(A)){Rh.write(A);}else{dR(A);}}void fR(A){A=gM(A);cK B=Ha(A);if(B==null)throw new fK(A);B(A);}cK Ha(A){if(A is num)return tZ;if(A is bool)return oZ;if(A is DateTime)return pZ;if(A is String)return uZ;if(A is Iterable)return nZ;return null;}void tZ(num A){Rh.write('${A}');}void oZ(bool A){Rh.write(A?'true':'false');}void pZ(DateTime A){Rh.write(A.toIso8601String());}Type ta(Iterable B){if(B.isEmpty)return null;if(identical(1,1.0)&&B.every((A)=>A is num)&&B.any((A)=>A is int)&&B.any((A)=>A is!int)){return num;}return B.map((A)=>A.runtimeType).reduce((C,D){if(C!=D)throw new gK(B);return C;});}void nZ(Iterable B){var D=ta(B);Rh.write('[');for(var A=0;A<B.length;A++ ){var C=B.elementAt(A);if(A!=0)Rh.write(', ');fR(C);if(D==num&&C is int)Rh.write('.0');}Rh.write(']');}cK<String> Ga(String A){var C=[SC.dC['"'],SC.dC['\\']];bool B(String D)=>SC.dC.values.where((G)=>!C.contains(G)).any(D.codeUnits.contains);if(A.contains('\n')||A.contains('\r')){if(A.split(new RegExp('\n|\r')).any(B)){return rZ;}return sZ;}if(A.contains("'")||B(A)){return dR;}return qZ;}void uZ(String A){var B=Ga(A);B(A);}void Sh(String A,{String quotes,Iterable<int> esc: const[] ,bool multiline: false}){if(esc.isNotEmpty){A=A.codeUnits.map((int B){if(esc.contains(B)){return '\\${SC.dC.Na[B]}';}return new String.fromCharCode(B);}).join();}if(multiline){if(quotes=='"""')A=A.replaceAll('"""',r'\"\"\"');}else if(A.contains('\n')||A.contains('\r')){throw new dH('Newlines are only allowed in multi-line strings!');}if(!esc.contains(quotes.codeUnitAt(0))&&A.contains(quotes)){throw new dH('"${quotes}" are prohibited in non-basic strings.');}Rh.write(quotes);if(multiline)Rh.writeln();Rh.write(A);Rh.write(quotes);}void dR(String A)=>Sh(A,quotes:'"',esc:SC.dC.values);void rZ(String B)=>Sh(B,quotes:'"""',esc:SC.dC.values.where((A)=>A!=SC.dC['"']&&A!=SC.dC['n']&&A!=SC.dC['r']),multiline:true);void qZ(String A)=>Sh(A,quotes:"'");void sZ(String A)=>Sh(A,quotes:"'''",multiline:true);String toString()=>Rh.toString();}class dK{final String dG;dK(this.dG);bool operator==(A)=>A is dK&&A.dG==dG;int get hashCode=>dG.hashCode;String toString()=>'The escape sequence "${dG}" is invalid!';}class dH{final String hG;dH(this.hG);bool operator==(A)=>A is dH&&A.hG==hG;int get hashCode=>hG.hashCode;String toString()=>hG;}class wF{final String name;wF(this.name);bool operator==(A)=>A is wF&&A.name==name;int get hashCode=>name.hashCode;String toString()=>'Cannot redefine "${name}"!';}class eK{final String name;eK(this.name);bool operator==(A)=>A is eK&&A.name==name;int get hashCode=>name.hashCode;String toString()=>'Cannot define table "${name}"! Parent must be a table!';}class fK{final value;fK(this.value);bool operator==(A)=>A is fK&&A.value==value;int get hashCode=>value.hashCode;String toString()=>'"${value}" cannot be encoded as a TOMl value!';}class gK{final Iterable X;gK(this.X);bool operator==(A)=>A is gK&&A.X==X;int get hashCode=>X.hashCode;String toString()=>'The items of "${X}" must all be of the same type!';}class SC extends NK{static final BF<String,int> dC=new BF()..addAll({'b':0x08,'t':0x09,'n':0x0A,'f':0x0C,'r':0x0D,'"':0x22,r'\':0x5C});start()=>Q(BM).end();oB(A,[bool C=false,bool B]){if(B==null)B=C;if(A is Function)A=Q(A);var D=Q(AE,C);var G=Q(AE,B);return A.EM().trim(D,G);}AE([bool A=false])=>A?Q(AE)|Q(iG):Q(iM)|Q(hZ);iM()=>h(' ')|h('\t');iG()=>h('\n')|h('\r')&h('\n');hZ()=>h('#')&Q(iG).KS().HD();value()=>Q(jI)|Q(oI)|Q(tI)|Q(fI)|Q(jS)|Q(X)|Q(sI);O Th({O quotes,O esc,bool multiline: false}){var A=quotes;if(multiline)A=(A&Q(ZR).FD()).iD(0);var C=quotes;if(!multiline)C|= Q(iG);var B=C.KS();if(esc!=null)B=esc|B;return (A&B.HD()&quotes).trim(Q(AE)).iD(1).map((List D)=>D.join());}jS()=>Q(Xa)|Q(LR)|Q(Za)|Q(Sa);LR()=>Th(quotes:h('"'),esc:Q(lI));lI()=>h('\\')&(Q(fM)|Q(ZM));fM()=>h('u')&Q(qR).GJ(4).EM()|h('U')&Q(qR).GJ(8).EM();ZM()=>rD();qR()=>gO('0-9a-fA-F');Xa()=>Th(quotes:sF('"""'),esc:Q(Ya),multiline:true);Ya()=>Q(jM)|Q(lI);jM()=>h('\\')&Q(ZR).vI()&Q(iM).HD();ZR()=>Q(iM).HD()&Q(iG);Sa()=>Th(quotes:sF("'"));Za()=>Th(quotes:sF("'''"),multiline:true);tI()=>Q(oB,Uh);Uh()=>KK('+-').FD()&(h('0')|Q(TR));TR()=>YH().vI().lG(h('_'));oI()=>Q(oB,Vh);Vh()=>Q(Uh)&(Q(wZ)&Q(gR).FD()|Q(gR));wZ()=>h('.')&Q(TR);gR()=>KK('eE')&Q(Uh);fI()=>Q(oB,Wh);Wh()=>sF('true')|sF('false');jI()=>Q(oB,Xh);Xh()=>Q(zZ)&h('T')&Q(Aa);zZ()=>Q(jZ)&h('-')&Q(eE)&h('-')&Q(eE);Aa()=>Q(ea)&Q(pa);ea()=>Q(eE)&h(':')&Q(eE)&h(':')&Q(eE)&(h('.')&YH().xI(1,6)).FD();pa()=>h('Z')|Q(oa);oa()=>KK('+-')&Q(eE)&h(':')&Q(eE);eE()=>YH().GJ(2);jZ()=>YH().GJ(4);X()=>dD(jI)|dD(oI)|dD(tI)|dD(fI)|dD(jS)|dD(X)|dD(sI);dD(A)=>Q(oB,h('['),false,true)&Q(A).lG(Q(oB,h(','),true),optionalSeparatorAtEnd:true,includeSeparators:false).FD([] )&Q(oB,h(']'),true,false);cM()=>Q(EJ).trim(Q(AE,true))&Q(LM);EJ()=>h('[')&Q(ma)&h(']');dM()=>Q(eM).trim(Q(AE,true))&Q(LM);eM()=>h('[')&Q(EJ)&h(']');sI()=>Q(oB,h('{'))&Q(uI).lG(oB(h(',')),optionalSeparatorAtEnd:false,includeSeparators:false).FD([] )&Q(oB,h('}'));key()=>Q(oB,eZ)|Q(ia);eZ()=>gO('A-Za-z0-9_-').vI();ia()=>Q(LR);ma()=>Q(key).lG(h('.'),includeSeparators:false);uI()=>Q(key)&h('=')&Q(value);LM()=>Q(uI).lG(Q(iG)&Q(AE,true).HD(),includeSeparators:false,optionalSeparatorAtEnd:true).FD([] );BM()=>Q(AE,true).HD()&Q(LM)&(Q(cM)|Q(dM)).HD();}class bW extends SC{lI()=>super.lI().iD(1);ZM()=>super.ZM().map((String A){if(SC.dC.containsKey(A)){return new String.fromCharCode(SC.dC[A]);}throw new dK('\\${A}');});fM()=>super.fM().iD(1).map((A)=>new String.fromCharCode(int.parse(A,radix:16)));jM()=>super.jM().map((A)=>'');tI()=>super.tI().map((A)=>int.parse(A.replaceAll('_','')));oI()=>super.oI().map((A)=>double.parse(A.replaceAll('_','')));fI()=>super.fI().map((A)=>A=='true');jI()=>super.jI().map(DateTime.parse);dD(A)=>super.dD(A).iD(1);cM()=>super.cM().map((List A)=>{'type':'table','parent':A[0].sublist(0,A[0].length-1),'name':A[0].last,'pairs':A[1]});EJ()=>super.EJ().iD(1);dM()=>super.dM().map((List A)=>{'type':'table-array','parent':A[0].sublist(0,A[0].length-1),'name':A[0].last,'pairs':A[1]});eM()=>super.eM().iD(1);sI()=>super.sI().iD(1).map((List C){var A={};C.forEach((Map B){A[B['key']]=B['value'];});return A;});uI()=>super.uI().fa([0,2]).map((List A)=>{'key':A[0],'value':A[1]});BM()=>super.BM().map((List f){var J={};var p=new Set();void K(String A){if(p.contains(A))throw new wF(A);p.add(A);}Function XB(Map vB,[String GC])=>(Map G){var A=GC==null?G['key']:'${GC}.${G['key']}';K(A);if(vB.containsKey(G['key']))throw new wF(A);vB[G['key']]=G['value'];};f[1].forEach(XB(J));f[2].forEach((Map C){var B=J;var A=[] ;C['parent'].forEach((String H){B=B.putIfAbsent(H,()=>{});if(B is List){H='${H}[${B.length-1}]';B=B.last;}A.add(H);if(B is!Map)throw new eK(A.join('.'));});A.add(C['name']);A=A.join('.');var L;if(C['type']=='table-array'){var S=B.putIfAbsent(C['name'],(){K(A);return [] ;});if(S is Map)throw new wF(A);var ID=S.length;S.add(L={});A='${A}[${ID}]';}else{L=B.putIfAbsent(C['name'],()=>{});}K(A);C['pairs'].forEach(XB(L,A));});W(D){if(D is Map){return new UnmodifiableMapView(new Map.fromIterables(D.keys,D.values.map(W)));}if(D is List){return new UnmodifiableListView(D.map(W));}return D;}return W(J);});}abstract class mT<aB,BB> implements Map<aB,BB>{static jF(){throw new UnsupportedError("Cannot modify an unmodifiable Map");}void operator[]=(aB A,BB B)=>jF();BB putIfAbsent(aB A,BB B())=>jF();void addAll(Map<aB,BB> A)=>jF();BB remove(Object A)=>jF();void clear()=>jF();}int RW(String B,String C,int D){var J=C=='';var A=B.indexOf(C);while(A!=-1){var G=B.lastIndexOf('\n',A)+1;var H=A-G;if(D==H||(J&&D==H+1)){return G;}A=B.indexOf(C,A+1);}return null;}void pO(String C,Match D,int A,int B){if(D!=null&&(A!=null||B!=null)){throw new ArgumentError("Can't pass both match and position/length.");}if(A!=null){if(A<0){throw new RangeError("position must be greater than or equal to 0.");}else if(A>C.length){throw new RangeError("position must be less than or equal to the " "string length.");}}if(B!=null&&B<0){throw new RangeError("length must be greater than or equal to 0.");}if(A!=null&&B!=null&&A+B>C.length){throw new RangeError("position plus length must not go beyond the end of " "the string.");}}class fW<dB> implements StreamTransformer<dB,List<dB>>{Stream<List<dB>> bind(Stream<dB> C){var A=new Queue<dB>();return new StreamTransformer<dB,List<dB>>.fromHandlers(handleData:(D,B){A.add(D);Timer.run((){if(A.isEmpty)return;B.add(A.toList());A.clear();});},handleDone:(B){if(A.isNotEmpty){B.add(A.toList());A.clear();}B.close();}).bind(C);}}class CC{final tC type;final String path;CC(this.type,this.path);String toString()=>"${type} ${path}";}class tC{static const AP=const tC("remove");static const eH=const tC("modify");final String Yh;const tC(this.Yh);String toString()=>Yh;}abstract class jK{}dX(String A,{sourceUrl})=>eX(A,sourceUrl:sourceUrl).value;NB eX(String A,{sourceUrl})=>fX(A,sourceUrl:sourceUrl).wL;IF fX(String D,{sourceUrl}){var A=new JP(D,sourceUrl:sourceUrl);var B=A.load();if(B==null){return new IF.Zb(new UB.db(null,A.N),A.N,null,const[] );}var C=A.load();if(C!=null){throw new g("Only expected one document.",C.N);}return B;}Map gW()=>new HashMap(equals:hW,hashCode:BP);bool hW(A,B)=>new iW().ED(A,B);class iW{final Zh=[] ;final ah=[] ;bool ED(A,B){if(A is UB)A=A.value;if(B is UB)B=B.value;for(var C=0;C<Zh.length;C++ ){var D=identical(A,Zh[C]);var G=identical(B,ah[C]);if(D&&G)return true;if(D||G)return false;}Zh.add(A);ah.add(B);try {if(A is List&&B is List){return bh(A,B);}else if(A is Map&&B is Map){return ch(A,B);}else if(A is num&&B is num){return dh(A,B);}else{return A==B;}}finally {Zh.removeLast();ah.removeLast();}}bool bh(List B,List C){if(B.length!=C.length)return false;for(var A=0;A<B.length;A++ ){if(!ED(B[A],C[A]))return false;}return true;}bool ch(Map A,Map B){if(A.length!=B.length)return false;for(var C in A.keys){if(!B.containsKey(C))return false;if(!ED(A[C],B[C]))return false;}return true;}bool dh(num A,num B){if(A.isNaN&&B.isNaN)return true;return A==B;}}int BP(G){var B=[] ;C(A){if(B.any((H)=>identical(H,A)))return -1;B.add(A);try {if(A is Map){var D=const IN();return D.hash(A.keys.map(C))^D.hash(A.values.map(C));}else if(A is Iterable){return const GN().hash(A.map(BP));}else if(A is UB){return A.value.hashCode;}else{return A.hashCode;}}finally {B.removeLast();}}return C(G);}class q{final k type;final FB N;q(this.type,this.N);String toString()=>type.toString();}class fH implements q{get type=>k.jW;final FB N;final EG versionDirective;final List<UC> FJ;final bool isImplicit;fH(this.N,{this.versionDirective,List<UC> tagDirectives,this.isImplicit: true}):FJ=tagDirectives==null?[] :tagDirectives;String toString()=>"DOCUMENT_START";}class gH implements q{get type=>k.EP;final FB N;final bool isImplicit;gH(this.N,{this.isImplicit: true});String toString()=>"DOCUMENT_END";}class kK implements q{get type=>k.FP;final FB N;final String name;kK(this.N,this.name);String toString()=>"ALIAS ${name}";}abstract class lK implements q{String get anchor;String get tag;String toString(){var A=new StringBuffer('${type}');if(anchor!=null)A.write(" &${anchor}");if(tag!=null)A.write(" ${tag}");return A.toString();}}class TC extends lK{get type=>k.GP;final FB N;final String anchor;final String tag;final String value;final ZB Z;TC(this.N,this.value,this.Z,{this.anchor,this.tag});String toString()=>"${super.toString()} \"${value}\"";}class xF extends lK{get type=>k.HP;final FB N;final String anchor;final String tag;final KC Z;xF(this.N,this.Z,{this.anchor,this.tag});}class yF extends lK{get type=>k.IP;final FB N;final String anchor;final String tag;final KC Z;yF(this.N,this.Z,{this.anchor,this.tag});}class k{static const CP=const k.Vb("STREAM_START");static const DP=const k.Vb("STREAM_END");static const jW=const k.Vb("DOCUMENT_START");static const EP=const k.Vb("DOCUMENT_END");static const FP=const k.Vb("ALIAS");static const GP=const k.Vb("SCALAR");static const HP=const k.Vb("SEQUENCE_START");static const hH=const k.Vb("SEQUENCE_END");static const IP=const k.Vb("MAPPING_START");static const iH=const k.Vb("MAPPING_END");final String name;const k.Vb(this.name);String toString()=>name;}class g extends WK{g(String A,JB B):super(A,B);}class JP{final mK eh;final fh=new Map<String,NB>();FB get N=>gh;FB gh;JP(String B,{sourceUrl}):eh=new mK(B,sourceUrl:sourceUrl){var A=eh.kB();gh=A.N;assert(A.type==k.CP);}IF load(){if(eh.fD)return null;var A=eh.kB();if(A.type==k.DP){gh=gh.expand(A.N);return null;}var B=hh(A);gh=gh.expand(B.N);fh.clear();return B;}IF hh(fH A){var C=ih(eh.kB());var B=eh.kB() as gH;assert(B.type==k.EP);return new IF.Zb(C,A.N.expand(B.N),A.versionDirective,A.FJ,startImplicit:A.isImplicit,endImplicit:B.isImplicit);}NB ih(q A){switch (A.type){case k.FP:return jh(A);case k.GP:return kh(A);case k.HP:return lh(A);case k.IP:return mh(A);default:throw "Unreachable";}}void nh(String A,NB B){if(A==null)return;fh[A]=B;}NB jh(kK A){var B=fh[A.name];if(B!=null)return B;throw new g("Undefined alias.",A.N);}NB kh(TC A){var B;if(A.tag=="!"){B=new UB.cb(A.value,A);}else if(A.tag!=null){B=oh(A);}else{B=ph(A);}nh(A.anchor,B);return B;}NB lh(xF A){if(A.tag!="!"&&A.tag!=null&&A.tag!="tag:yaml.org,2002:seq"){throw new g("Invalid tag for sequence.",A.N);}var D=<NB>[] ;var C=new lP.bb(D,A.N,A.Z);nh(A.anchor,C);var B=eh.kB();while(B.type!=k.hH){D.add(ih(B));B=eh.kB();}mP(C,A.N.expand(B.N));return C;}NB mh(yF A){if(A.tag!="!"&&A.tag!=null&&A.tag!="tag:yaml.org,2002:map"){throw new g("Invalid tag for mapping.",A.N);}var D=gW();var C=new kP.ab(D,A.N,A.Z);nh(A.anchor,C);var B=eh.kB();while(B.type!=k.iH){var G=ih(B);var H=ih(eh.kB());D[G]=H;B=eh.kB();}mP(C,A.N.expand(B.N));return C;}UB oh(TC A){switch (A.tag){case "tag:yaml.org,2002:null":var B=qh(A);if(B!=null)return B;throw new g("Invalid null scalar.",A.N);case "tag:yaml.org,2002:bool":var B=rh(A);if(B!=null)return B;throw new g("Invalid bool scalar.",A.N);case "tag:yaml.org,2002:int":var B=sh(A,allowFloat:false);if(B!=null)return B;throw new g("Invalid int scalar.",A.N);case "tag:yaml.org,2002:float":var B=sh(A,allowInt:false);if(B!=null)return B;throw new g("Invalid float scalar.",A.N);case "tag:yaml.org,2002:str":return new UB.cb(A.value,A);default:throw new g('Undefined tag: ${A.tag}.',A.N);}}UB ph(TC A)=>th(A)??new UB.cb(A.value,A);UB th(TC A){var B=A.value.length;if(B==0)return new UB.cb(null,A);var C=A.value.codeUnitAt(0);switch (C){case yG:case QJ:case RJ:return sh(A);case hT:case eT:return B==4?qh(A):null;case jT:case fT:return B==4?rh(A):null;case gT:case dT:return B==5?rh(A):null;case lT:return B==1?new UB.cb(null,A):null;default:if(C>=uE&&C<=zG)return sh(A);return null;}}UB qh(TC A){switch (A.value){case "":case "null":case "Null":case "NULL":case "~":return new UB.cb(null,A);default:return null;}}UB rh(TC A){switch (A.value){case "true":case "True":case "TRUE":return new UB.cb(true,A);case "false":case "False":case "FALSE":return new UB.cb(false,A);default:return null;}}NB sh(TC A,{bool allowInt: true,bool allowFloat: true}){var B=uh(A.value,allowInt:allowInt,allowFloat:allowFloat);return B==null?null:new UB.cb(B,A);}num uh(String A,{bool allowInt: true,bool allowFloat: true}){assert(allowInt||allowFloat);var B=A.codeUnitAt(0);var G=A.length;if(allowInt&&G==1){var H=B-uE;return H>=0&&H<=9?H:null;}var C=A.codeUnitAt(1);if(allowInt&&B==uE){if(C==kT)return int.parse(A,onError:(D)=>null);if(C==iT){var K=A.substring(2);return int.parse(K,radix:8,onError:(D)=>null);}}if((B>=uE&&B<=zG)||((B==QJ||B==RJ)&&C>=uE&&C<=zG)){var J=null;if(allowInt){J=int.parse(A,radix:10,onError:(D)=>null);}if(allowFloat)J??= double.parse(A,(D)=>null);return J;}if(!allowFloat)return null;if((B==yG&&C>=uE&&C<=zG)||(B==RJ||B==QJ)&&C==yG){if(G==5){switch (A){case "+.inf":case "+.Inf":case "+.INF":return double.INFINITY;case "-.inf":case "-.Inf":case "-.INF":return -double.INFINITY;}}return double.parse(A,(D)=>null);}if(G==4&&B==yG){switch (A){case ".inf":case ".Inf":case ".INF":return double.INFINITY;case ".nan":case ".NaN":case ".NAN":return double.NAN;}}return null;}}class mK{final uK vh;final wh=new List<R>();var xh=R.KP;final yh=new Map<String,UC>();bool get fD=>xh==R.UP;mK(String A,{sourceUrl}):vh=new uK(A,sourceUrl:sourceUrl);q kB(){try {if(fD)throw new StateError("No more events.");var B=zh();return B;}on bH catch (A){throw new g(A.message,A.N);}}q zh(){switch (xh){case R.KP:return Ai();case R.nK:return Bi();case R.LP:return Ci();case R.oK:return Di();case R.MP:return Ei(block:true);case R.kW:return Ei(block:true,indentlessSequence:true);case R.lW:return Ei();case R.NP:vh.QB();return Fi();case R.pK:return Fi();case R.jH:return Gi();case R.OP:vh.QB();return Hi();case R.kH:return Hi();case R.lH:return Ii();case R.PP:return Ji(first:true);case R.qK:return Ji();case R.QP:return Ki();case R.rK:return Li();case R.sK:return Mi();case R.RP:return Ni(first:true);case R.mH:return Ni();case R.tK:return Oi();case R.TP:return Oi(empty:true);default:throw "Unreachable";}}q Ai(){var A=vh.QB();assert(A.type==M.eP);xh=R.nK;return new q(k.CP,A.N);}q Bi(){var A=vh.lB();while(A.type==M.CI){A=vh.MC();}if(A.type!=M.zH&&A.type!=M.AI&&A.type!=M.BI&&A.type!=M.CG){Pi();wh.add(R.oK);xh=R.MP;return new fH(A.N.start.mB());}if(A.type==M.CG){xh=R.UP;vh.QB();return new q(k.DP,A.N);}var C=A.N;var B=Pi();var D=B.first;var G=B.last;A=vh.lB();if(A.type!=M.BI){throw new g("Expected document start.",A.N);}wh.add(R.oK);xh=R.LP;vh.QB();return new fH(C.expand(A.N),versionDirective:D,tagDirectives:G,isImplicit:false);}q Ci(){var A=vh.lB();switch (A.type){case M.zH:case M.AI:case M.BI:case M.CI:case M.CG:xh=wh.removeLast();return Qi(A.N.start);default:return Ei(block:true);}}q Di(){yh.clear();xh=R.nK;var A=vh.lB();if(A.type==M.CI){vh.QB();return new gH(A.N,isImplicit:false);}else{return new gH(A.N.start.mB(),isImplicit:true);}}q Ei({bool block: false,bool indentlessSequence: false}){var A=vh.lB();if(A is JL){vh.QB();xh=wh.removeLast();return new kK(A.N,A.name);}var D;var G;var B=A.N.start.mB();H(A){D=A.name;B=B.expand(A.N);return vh.MC();}J(A){G=A;B=B.expand(A.N);return vh.MC();}if(A is xH){A=H(A);if(A is yH)A=J(A);}else if(A is yH){A=J(A);if(A is xH)A=H(A);}var C;if(G!=null){if(G.OC==null){C=G.DJ;}else{var K=yh[G.OC];if(K==null){throw new g("Undefined tag handle.",G.N);}C=K.mE+G.DJ;}}if(indentlessSequence&&A.type==M.HF){xh=R.jH;return new xF(B.expand(A.N),KC.FL,anchor:D,tag:C);}if(A is EF){if(C==null&&A.Z!=ZB.wH)C="!";xh=wh.removeLast();vh.QB();return new TC(B.expand(A.N),A.value,A.Z,anchor:D,tag:C);}if(A.type==M.gP){xh=R.PP;return new xF(B.expand(A.N),KC.GL,anchor:D,tag:C);}if(A.type==M.hP){xh=R.RP;return new yF(B.expand(A.N),KC.GL,anchor:D,tag:C);}if(block&&A.type==M.fP){xh=R.NP;return new xF(B.expand(A.N),KC.FL,anchor:D,tag:C);}if(block&&A.type==M.DI){xh=R.OP;return new yF(B.expand(A.N),KC.FL,anchor:D,tag:C);}if(D!=null||C!=null){xh=wh.removeLast();return new TC(B,'',ZB.wH,anchor:D,tag:C);}throw new g("Expected node content.",B);}q Fi(){var A=vh.lB();if(A.type==M.HF){A=vh.MC();if(A.type==M.HF||A.type==M.SE){xh=R.pK;return Qi(A.N.end);}else{wh.add(R.pK);return Ei(block:true);}}if(A.type==M.SE){vh.QB();xh=wh.removeLast();return new q(k.hH,A.N);}throw new g("While parsing a block collection, expected '-'.",A.N.start.mB());}q Gi(){var A=vh.lB();if(A.type!=M.HF){xh=wh.removeLast();return new q(k.hH,A.N.start.mB());}var B=A.N.start;A=vh.MC();if(A.type==M.HF||A.type==M.RD||A.type==M.xC||A.type==M.SE){xh=R.jH;return Qi(B);}else{wh.add(R.jH);return Ei(block:true);}}q Hi(){var A=vh.lB();if(A.type==M.RD){var B=A.N.start;A=vh.MC();if(A.type==M.RD||A.type==M.xC||A.type==M.SE){xh=R.lH;return Qi(B);}else{wh.add(R.lH);return Ei(block:true,indentlessSequence:true);}}if(A.type==M.xC){xh=R.lH;return Qi(A.N.start);}if(A.type==M.SE){vh.QB();xh=wh.removeLast();return new q(k.iH,A.N);}throw new g("Expected a key while parsing a block mapping.",A.N.start.mB());}q Ii(){var A=vh.lB();if(A.type!=M.xC){xh=R.kH;return Qi(A.N.start);}var B=A.N.start;A=vh.MC();if(A.type==M.RD||A.type==M.xC||A.type==M.SE){xh=R.kH;return Qi(B);}else{wh.add(R.kH);return Ei(block:true,indentlessSequence:true);}}q Ji({bool first: false}){if(first)vh.QB();var A=vh.lB();if(A.type!=M.FF){if(!first){if(A.type!=M.UE){throw new g("While parsing a flow sequence, expected ',' or ']'.",A.N.start.mB());}A=vh.MC();}if(A.type==M.RD){xh=R.QP;vh.QB();return new yF(A.N,KC.GL);}else if(A.type!=M.FF){wh.add(R.qK);return Ei();}}vh.QB();xh=wh.removeLast();return new q(k.hH,A.N);}q Ki(){var A=vh.lB();if(A.type==M.xC||A.type==M.UE||A.type==M.FF){var B=A.N.start;xh=R.rK;return Qi(B);}else{wh.add(R.rK);return Ei();}}q Li(){var A=vh.lB();if(A.type==M.xC){A=vh.MC();if(A.type!=M.UE&&A.type!=M.FF){wh.add(R.sK);return Ei();}}xh=R.sK;return Qi(A.N.start);}q Mi(){xh=R.qK;return new q(k.iH,vh.lB().N.start.mB());}q Ni({bool first: false}){if(first)vh.QB();var A=vh.lB();if(A.type!=M.GF){if(!first){if(A.type!=M.UE){throw new g("While parsing a flow mapping, expected ',' or '}'.",A.N.start.mB());}A=vh.MC();}if(A.type==M.RD){A=vh.MC();if(A.type!=M.xC&&A.type!=M.UE&&A.type!=M.GF){wh.add(R.tK);return Ei();}else{xh=R.tK;return Qi(A.N.start);}}else if(A.type!=M.GF){wh.add(R.TP);return Ei();}}vh.QB();xh=wh.removeLast();return new q(k.iH,A.N);}q Oi({bool empty: false}){var A=vh.lB();if(empty){xh=R.mH;return Qi(A.N.start);}if(A.type==M.xC){A=vh.MC();if(A.type!=M.UE&&A.type!=M.GF){wh.add(R.mH);return Ei();}}xh=R.mH;return Qi(A.N.start);}q Qi(JC A)=>new TC(A.mB(),'',ZB.wH);DG<EG,List<UC>> Pi(){var A=vh.lB();var B;var C=<UC>[] ;while(A.type==M.zH||A.type==M.AI){if(A is HL){if(B!=null){throw new g("Duplicate %YAML directive.",A.N);}if(A.iE!=1||A.CE==0){throw new g("Incompatible YAML document. This parser only supports YAML 1.1 " "and 1.2.",A.N);}else if(A.CE>2){jP("Warning: this parser only supports YAML 1.1 and 1.2.",A.N);}B=new EG(A.iE,A.CE);}else if(A is IL){var D=new UC(A.OC,A.mE);Ri(D,A.N);C.add(D);}A=vh.MC();}Ri(new UC("!","!"),A.N.start.mB(),allowDuplicates:true);Ri(new UC("!!","tag:yaml.org,2002:"),A.N.start.mB(),allowDuplicates:true);return new DG(B,C);}void Ri(UC A,FB B,{bool allowDuplicates: false}){if(yh.containsKey(A.OC)){if(allowDuplicates)return;throw new g("Duplicate %TAG directive.",B);}yh[A.OC]=A;}}class R{static const KP=const R("STREAM_START");static const nK=const R("DOCUMENT_START");static const LP=const R("DOCUMENT_CONTENT");static const oK=const R("DOCUMENT_END");static const MP=const R("BLOCK_NODE");static const kW=const R("BLOCK_NODE_OR_INDENTLESS_SEQUENCE");static const lW=const R("FLOW_NODE");static const NP=const R("BLOCK_SEQUENCE_FIRST_ENTRY");static const pK=const R("BLOCK_SEQUENCE_ENTRY");static const jH=const R("INDENTLESS_SEQUENCE_ENTRY");static const OP=const R("BLOCK_MAPPING_FIRST_KEY");static const kH=const R("BLOCK_MAPPING_KEY");static const lH=const R("BLOCK_MAPPING_VALUE");static const PP=const R("FLOW_SEQUENCE_FIRST_ENTRY");static const qK=const R("FLOW_SEQUENCE_ENTRY");static const QP=const R("FLOW_SEQUENCE_ENTRY_MAPPING_KEY");static const rK=const R("FLOW_SEQUENCE_ENTRY_MAPPING_VALUE");static const sK=const R("FLOW_SEQUENCE_ENTRY_MAPPING_END");static const RP=const R("FLOW_MAPPING_FIRST_KEY");static const mH=const R("FLOW_MAPPING_KEY");static const tK=const R("FLOW_MAPPING_VALUE");static const TP=const R("FLOW_MAPPING_EMPTY_VALUE");static const UP=const R("END");final String name;const R(this.name);String toString()=>name;}class uK{static const uC=0x9;static const vC=0xA;static const wC=0xD;static const eC=0x20;static const mW=0x24;static const nW=0x28;static const oW=0x29;static const zF=0x2B;static const AG=0x2C;static const nH=0x2D;static const pW=0x2E;static const vK=0x3F;static const oH=0x3A;static const qW=0x3B;static const rW=0x3D;static const pH=0x5B;static const BG=0x5D;static const wK=0x7B;static const qH=0x7D;static const xK=0x23;static const VP=0x26;static const WP=0x2A;static const XP=0x21;static const sW=0x7C;static const tW=0x3C;static const uW=0x3E;static const RE=0x27;static const rH=0x22;static const sH=0x25;static const yK=0x40;static const YP=0x60;static const vW=0x7E;static const wW=0x0;static const xW=0x7;static const yW=0x8;static const zW=0xB;static const AX=0xC;static const BX=0x1B;static const ZP=0x2F;static const zK=0x5C;static const CX=0x5F;static const tH=0x85;static const DX=0xA0;static const EX=0x2028;static const FX=0x2029;static const AL=0xFEFF;static const QD=0x30;static const uH=0x39;static const vH=0x61;static const GX=0x62;static const HX=0x65;static const aP=0x66;static const IX=0x6E;static const JX=0x72;static const KX=0x74;static const LX=0x75;static const MX=0x76;static const NX=0x78;static const OX=0x7A;static const BL=0x41;static const bP=0x46;static const PX=0x4C;static const QX=0x4E;static const RX=0x50;static const SX=0x55;static const TX=0x5A;final CF Si;var Ti=false;var Ui=false;final Vi=new JN<AB>();var Wi=0;var Xi=false;final Yi=<int>[-1];var Zi=true;final ai=<CL>[null];int get bi=>Yi.last;bool get ci=>ai.length==1;bool get di=>Si.fD||ei;bool get ei=>fi(0);bool get gi=>hi(0);bool get ii=>ji(0);bool get ki{var A=Si.e();if(A==null)return false;switch (A){case nH:case qW:case ZP:case oH:case yK:case VP:case rW:case zF:case mW:case pW:case vW:case vK:case WP:case RE:case nW:case oW:case sH:return true;default:return (A>=QD&&A<=uH)||(A>=vH&&A<=OX)||(A>=BL&&A<=TX);}}bool get li{if(!mi)return false;switch (Si.e()){case AG:case pH:case BG:case wK:case qH:return false;default:return true;}}bool get ni{var A=Si.e();return A!=null&&(A>=QD&&A<=uH);}bool get oi{var A=Si.e();if(A==null)return false;return (A>=QD&&A<=uH)||(A>=vH&&A<=aP)||(A>=BL&&A<=bP);}bool get pi=>qi(0);bool get ri{var A=Si.e();if(A==null)return false;switch (A){case vC:case wC:case AL:return false;case uC:case tH:return true;default:return (A>=0x00020&&A<=0x00007E)||(A>=0x000A0&&A<=0x00D7FF)||(A>=0x0E000&&A<=0x00FFFD)||(A>=0x10000&&A<=0x10FFFF);}}bool get mi{var A=Si.e();if(A==null)return false;switch (A){case vC:case wC:case AL:case eC:return false;case tH:return true;default:return (A>=0x00020&&A<=0x00007E)||(A>=0x000A0&&A<=0x00D7FF)||(A>=0x0E000&&A<=0x00FFFD)||(A>=0x10000&&A<=0x10FFFF);}}bool get si{return Si.DB==0&&hi(3)&&(Si.BE('---')||Si.BE('...'));}uK(String A,{sourceUrl}):Si=new CF.pb(A,sourceUrl:sourceUrl);AB QB(){if(Ui)throw new StateError("Out of tokens.");if(!Xi)ti();var A=Vi.removeFirst();Xi=false;Wi++ ;Ui=A is AB&&A.type==M.CG;return A;}AB MC(){QB();return lB();}AB lB(){if(Ui)return null;if(!Xi)ti();return Vi.first;}void ti(){while(true){if(Vi.isNotEmpty){ui();if(!ai.any((A)=>A!=null&&A.IJ==Wi)){break;}}vi();}Xi=true;}void vi(){if(!Ti){wi();return;}xi();ui();yi(Si.DB);if(Si.fD){zi();return;}if(Si.DB==0){if(Si.e()==sH){Aj();return;}if(hi(3)){if(Si.BE('---')){Bj(M.BI);return;}if(Si.BE('...')){Bj(M.CI);return;}}}switch (Si.e()){case pH:Cj(M.gP);return;case wK:Cj(M.hP);return;case BG:Dj(M.FF);return;case qH:Dj(M.GF);return;case AG:Ej();return;case WP:Fj(anchor:false);return;case VP:Fj(anchor:true);return;case XP:Gj();return;case RE:Hj(singleQuote:true);return;case rH:Hj(singleQuote:false);return;case sW:if(!ci)Ij();Jj(literal:true);return;case uW:if(!ci)Ij();Jj(literal:false);return;case sH:case yK:case YP:Ij();return;case nH:if(qi(1)){Kj();}else{Lj();}return;case vK:if(qi(1)){Kj();}else{Mj();}return;case oH:if(!ci&&Vi.isNotEmpty){var A=Vi.last;if(A.type==M.FF||A.type==M.GF||(A.type==M.iP&&(A as EF).Z.Qa)){Nj();return;}}if(qi(1)){Kj();}else{Nj();}return;default:if(!ri)Ij();Kj();return;}throw 'Inaccessible';}void Ij()=>Si.error("Unexpected character.",length:1);void ui(){for(var A=0;A<ai.length;A++ ){var B=ai[A];if(B==null)continue;if(!ci)continue;if(B.jB==Si.jB)continue;if(B.TM){throw new g("Expected ':'.",Si.tB);}ai[A]=null;}}void Oj(){var A=ci&&bi==Si.DB;assert(Zi||!A);if(!Zi)return;Pj();ai[ai.length-1]=new CL(Wi+Vi.length,Si.jB,Si.DB,Si.location,required:A);}void Pj(){var A=ai.last;if(A!=null&&A.TM){throw new g("Could not find expected ':' for simple key.",A.location.mB());}ai[ai.length-1]=null;}void Qj(){ai.add(null);}void Rj(){if(ci)return;ai.removeLast();}void Sj(int A,M C,JC D,{int tokenNumber}){if(!ci)return;if(bi!=-1&&bi>=A)return;Yi.add(A);var B=new AB(C,D.mB());if(tokenNumber==null){Vi.add(B);}else{Vi.insert(tokenNumber-Wi,B);}}void yi(int A){if(!ci)return;while(bi>A){Vi.add(new AB(M.SE,Si.tB));Yi.removeLast();}}void Tj()=>yi(-1);void wi(){Ti=true;Vi.add(new AB(M.eP,Si.tB));}void zi(){Tj();Pj();Zi=false;Vi.add(new AB(M.CG,Si.tB));}void Aj(){Tj();Pj();Zi=false;var A=Uj();if(A!=null)Vi.add(A);}void Bj(M A){Tj();Pj();Zi=false;var B=Si.state;Si.d();Si.d();Si.d();Vi.add(new AB(A,Si.nB(B)));}void Cj(M A){Oj();Qj();Zi=true;Vj(A);}void Dj(M A){Pj();Rj();Zi=false;Vj(A);}void Ej(){Pj();Zi=true;Vj(M.UE);}void Lj(){if(ci){if(!Zi){throw new g("Block sequence entries are not allowed here.",Si.tB);}Sj(Si.DB,M.fP,Si.location);}else{}Pj();Zi=true;Vj(M.HF);}void Mj(){if(ci){if(!Zi){throw new g("Mapping keys are not allowed here.",Si.tB);}Sj(Si.DB,M.DI,Si.location);}Zi=ci;Vj(M.RD);}void Nj(){var A=ai.last;if(A!=null){Vi.insert(A.IJ-Wi,new AB(M.RD,A.location.mB()));Sj(A.DB,M.DI,A.location,tokenNumber:A.IJ);ai[ai.length-1]=null;Zi=false;}else if(ci){if(!Zi){throw new g("Mapping values are not allowed here. Did you miss a colon " "earlier?",Si.tB);}Sj(Si.DB,M.DI,Si.location);Zi=true;}else if(Zi){Zi=false;Vj(M.RD);}Vj(M.xC);}void Vj(M A){var B=Si.state;Si.d();Vi.add(new AB(A,Si.nB(B)));}void Fj({bool anchor: true}){Oj();Zi=false;Vi.add(Wj(anchor:anchor));}void Gj(){Oj();Zi=false;Vi.add(Xj());}void Jj({bool literal: false}){Pj();Zi=true;Vi.add(Yj(literal:literal));}void Hj({bool singleQuote: false}){Oj();Zi=false;Vi.add(Zj(singleQuote:singleQuote));}void Kj(){Oj();Zi=false;Vi.add(aj());}void xi(){var A=false;while(true){if(Si.DB==0)Si.QB("\uFEFF");while(Si.e()==eC||((!ci||!A)&&Si.e()==uC)){Si.d();}if(Si.e()==uC){Si.error("Tab characters are not allowed as indentation.",length:1);}bj();if(ei){cj();if(ci)Zi=true;A=true;}else{break;}}}AB Uj(){var A=Si.state;Si.d();var B;var C=dj();if(C=="YAML"){B=ej(A);}else if(C=="TAG"){B=fj(A);}else{jP("Warning: unknown directive.",Si.nB(A));while(!di){Si.d();}return null;}gj();bj();if(!di){throw new g("Expected comment or line break after directive.",Si.nB(A));}cj();return B;}String dj(){var B=Si.position;while(mi){Si.d();}var A=Si.substring(B);if(A.isEmpty){throw new g("Expected directive name.",Si.tB);}else if(!gi){throw new g("Unexpected character in directive name.",Si.tB);}return A;}AB ej(tD A){gj();var B=hj();Si.nI('.');var C=hj();return new HL(Si.nB(A),B,C);}int hj(){var B=Si.position;while(ni){Si.d();}var A=Si.substring(B);if(A.isEmpty){throw new g("Expected version number.",Si.tB);}return int.parse(A);}AB fj(tD A){gj();var B=ij(directive:true);if(!ii){throw new g("Expected whitespace.",Si.tB);}gj();var C=jj();if(!gi){throw new g("Expected whitespace.",Si.tB);}return new IL(Si.nB(A),B,C);}AB Wj({bool anchor: true}){var C=Si.state;Si.d();var D=Si.position;while(li){Si.d();}var B=Si.substring(D);var A=Si.e();if(B.isEmpty||(!gi&&A!=vK&&A!=oH&&A!=AG&&A!=BG&&A!=qH&&A!=sH&&A!=yK&&A!=YP)){throw new g("Expected alphanumeric character.",Si.tB);}if(anchor){return new xH(Si.nB(C),B);}else{return new JL(Si.nB(C),B);}}AB Xj(){var A;var B;var C=Si.state;if(Si.e(1)==tW){Si.d();Si.d();A='';B=jj();Si.nI('>');}else{A=ij();if(A.length>1&&A.startsWith('!')&&A.endsWith('!')){B=jj(flowSeparators:false);}else{B=jj(head:A,flowSeparators:false);if(B.isEmpty){A=null;B='!';}else{A='!';}}}return new yH(Si.nB(C),A,B);}String ij({bool directive: false}){Si.nI('!');var A=new StringBuffer('!');var B=Si.position;while(ki){Si.d();}A.write(Si.substring(B));if(Si.e()==XP){A.writeCharCode(Si.d());}else{if(directive&&A.toString()!='!')Si.nI('!');}return A.toString();}String jj({String head,bool flowSeparators: true}){var B=head==null?0:head.length;var C=new StringBuffer();if(B>1)C.write(head.substring(1));var D=Si.position;var A=Si.e();while(ki||(flowSeparators&&(A==AG||A==pH||A==BG))){Si.d();A=Si.e();}return Uri.decodeFull(Si.substring(D));}AB Yj({bool literal: false}){var L=Si.state;Si.d();var J=fC.UX;var D=0;var A=Si.e();if(A==zF||A==nH){J=A==zF?fC.EL:fC.DL;Si.d();if(ni){if(Si.e()==QD){throw new g("0 may not be used as an indentation indicator.",Si.nB(L));}D=Si.d()-QD;}}else if(ni){if(Si.e()==QD){throw new g("0 may not be used as an indentation indicator.",Si.nB(L));}D=Si.d()-QD;A=Si.e();if(A==zF||A==nH){J=A==zF?fC.EL:fC.DL;Si.d();}}gj();bj();if(!di){throw new g("Expected comment or line break.",Si.tB);}cj();var C=0;if(D!=0){C=bi>=0?bi+D:D;}var G=kj(C);C=G.first;var K=G.last;var B=new StringBuffer();var H='';var S=false;var W=false;var f=Si.state;while(Si.DB==C&&!Si.fD){if(si)break;W=ii;if(!literal&&H.isNotEmpty&&!S&&!W){if(K.isEmpty)B.writeCharCode(eC);}else{B.write(H);}H='';B.write(K);S=ii;var p=Si.position;while(!di){Si.d();}B.write(Si.substring(p));f=Si.state;if(!Si.fD)H=lj();var G=kj(C);C=G.first;K=G.last;}if(J!=fC.DL)B.write(H);if(J==fC.EL)B.write(K);return new EF(Si.nB(L,f),B.toString(),literal?ZB.WX:ZB.XX);}DG<int,String> kj(int A){var B=0;var C=new StringBuffer();while(true){while((A==0||Si.DB<A)&&Si.e()==eC){Si.d();}if(Si.DB>B)B=Si.DB;if(!ei)break;C.write(lj());}if(A==0){A=B;if(A<bi+1)A=bi+1;}return new DG(A,C.toString());}AB Zj({bool singleQuote: false}){var W=Si.state;var A=new StringBuffer();Si.d();while(true){if(si){Si.error("Unexpected document indicator.");}if(Si.fD){throw new g("Unexpected end of file.",Si.tB);}var D=false;while(!gi){var G=Si.e();if(singleQuote&&G==RE&&Si.e(1)==RE){Si.d();Si.d();A.writeCharCode(RE);}else if(G==(singleQuote?RE:rH)){break;}else if(!singleQuote&&G==zK&&fi(1)){Si.d();cj();D=true;break;}else if(!singleQuote&&G==zK){var J=Si.state;var B=null;switch (Si.e(1)){case QD:A.writeCharCode(wW);break;case vH:A.writeCharCode(xW);break;case GX:A.writeCharCode(yW);break;case KX:case uC:A.writeCharCode(uC);break;case IX:A.writeCharCode(vC);break;case MX:A.writeCharCode(zW);break;case aP:A.writeCharCode(AX);break;case JX:A.writeCharCode(wC);break;case HX:A.writeCharCode(BX);break;case eC:case rH:case ZP:case zK:A.writeCharCode(Si.e(1));break;case QX:A.writeCharCode(tH);break;case CX:A.writeCharCode(DX);break;case PX:A.writeCharCode(EX);break;case RX:A.writeCharCode(FX);break;case NX:B=2;break;case LX:B=4;break;case SX:B=8;break;default:throw new g("Unknown escape character.",Si.nB(J));}Si.d();Si.d();if(B!=null){var C=0;for(var L=0;L<B;L++ ){if(!oi){Si.d();throw new g("Expected ${B}-digit hexidecimal number.",Si.nB(J));}C=(C<<4)+mj(Si.d());}if((C>=0xD800&&C<=0xDFFF)||C>0x10FFFF){throw new g("Invalid Unicode character escape code.",Si.nB(J));}A.writeCharCode(C);}}else{A.writeCharCode(Si.d());}}if(Si.e()==(singleQuote?RE:rH)){break;}var H=new StringBuffer();var S='';var K=new StringBuffer();while(ii||ei){if(ii){if(!D){H.writeCharCode(Si.d());}else{Si.d();}}else{if(!D){H.clear();S=lj();D=true;}else{K.write(lj());}}}if(D){if(S.isNotEmpty&&K.isEmpty){A.writeCharCode(eC);}else{A.write(K);}}else{A.write(H);H.clear();}}Si.d();return new EF(Si.nB(W),A.toString(),singleQuote?ZB.cP:ZB.dP);}AB aj(){var J=Si.state;var G=Si.state;var B=new StringBuffer();var A='';var C='';var D=new StringBuffer();var H=bi+1;while(true){if(si)break;if(Si.e()==xK)break;if(pi){if(A.isNotEmpty){if(C.isEmpty){B.writeCharCode(eC);}else{B.write(C);}A='';C='';}else{B.write(D);D.clear();}}var K=Si.position;while(pi){Si.d();}B.write(Si.substring(K));G=Si.state;if(!ii&&!ei)break;while(ii||ei){if(ii){if(A.isNotEmpty&&Si.DB<H&&Si.e()==uC){Si.error("Expected a space but found a tab.",length:1);}if(A.isEmpty){D.writeCharCode(Si.d());}else{Si.d();}}else{if(A.isEmpty){A=lj();D.clear();}else{C=lj();}}}if(ci&&Si.DB<H)break;}if(A.isNotEmpty)Zi=true;return new EF(Si.nB(J,G),B.toString(),ZB.wH);}void cj(){var A=Si.e();if(A!=wC&&A!=vC)return;Si.d();if(A==wC&&Si.e()==vC)Si.d();}String lj(){var A=Si.e();if(A!=wC&&A!=vC){throw new g("Expected newline.",Si.tB);}Si.d();if(A==wC&&Si.e()==vC)Si.d();return "\n";}bool ji(int B){var A=Si.e(B);return A==eC||A==uC;}bool fi(int B){var A=Si.e(B);return A==wC||A==vC;}bool hi(int B){var A=Si.e(B);return A==null||A==eC||A==uC||A==wC||A==vC;}bool qi(int A){switch (Si.e(A)){case oH:return nj(A+1);case xK:var B=Si.e(A-1);return B!=eC&&B!=uC;default:return nj(A);}}bool nj(int B){var A=Si.e(B);switch (A){case AG:case pH:case BG:case wK:case qH:return ci;case eC:case uC:case vC:case wC:case AL:return false;case tH:return true;default:return A!=null&&((A>=0x00020&&A<=0x00007E)||(A>=0x000A0&&A<=0x00D7FF)||(A>=0x0E000&&A<=0x00FFFD)||(A>=0x10000&&A<=0x10FFFF));}}int mj(int A){if(A<=uH)return A-QD;if(A<=bP)return 10+A-BL;return 10+A-vH;}void gj(){while(ii){Si.d();}}void bj(){if(Si.e()!=xK)return;while(!di){Si.d();}}}class CL{final int IJ;final JC location;final int jB;final int DB;final bool TM;CL(this.IJ,this.jB,this.DB,this.location,{bool required}):TM=required;}class fC{static const DL=const fC("STRIP");static const UX=const fC("CLIP");static const EL=const fC("KEEP");final String name;const fC(this.name);String toString()=>name;}class ZB{static const VX=const ZB.Wb("ANY");static const wH=const ZB.Wb("PLAIN");static const WX=const ZB.Wb("LITERAL");static const XX=const ZB.Wb("FOLDED");static const cP=const ZB.Wb("SINGLE_QUOTED");static const dP=const ZB.Wb("DOUBLE_QUOTED");final String name;bool get Qa=>this==cP||this==dP;const ZB.Wb(this.name);String toString()=>name;}class KC{static const FL=const KC.Xb("BLOCK");static const GL=const KC.Xb("FLOW");final String name;const KC.Xb(this.name);String toString()=>name;}class AB{final M type;final FB N;AB(this.type,this.N);String toString()=>type.toString();}class HL implements AB{get type=>M.zH;final FB N;final int iE;final int CE;HL(this.N,this.iE,this.CE);String toString()=>"VERSION_DIRECTIVE ${iE}.${CE}";}class IL implements AB{get type=>M.AI;final FB N;final String OC;final String mE;IL(this.N,this.OC,this.mE);String toString()=>"TAG_DIRECTIVE ${OC} ${mE}";}class xH implements AB{get type=>M.ZX;final FB N;final String name;xH(this.N,this.name);String toString()=>"ANCHOR ${name}";}class JL implements AB{get type=>M.YX;final FB N;final String name;JL(this.N,this.name);String toString()=>"ALIAS ${name}";}class yH implements AB{get type=>M.aX;final FB N;final String OC;final String DJ;yH(this.N,this.OC,this.DJ);String toString()=>"TAG ${OC} ${DJ}";}class EF implements AB{get type=>M.iP;final FB N;final String value;final ZB Z;EF(this.N,this.value,this.Z);String toString()=>"SCALAR ${Z} \"${value}\"";}class M{static const eP=const M.Yb("STREAM_START");static const CG=const M.Yb("STREAM_END");static const zH=const M.Yb("VERSION_DIRECTIVE");static const AI=const M.Yb("TAG_DIRECTIVE");static const BI=const M.Yb("DOCUMENT_START");static const CI=const M.Yb("DOCUMENT_END");static const fP=const M.Yb("BLOCK_SEQUENCE_START");static const DI=const M.Yb("BLOCK_MAPPING_START");static const SE=const M.Yb("BLOCK_END");static const gP=const M.Yb("FLOW_SEQUENCE_START");static const FF=const M.Yb("FLOW_SEQUENCE_END");static const hP=const M.Yb("FLOW_MAPPING_START");static const GF=const M.Yb("FLOW_MAPPING_END");static const HF=const M.Yb("BLOCK_ENTRY");static const UE=const M.Yb("FLOW_ENTRY");static const RD=const M.Yb("KEY");static const xC=const M.Yb("VALUE");static const YX=const M.Yb("ALIAS");static const ZX=const M.Yb("ANCHOR");static const aX=const M.Yb("TAG");static const iP=const M.Yb("SCALAR");final String name;const M.Yb(this.name);String toString()=>name;}class DG<b,mX>{final b first;final mX last;DG(this.first,this.last);String toString()=>'(${first}, ${last})';}void jP(String A,[JB B])=>cX(A,B);typedef dynamic bX(String _0,[JB _1]);bX cX=(A,[B]){if(B!=null)A=B.message(A);print(A);};String gX(B){var A=new StringBuffer();hX(B,A);return A.toString();}void hX(A,StringSink B){KL(A,0,B,true);}void KL(A,int C,StringSink B,bool D){if(A is Map){jX(A,C,B,D);}else if(A is Iterable){lX(A,C,B,D);}else if(A is String){B..writeln('"${iX(A)}"');}else if(A is double){B.writeln("!!float ${A}");}else{B.writeln(A);}}String iX(String A)=>A.replaceAll('"',r'\"').replaceAll("\n",r"\n");void jX(Map C,int B,StringSink A,bool G){if(!G){A.writeln();B+= 2;}final H=kX(C);H.forEach((D){final J=C[D];nP(B,A);A..write(D)..write(': ');KL(J,B,A,false);});}Iterable<String> kX(Map H){final B=[] ;final C=[] ;final D=[] ;H.forEach((A,G){if(G is String){B.add(A);}else if(G is Map){C.add(A);}else{D.add(A);}});return NW([B..sort(),C..sort(),D..sort()]);}void lX(Iterable C,int B,StringSink A,bool D){if(!D){A.writeln();B+= 2;}C.forEach((G){nP(B,A);A.write('- ');KL(G,B,A,false);});}void nP(int A,StringSink B)=>B.write(' '*A);class IF{final NB wL;final JB N;final EG versionDirective;final List<UC> FJ;final bool startImplicit;final bool endImplicit;IF.Zb(this.wL,this.N,this.versionDirective,List<UC> A,{this.startImplicit: false,this.endImplicit: false}):FJ=new UnmodifiableListView(A);String toString()=>wL.toString();}class EG{final int iE;final int CE;EG(this.iE,this.CE);String toString()=>"%YAML ${iE}.${CE}";}class UC{final String OC;final String mE;UC(this.OC,this.mE);String toString()=>"%TAG ${OC} ${mE}";}abstract class NB{JB get N=>oj;JB oj;get value;}class kP extends NB with MapMixin,mT{final Map<dynamic,NB> FC;final KC Z;Map get value=>this;Iterable get keys=>FC.keys.map((A)=>A.value);kP.ab(Map<dynamic,NB> A,JB B,this.Z):FC=new UnmodifiableMapView<dynamic,NB>(A){oj=B;}operator[](B){var A=FC[B];return A==null?null:A.value;}}class lP extends NB with ListMixin{final List<NB> FC;final KC Z;List get value=>this;int get length=>FC.length;set length(int A){throw new UnsupportedError("Cannot modify an unmodifiable List");}lP.bb(List<NB> A,JB B,this.Z):FC=new UnmodifiableListView<NB>(A){oj=B;}operator[](int A)=>FC[A].value;operator[]=(int A,B){throw new UnsupportedError("Cannot modify an unmodifiable List");}}class UB extends NB{final value;final ZB Z;UB.cb(this.value,TC A):Z=A.Z{oj=A.N;}UB.db(this.value,JB A):Z=ZB.VX{oj=A;}String toString()=>value.toString();}void mP(NB A,JB B){A.oj=B;}